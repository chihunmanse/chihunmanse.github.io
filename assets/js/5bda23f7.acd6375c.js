"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[767],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>b});var a=n(7294);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,l=function(e,t){if(null==e)return{};var n,a,l={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var c=a.createContext({}),s=function(e){var t=a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=s(e.components);return a.createElement(c.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,l=e.mdxType,r=e.originalType,c=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),p=s(n),m=l,b=p["".concat(c,".").concat(m)]||p[m]||d[m]||r;return n?a.createElement(b,o(o({ref:t},u),{},{components:n})):a.createElement(b,o({ref:t},u))}));function b(e,t){var n=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var r=n.length,o=new Array(r);o[0]=m;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i[p]="string"==typeof e?e:l,o[1]=i;for(var s=2;s<r;s++)o[s]=n[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},5162:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(7294),l=n(6010);const r={tabItem:"tabItem_Ymn6"};function o(e){let{children:t,hidden:n,className:o}=e;return a.createElement("div",{role:"tabpanel",className:(0,l.Z)(r.tabItem,o),hidden:n},t)}},4866:(e,t,n)=>{n.d(t,{Z:()=>E});var a=n(7462),l=n(7294),r=n(6010),o=n(2466),i=n(6550),c=n(1980),s=n(7392),u=n(12);function p(e){return function(e){return l.Children.map(e,(e=>{if(!e||(0,l.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:l}}=e;return{value:t,label:n,attributes:a,default:l}}))}function d(e){const{values:t,children:n}=e;return(0,l.useMemo)((()=>{const e=t??p(n);return function(e){const t=(0,s.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function m(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function b(e){let{queryString:t=!1,groupId:n}=e;const a=(0,i.k6)(),r=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,c._X)(r),(0,l.useCallback)((e=>{if(!r)return;const t=new URLSearchParams(a.location.search);t.set(r,e),a.replace({...a.location,search:t.toString()})}),[r,a])]}function g(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,r=d(e),[o,i]=(0,l.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:r}))),[c,s]=b({queryString:n,groupId:a}),[p,g]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,r]=(0,u.Nk)(n);return[a,(0,l.useCallback)((e=>{n&&r.set(e)}),[n,r])]}({groupId:a}),f=(()=>{const e=c??p;return m({value:e,tabValues:r})?e:null})();(0,l.useLayoutEffect)((()=>{f&&i(f)}),[f]);return{selectedValue:o,selectValue:(0,l.useCallback)((e=>{if(!m({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);i(e),s(e),g(e)}),[s,g,r]),tabValues:r}}var f=n(2389);const k={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function h(e){let{className:t,block:n,selectedValue:i,selectValue:c,tabValues:s}=e;const u=[],{blockElementScrollPositionUntilNextRender:p}=(0,o.o5)(),d=e=>{const t=e.currentTarget,n=u.indexOf(t),a=s[n].value;a!==i&&(p(t),c(a))},m=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const n=u.indexOf(e.currentTarget)+1;t=u[n]??u[0];break}case"ArrowLeft":{const n=u.indexOf(e.currentTarget)-1;t=u[n]??u[u.length-1];break}}t?.focus()};return l.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":n},t)},s.map((e=>{let{value:t,label:n,attributes:o}=e;return l.createElement("li",(0,a.Z)({role:"tab",tabIndex:i===t?0:-1,"aria-selected":i===t,key:t,ref:e=>u.push(e),onKeyDown:m,onClick:d},o,{className:(0,r.Z)("tabs__item",k.tabItem,o?.className,{"tabs__item--active":i===t})}),n??t)})))}function y(e){let{lazy:t,children:n,selectedValue:a}=e;const r=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=r.find((e=>e.props.value===a));return e?(0,l.cloneElement)(e,{className:"margin-top--md"}):null}return l.createElement("div",{className:"margin-top--md"},r.map(((e,t)=>(0,l.cloneElement)(e,{key:t,hidden:e.props.value!==a}))))}function v(e){const t=g(e);return l.createElement("div",{className:(0,r.Z)("tabs-container",k.tabList)},l.createElement(h,(0,a.Z)({},e,t)),l.createElement(y,(0,a.Z)({},e,t)))}function E(e){const t=(0,f.Z)();return l.createElement(v,(0,a.Z)({key:String(t)},e))}},7049:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>c,default:()=>b,frontMatter:()=>i,metadata:()=>s,toc:()=>p});var a=n(7462),l=(n(7294),n(3905)),r=n(4866),o=n(5162);const i={sidebar_position:2},c="2. ERC1967, TransparentProxy, UUPS",s={unversionedId:"blockchain/upgradeable-contract/upgradeable2",id:"blockchain/upgradeable-contract/upgradeable2",title:"2. ERC1967, TransparentProxy, UUPS",description:"\uc774\uc804 \uae00\uc5d0 \uc774\uc5b4\uc11c \ud504\ub85d\uc2dc \ud328\ud134\uc5d0 \ub300\ud574 \ubcf8\uaca9\uc801\uc73c\ub85c \uc0b4\ud3b4\ubcf4\ub824\uace0 \ud55c\ub2e4.",source:"@site/docs/blockchain/upgradeable-contract/upgradeable2.mdx",sourceDirName:"blockchain/upgradeable-contract",slug:"/blockchain/upgradeable-contract/upgradeable2",permalink:"/docs/blockchain/upgradeable-contract/upgradeable2",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"blockChain",previous:{title:"1. Migration, DelegateCall",permalink:"/docs/blockchain/upgradeable-contract/upgradeable1"}},u={},p=[{value:"fallback \ud568\uc218",id:"fallback-\ud568\uc218",level:3},{value:"ERC1967",id:"erc1967",level:2},{value:"\uc0dd\uc131\uc790 \ud568\uc218",id:"\uc0dd\uc131\uc790-\ud568\uc218",level:3},{value:"\ud568\uc218 \ucda9\ub3cc",id:"\ud568\uc218-\ucda9\ub3cc",level:3},{value:"\ucee8\ud2b8\ub799\ud2b8\uac00 \ud568\uc218\ub97c \uc2dd\ubcc4\ud558\ub294 \ubc29\uc2dd",id:"\ucee8\ud2b8\ub799\ud2b8\uac00-\ud568\uc218\ub97c-\uc2dd\ubcc4\ud558\ub294-\ubc29\uc2dd",level:3}],d={toc:p},m="wrapper";function b(e){let{components:t,...n}=e;return(0,l.kt)(m,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"2-erc1967-transparentproxy-uups"},"2. ERC1967, TransparentProxy, UUPS"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"/docs/blockchain/upgradeable-contract/upgradeable1"},"\uc774\uc804 \uae00"),"\uc5d0 \uc774\uc5b4\uc11c \ud504\ub85d\uc2dc \ud328\ud134\uc5d0 \ub300\ud574 \ubcf8\uaca9\uc801\uc73c\ub85c \uc0b4\ud3b4\ubcf4\ub824\uace0 \ud55c\ub2e4."),(0,l.kt)("p",null,"\ud504\ub85d\uc2dc \ud328\ud134\uc740 \uae30\ubcf8\uc801\uc73c\ub85c delegatecall \uacfc fallback \ud568\uc218\uc758 \uc870\ud569\uc744 \ud1b5\ud574 \uad6c\ud604\ub41c\ub2e4."),(0,l.kt)("h3",{id:"fallback-\ud568\uc218"},"fallback \ud568\uc218"),(0,l.kt)("p",null,"fallback \ud568\uc218\ub780 \ucee8\ud2b8\ub799\ud2b8\uc5d0 \uc874\uc7ac\ud558\uc9c0 \uc54a\ub294 \ud568\uc218\uac00 \ud638\ucd9c\ub418\uc5c8\uc744 \uacbd\uc6b0 \ub300\uc2e0\ud574\uc11c \ud638\ucd9c\ub418\ub294 \ud568\uc218\uc774\ub2e4."),(0,l.kt)("p",null,"0.6 \uc774\uc804\uc758 fallback \ud568\uc218"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sol"},"function() external payable {}\n")),(0,l.kt)("p",null,"0.6 \uc774\ud6c4\uc758 fallback \ud568\uc218"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"fallback : \ud638\ucd9c\ub41c \ud568\uc218\uac00 \ucee8\ud2b8\ub799\ud2b8\uc5d0 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc744\ub54c \uc791\ub3d9\ud558\ub294 \ud568\uc218"),(0,l.kt)("li",{parentName:"ul"},"receive : calldata \uc5c6\uc774 \ucee8\ud2b8\ub799\ud2b8\uc5d0 \uc774\ub354\uac00 \uc804\uc1a1\ub410\uc744 \ub54c \uc791\ub3d9\ud558\ub294 \ud568\uc218")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sol"},"fallback() external payable {}\nreceive() external payable {}\n")),(0,l.kt)("hr",null),(0,l.kt)("p",null,"\uc624\ud508\uc7ac\ud50c\ub9b0\uc758 ERC1967Proxy, TransparentProxy, UUPS \ub4f1 \ud504\ub85d\uc2dc \ud328\ud134\uc744 \uad6c\ud604\ud55c \uc5ec\ub7ec \ubc29\uc2dd\ub4e4\uc740 \ubaa8\ub450 Proxy \ucd94\uc0c1 \ucee8\ud2b8\ub799\ud2b8\ub97c \uae30\ubc18\uc73c\ub85c \uad6c\ud604\ub418\uc5b4\uc788\ub2e4."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sol",metastring:'title="openzeppelin-contracts/contracts/proxy/Proxy.sol"',title:'"openzeppelin-contracts/contracts/proxy/Proxy.sol"'},"// SPDX-License-Identifier: MIT\n// OpenZeppelin Contracts (last updated v4.6.0) (proxy/Proxy.sol)\n\npragma solidity ^0.8.0;\n\n/**\n * @dev This abstract contract provides a fallback function that delegates all calls to another contract using the EVM\n * instruction `delegatecall`. We refer to the second contract as the _implementation_ behind the proxy, and it has to\n * be specified by overriding the virtual {_implementation} function.\n *\n * Additionally, delegation to the implementation can be triggered manually through the {_fallback} function, or to a\n * different contract through the {_delegate} function.\n *\n * The success and return data of the delegated call will be returned back to the caller of the proxy.\n */\nabstract contract Proxy {\n    /**\n     * @dev Delegates the current call to `implementation`.\n     *\n     * This function does not return to its internal call site, it will return directly to the external caller.\n     */\n    function _delegate(address implementation) internal virtual {\n        assembly {\n            // Copy msg.data. We take full control of memory in this inline assembly\n            // block because it will not return to Solidity code. We overwrite the\n            // Solidity scratch pad at memory position 0.\n            calldatacopy(0, 0, calldatasize())\n\n            // Call the implementation.\n            // out and outsize are 0 because we don't know the size yet.\n            let result := delegatecall(gas(), implementation, 0, calldatasize(), 0, 0)\n\n            // Copy the returned data.\n            returndatacopy(0, 0, returndatasize())\n\n            switch result\n            // delegatecall returns 0 on error.\n            case 0 {\n                revert(0, returndatasize())\n            }\n            default {\n                return(0, returndatasize())\n            }\n        }\n    }\n\n    /**\n     * @dev This is a virtual function that should be overridden so it returns the address to which the fallback function\n     * and {_fallback} should delegate.\n     */\n    function _implementation() internal view virtual returns (address);\n\n    /**\n     * @dev Delegates the current call to the address returned by `_implementation()`.\n     *\n     * This function does not return to its internal call site, it will return directly to the external caller.\n     */\n    function _fallback() internal virtual {\n        _beforeFallback();\n        _delegate(_implementation());\n    }\n\n    /**\n     * @dev Fallback function that delegates calls to the address returned by `_implementation()`. Will run if no other\n     * function in the contract matches the call data.\n     */\n    fallback() external payable virtual {\n        _fallback();\n    }\n\n    /**\n     * @dev Fallback function that delegates calls to the address returned by `_implementation()`. Will run if call data\n     * is empty.\n     */\n    receive() external payable virtual {\n        _fallback();\n    }\n\n    /**\n     * @dev Hook that is called before falling back to the implementation. Can happen as part of a manual `_fallback`\n     * call, or as part of the Solidity `fallback` or `receive` functions.\n     *\n     * If overridden should call `super._beforeFallback()`.\n     */\n    function _beforeFallback() internal virtual {}\n}\n")),(0,l.kt)("p",null,"Proxy \ucee8\ud2b8\ub799\ud2b8\uc758 \ucf54\ub4dc\ub97c \uc0b4\ud3b4\ubcf4\uba74, ",(0,l.kt)("inlineCode",{parentName:"p"},"_delegate"),"\ub77c\ub294 \uc778\ub77c\uc778 \uc5b4\uc148\ube14\ub9ac\ub85c \uc801\ud78c \ub0b4\ubd80 \ud568\uc218\uac00 \uc788\uace0, \uc774 \ud568\uc218\ub97c fallback \ud568\uc218\uc640 receive \ud568\uc218\uc5d0\uc11c \ud638\ucd9c\ud558\uace0 \uc788\ub294 \uac83\uc744 \ubcfc \uc218 \uc788\ub2e4. \ud604\uc7ac \uc774 \ucee8\ud2b8\ub799\ud2b8\uc5d0\uc11c\ub294 \uc678\ubd80\uc5d0\uc11c \ud638\ucd9c\ud560 \uc218 \uc788\ub294 \ud568\uc218\ub97c \ub530\ub85c \ub9cc\ub4e4\uc5b4\ub450\uc9c0 \uc54a\uc558\uae30 \ub54c\ubb38\uc5d0, \uc678\ubd80\uc5d0\uc11c \uc5b4\ub5a4 calldata\ub97c \uac16\uace0 \ud638\ucd9c\ud558\ub354\ub77c\ub3c4 \uc2e4\ud589\ub418\ub294 \uac83\uc740 fallback \ud568\uc218, \uc989 ",(0,l.kt)("inlineCode",{parentName:"p"},"_beforeFallback"),"\uacfc ",(0,l.kt)("inlineCode",{parentName:"p"},"_delegate")," \ub450 \ud568\uc218\uac00 \uc2e4\ud589\ub420 \uac83\uc774\ub2e4."),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"_delegate")," \ud568\uc218\uc5d0\ub294 \ud2b8\ub79c\uc7ad\uc158\uc5d0 \ub2f4\uae34 calldata\ub97c \ud1b5\ud558\uc5ec ",(0,l.kt)("inlineCode",{parentName:"p"},"_implementation"),"(\uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8 \uc8fc\uc18c)\uc5d0 delegatecall\uc744 \ud558\uace0, \uc131\uacf5\ud588\ub2e4\uba74 return \ub370\uc774\ud130\ub97c \ubc18\ud658\ud558\uace0 \uc2e4\ud328\ud588\ub2e4\uba74 revert \uc2dc\ud0a4\ub294 \ub85c\uc9c1\uc774 \ub2f4\uaca8\uc788\ub2e4."),(0,l.kt)("p",null,"\uc774\uc640 \uac19\uc774 delegatecall\uacfc fallback \ud568\uc218\uc758 \uc870\ud569\uc744 \ud1b5\ud558\uc5ec, \uc774\uc804 \uae00\uc5d0\uc11c\ucc98\ub7fc \ud504\ub85d\uc2dc \ucee8\ud2b8\ub799\ud2b8 \ucabd\uc5d0 \ud568\uc218\ub97c \uc815\uc758\ud560 \ud544\uc694 \uc5c6\uc774, \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8 \ucabd\uc5d0 \uc788\ub294 \ud568\uc218\ub4e4\uc744 \uc720\ub3d9\uc801\uc73c\ub85c \ud638\ucd9c\ud558\ub294 \ubc29\uc2dd\uc774 \uac00\ub2a5\ud574\uc9c4\ub2e4. \uc774 \ubc29\uc2dd\uc744 \uc801\uc6a9\ud558\uba74 \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\ub97c \uc5c5\uadf8\ub808\uc774\ub4dc\ud558\ub294 \uacbd\uc6b0\uc5d0 \ud568\uc218\uba85\uacfc \uc778\uc790, return \ub418\ub294 \ub370\uc774\ud130\uae4c\uc9c0 \ud504\ub85d\uc2dc \ucee8\ud2b8\ub799\ud2b8\uc5d0 \uc5bd\ub9e4\uc774\uc9c0 \uc54a\uace0 \uc218\uc815\ud560 \uc218 \uc788\uac8c \ub41c\ub2e4."),(0,l.kt)("h2",{id:"erc1967"},"ERC1967"),(0,l.kt)("p",null,"\ud558\uc9c0\ub9cc \uc774\uc804 \uae00\uc5d0\uc11c \uc0b4\ud3b4\ubcf4\uc558\ub4ef\uc774, delegatecall\uc744 \uc0ac\uc6a9\ud560 \ub54c \uc2a4\ud1a0\ub9ac\uc9c0\ucda9\ub3cc\uc774 \ubc1c\uc0dd\ud560 \uc218 \uc788\ub2e4\ub294 \ubb38\uc81c\ub294 \uc5ec\uc804\ud788 \ud574\uacb0\ub418\uc9c0 \uc54a\uc740 \ucc44\ub85c \ub0a8\uc544\uc788\ub2e4."),(0,l.kt)("p",null,"\ud2b9\ud788 \ud504\ub85d\uc2dc \ucee8\ud2b8\ub799\ud2b8\ub294 \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc5d0 \ub2f4\uae34 \ub85c\uc9c1\uc744 \ud638\ucd9c\ud558\uae30 \uc704\ud574 \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc758 \uc8fc\uc18c\uac12\uc774 \uaf2d \ud544\uc694\ud55c\ub370, \uc774 \uc8fc\uc18c\uac12\uc774 \ub2f4\uae34 \ubcc0\uc218\uac00 \ucda9\ub3cc\ud558\uc5ec \uc608\uc0c1\uce58 \ubabb\ud55c \uac12\uc73c\ub85c \ubcc0\uacbd\ub41c\ub2e4\uba74 \ud504\ub85d\uc2dc \ucee8\ud2b8\ub799\ud2b8\uac00 \uc81c\ub300\ub85c \ub3d9\uc791\ud558\uc9c0 \ubabb\ud558\uac8c \ub418\ub294 \uc2ec\uac01\ud55c \ubb38\uc81c\ub85c \uc774\uc5b4\uc9c4\ub2e4."),(0,l.kt)("p",null,"\uc774 \ubb38\uc81c\ub97c \ud574\uacb0\ud558\uae30 \uc704\ud574 \uc624\ud508\uc7ac\ud50c\ub9b0\uc5d0\ub294 ",(0,l.kt)("a",{parentName:"p",href:"https://eips.ethereum.org/EIPS/eip-1967"},"ERC1967"),"\uc744 \uae30\ubc18\uc73c\ub85c\ud55c ERC1967\uc774 \uad6c\ud604\ub418\uc5b4\uc788\ub2e4."),(0,l.kt)("p",null,"\ubb38\uc81c\ub97c \ud574\uacb0\ud558\ub294 \uc544\uc774\ub514\uc5b4\ub294 \uc758\uc678\ub85c \uac04\ub2e8\ud558\ub2e4. \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc758 \uc8fc\uc18c\uac00 \uc800\uc7a5\ub418\ub294 \uc2a4\ud1a0\ub9ac\uc9c0 \uc2ac\ub86f\uc758 \uc704\uce58\ub97c \uc784\uc758\ub85c \ubc30\uc815\ud574\uc8fc\ub294 \uac83\uc774\ub2e4."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sol",metastring:'title="openzeppelin-contracts-upgradeable/contracts/proxy/ERC1967/ERC1967UpgradeUpgradeable.sol"',title:'"openzeppelin-contracts-upgradeable/contracts/proxy/ERC1967/ERC1967UpgradeUpgradeable.sol"'},'abstract contract ERC1967UpgradeUpgradeable {\n    /**\n     * @dev Storage slot with the address of the current implementation.\n     * This is the keccak-256 hash of "eip1967.proxy.implementation" subtracted by 1, and is\n     * validated in the constructor.\n     */\n    bytes32 internal constant _IMPLEMENTATION_SLOT = 0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;\n\n\n    /**\n     * @dev Returns the current implementation address.\n     */\n    function _getImplementation() internal view returns (address) {\n        return StorageSlotUpgradeable.getAddressSlot(_IMPLEMENTATION_SLOT).value;\n    }\n\n    /**\n     * @dev Stores a new address in the EIP1967 implementation slot.\n     */\n    function _setImplementation(address newImplementation) private {\n        require(AddressUpgradeable.isContract(newImplementation), "ERC1967: new implementation is not a contract");\n        StorageSlotUpgradeable.getAddressSlot(_IMPLEMENTATION_SLOT).value = newImplementation;\n    }\n\n    /**\n     * @dev Perform implementation upgrade\n     *\n     * Emits an {Upgraded} event.\n     */\n    function _upgradeTo(address newImplementation) internal {\n        _setImplementation(newImplementation);\n        emit Upgraded(newImplementation);\n    }\n}\n')),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"_IMPLEMENTATION_SLOT"),"\uc758 \uac12\uc774 \ub3c4\ucd9c\ub41c \uacfc\uc815\uc740 \u201ceip1967.proxy.implementation\u201d \ub97c \ud574\uc2f1\ud55c \ud6c4\uc5d0 1\uc744 \ube80 \uac12\uc774\ub77c\uace0 \uc8fc\uc11d\uc5d0 \uc124\uba85 \ub418\uc5b4\uc788\ub2e4."),(0,l.kt)("p",null,"\uc774\ud6c4 ",(0,l.kt)("inlineCode",{parentName:"p"},"_setImplementation")," \ud568\uc218\ub098 ",(0,l.kt)("inlineCode",{parentName:"p"},"_getImplementation")," \ud568\uc218\uc5d0\uc11c\ub294 \ud574\ub2f9 \uc2ac\ub86f\uac12\uc744 \ud65c\uc6a9\ud558\uc5ec \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc758 \uc8fc\uc18c\ub97c \uc800\uc7a5\ud558\uac70\ub098 \uc870\ud68c\ud558\ub294 \uac83\uc744 \ubcfc \uc218 \uc788\ub2e4."),(0,l.kt)("p",null,"\uc774\uc804 \uae00\uc5d0\uc11c \uc194\ub9ac\ub514\ud2f0\uc758 \uc2a4\ud1a0\ub9ac\uc9c0 \ub808\uc774\uc544\uc6c3\uc5d0 \ub300\ud574 \uc0b4\ud3b4\ubcfc \ub54c, \ucee8\ud2b8\ub799\ud2b8\uc758 \ubcc0\uc218\ub4e4\uc774 \uc2a4\ud1a0\ub9ac\uc9c0\uc5d0 \ud560\ub2f9\ub418\ub294 \uae30\ubcf8\uc801\uc778 \ubc29\uc2dd\uc740 \uc120\uc5b8\ub418\ub294 \uc21c\uc11c\uc5d0 \ub530\ub77c \uc2ac\ub86f\ub118\ubc84\uac00 \ud560\ub2f9\ub418\ub294 \ubc29\uc2dd\uc774\uba70, \ub9e4\ud551\ud0c0\uc785\uc758 \uacbd\uc6b0 value\uac00 \uc800\uc7a5\ub418\ub294 \ubc29\uc2dd\uc740 \ub9e4\ud551 \ud0c0\uc785 \ubcc0\uc218\uac00 \ucd5c\ucd08\uc5d0 \ud560\ub2f9\ub41c \uc2ac\ub86f\ub118\ubc84\uc640 \ub9e4\ud551\uc758 key\uac12\uc744 \ud568\uaed8 \ud574\uc2f1\ud55c \uc2ac\ub86f\ub118\ubc84\uc5d0 \ud560\ub2f9\ub41c\ub2e4\ub294 \uac83\uc744 \uc54c \uc218 \uc788\uc5c8\ub2e4."),(0,l.kt)("p",null,"ERC1967\uc5d0\uc11c \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8 \uc8fc\uc18c\uc758 \uc2a4\ud1a0\ub9ac\uc9c0 \uc2ac\ub86f\ub118\ubc84\ub97c \uc784\uc758\ub85c \uc9c0\uc815\ud558\uc5ec \uc800\uc7a5\ud558\ub294 \ubc29\uc2dd\uc740 \ub9e4\ud551 \ud0c0\uc785\uc758 value\uac00 \uc800\uc7a5\ub418\ub294 \ubc29\uc2dd\uc744 \ucc28\uc6a9\ud55c \ubc29\uc2dd\uc774\ub2e4. \uc77c\ubc18\uc801\uc778 \uacbd\uc6b0\uc5d0 \uc0ac\uc6a9\ub418\uc9c0 \uc54a\uc744 \ud2b9\uc815 \uc2ac\ub86f\ub118\ubc84\uc5d0 \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8 \uc8fc\uc18c\ub97c \uc800\uc7a5\ud574\ub193\uc558\uae30 \ub54c\ubb38\uc5d0 \uc774\ud6c4 \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc5d0\uc11c \uc120\uc5b8\ub418\ub294 \ubcc0\uc218\ub4e4\uc5d0 \uc758\ud574 \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8 \uc8fc\uc18c\uc5d0 \ub300\ud55c \uc2a4\ud1a0\ub9ac\uc9c0 \ucda9\ub3cc\uc774 \ubc1c\uc0dd\ud558\ub294 \uac83\uc744 \ub9c9\uc744 \uc218 \uc788\ub294 \uac83\uc774\ub2e4."),(0,l.kt)(r.Z,{mdxType:"Tabs"},(0,l.kt)(o.Z,{value:"contracts/ERC1967/ERC1967.sol",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sol"},'// SPDX-License-Identifier: MIT\n\npragma solidity ^0.8.0;\n\nimport "@openzeppelin/contracts/proxy/ERC1967/ERC1967Proxy.sol";\nimport "@openzeppelin/contracts/access/Ownable.sol";\n\ncontract ERC1967 is ERC1967Proxy, Ownable {\n    constructor(address _logic, bytes memory _data)\n        payable\n        ERC1967Proxy(_logic, _data)\n    {}\n\n    function upgradeTo(address newImplementation) external onlyOwner {\n        _upgradeToAndCall(newImplementation, bytes(""), false);\n    }\n\n    function upgradeToAndCall(address newImplementation, bytes calldata data)\n        external\n        payable\n        onlyOwner\n    {\n        _upgradeToAndCall(newImplementation, data, true);\n    }\n\n    function implementation() external view returns (address) {\n        return _implementation();\n    }\n}\n'))),(0,l.kt)(o.Z,{value:"contracts/ERC1967/v1.sol",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sol"},"//SPDX-License-Identifier: Unlicense\npragma solidity ^0.8.0;\n\ncontract ERC1967ImplementationV1 {\n    mapping(address => uint256) public counts;\n\n    function count() external {\n        counts[msg.sender] += 1;\n    }\n}\n"))),(0,l.kt)(o.Z,{value:"contracts/ERC1967/v2.sol",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-solidity"},"//SPDX-License-Identifier: Unlicense\npragma solidity ^0.8.0;\n\ncontract ERC1967ImplementationV2 {\n    mapping(address => uint256) public counts;\n\n    function count() external {\n        counts[msg.sender] += 2;\n    }\n}\n")))),(0,l.kt)("p",null,"\uc704\uc640 \uac19\uc774 ERC1967\uc744 \ud1b5\ud574 \uc5c5\uadf8\ub808\uc774\ub4dc \uac00\ub2a5\ud55c \ucee8\ud2b8\ub799\ud2b8\ub97c \uad6c\ud604\ud558\uc600\uc744 \ub54c, \ub354 \uc774\uc0c1 \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc5d0 \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8 \uc8fc\uc18c\uac00 \ub2f4\uae34 \ubcc0\uc218\ub97c \uc21c\uc11c\uc5d0 \ub9de\uac8c \uc120\uc5b8\ud574\uc904 \ud544\uc694\uac00 \uc5c6\uc5b4\uc9c4 \uac83\uc744 \ubcfc \uc218 \uc788\ub2e4. \uc65c\ub0d0\ud558\uba74 \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8 \uc8fc\uc18c\ub294 ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/StorageSlot.sol"},"StorageSlot")," \ub77c\uc774\ube0c\ub7ec\ub9ac\ub97c \ud65c\uc6a9\ud558\uc5ec \ubbf8\ub9ac \uc815\ud574\uc9c4 \uc2ac\ub86f\ub118\ubc84\uc758 \uc2a4\ud1a0\ub9ac\uc9c0\uc2ac\ub86f\uc5d0 \uc800\uc7a5\ub418\uae30 \ub54c\ubb38\uc774\ub2e4."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sol",metastring:'title="contracts/ERC1967/v4.sol"',title:'"contracts/ERC1967/v4.sol"'},'//SPDX-License-Identifier: Unlicense\npragma solidity ^0.8.0;\n\nimport "@openzeppelin/contracts/utils/StorageSlot.sol";\n\ncontract ERC1967ImplementationV4 {\n    bytes32 internal constant _IMPLEMENTATION_SLOT =\n        0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;\n\n    mapping(address => uint256) public counts;\n\n    function count() external {\n        counts[msg.sender] += 3;\n    }\n\n    function storageTest(address _target) external {\n        StorageSlot.getAddressSlot(_IMPLEMENTATION_SLOT).value = _target;\n    }\n\n    function getAddress() external view returns (address target_) {\n        target_ = StorageSlot.getAddressSlot(_IMPLEMENTATION_SLOT).value;\n    }\n}\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'console.log("V4 ------ storage test ------");  \nconst storageTest = await proxy.storageTest(users[0].address);  await storageTest.wait();  \nconsole.log("users[0]:", users[0].address);  console.log("implementation:", await erc1967Proxy.implementation());\n\ud14c\uc2a4\ud2b8 \uacb0\uacfc\nV4 ------ storage test ------\nusers[0]: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\nimplementation: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\n')),(0,l.kt)("p",null,"\ucc38\uace0\ub85c \ub2f9\uc5f0\ud55c \uacb0\uacfc\uaca0\uc9c0\ub9cc, \ud504\ub85d\uc2dc \ucee8\ud2b8\ub799\ud2b8\uc5d0\uc11c \uc0ac\uc6a9\ud558\uace0 \uc788\ub294 \uc2ac\ub86f\ub118\ubc84\ub97c \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc5d0\uc11c \ub3d9\uc77c\ud558\uac8c \uc0ac\uc6a9\ud558\uac8c \ub418\uba74 \uc2a4\ud1a0\ub9ac\uc9c0 \ucda9\ub3cc\uc774 \ubc1c\uc0dd\ud55c\ub2e4."),(0,l.kt)("hr",null),"\ubb3c\ub860 \uc774\uc640 \uac19\uc740 \ubc29\uc2dd\uc744 \ud1b5\ud574 \ud574\uacb0\ud55c \uac83\uc740 \ud504\ub85d\uc2dc \ucee8\ud2b8\ub799\ud2b8\uc5d0 \ud544\uc218\uc801\uc73c\ub85c \ud544\uc694\ud55c \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8 \uc8fc\uc18c \ubcc0\uc218\uc5d0 \ud55c\uc815\ub41c \uc2a4\ud1a0\ub9ac\uc9c0 \ucda9\ub3cc\uc774\ub2e4. \uc5c5\uadf8\ub808\uc774\ub4dc \ub418\ub294 \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc5d0 \uc120\uc5b8\ub41c \ubcc0\uc218\uac00 \uc774\uc804 \ubc84\uc804\uc758 \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc5d0\uc11c \uc0ac\uc6a9\ub418\ub358 \ubcc0\uc218\uc640 \ucda9\ub3cc\ud560 \uc218 \uc788\ub294 \uc704\ud5d8\uc740 \uc5ec\uc804\ud788 \uadf8\ub300\ub85c \uc874\uc7ac\ud55c\ub2e4.",(0,l.kt)("p",null,"\uadf8\ub807\ub2e4\uba74 \uc2a4\ud1a0\ub9ac\uc9c0 \ucda9\ub3cc \uc774\uc678\uc5d0\ub294 \ud504\ub85d\uc2dc \ud328\ud134\uc758 \ub2e8\uc810\uc740 \uc874\uc7ac\ud558\uc9c0 \uc54a\uace0 \uc774\uc81c ERC1967\uc744 \uadf8\ub300\ub85c \uc0ac\uc6a9\ud558\uae30\ub9cc \ud558\uba74 \ub418\ub294 \uac83\uc77c\uae4c?"),(0,l.kt)("h3",{id:"\uc0dd\uc131\uc790-\ud568\uc218"},"\uc0dd\uc131\uc790 \ud568\uc218"),(0,l.kt)("p",null,"\uc774 \ub2e8\uc810\uc740 ERC1967\uc758 \ub2e8\uc810\uc774\ub77c\uae30 \ubcf4\ub2e4\ub294 delegatecall\uc744 \uae30\ubc18\uc73c\ub85c \ud558\ub294 \ud504\ub85d\uc2dc \ud328\ud134 \uc790\uccb4\uc758 \ub2e8\uc810\uc774\ub77c\uace0 \ubcfc \uc218 \uc788\ub2e4."),(0,l.kt)("p",null,"\ud504\ub85d\uc2dc \ud328\ud134\uc744 \uad6c\ud604\ud560 \ub54c \ub85c\uc9c1\uc774 \ub2f4\uae34 \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc5d0\uc11c\ub294 constructor\ub97c \uc0ac\uc6a9\ud560 \uc218 \uc5c6\ub2e4. \uc815\ud655\ud788 \ub9d0\ud574 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\ub2e4\uae30\ubcf4\ub2e4\ub294 \uc124\uc0ac \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc5d0\uc11c \uc0dd\uc131\uc790 \ud568\uc218\ub97c \uc0ac\uc6a9\ud558\uc5ec \ubcc0\uc218\ub4e4\uc5d0 \uac12\uc744 \ucd08\uae30\ud654\ud588\ub2e4\uace0 \ud558\ub354\ub77c\ub3c4 \uc758\ubbf8\uac00 \uc5c6\ub2e4."),(0,l.kt)("p",null,"\uc774\uc804 \uae00\uc5d0\uc11c \ubcf4\uc558\ub4ef\uc774 \ud504\ub85d\uc2dc \ud328\ud134\uc758 \uae30\ubcf8 \uc544\uc774\ub514\uc5b4\ub294 \ub370\uc774\ud130\uc640 \ub85c\uc9c1\uc744 \ubd84\ub9ac\ud558\ub294 \uac83\uc774\uace0, \ub370\uc774\ud130\ub294 \uc0c8\ub86d\uac8c \ubc30\ud3ec\ub41c \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc758 \uc2a4\ud1a0\ub9ac\uc9c0\ub97c \ud65c\uc6a9\ud558\ub294 \uac83\uc774 \uc544\ub2c8\ub77c \uc774\ubbf8 \ubc30\ud3ec\ub418\uc5b4\uc788\ub358 \ud504\ub85d\uc2dc \ucee8\ud2b8\ub799\ud2b8\uc758 \uc2a4\ud1a0\ub9ac\uc9c0\ub97c \uc774\uc5b4\uc11c \ud65c\uc6a9\ud55c\ub2e4\ub294 \uac83\uc774 \uc5c5\uadf8\ub808\uc774\ub4dc\uc758 \uc758\ubbf8\uc774\uae30 \ub54c\ubb38\uc774\ub2e4."),(0,l.kt)("p",null,"\uc2e4\uc81c \ud504\ub85c\ub355\ud2b8\ub85c \ud65c\uc6a9\ub418\uace0 \uc788\ub294 \ucee8\ud2b8\ub799\ud2b8 \ub370\uc774\ud130\ub294 \ud504\ub85d\uc2dc \ucee8\ud2b8\ub799\ud2b8\uc758 \ub370\uc774\ud130\uc77c \uac83\uc774\uae30 \ub54c\ubb38\uc5d0, \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uac00 \ubc30\ud3ec\ub418\uba74\uc11c \uc2e4\ud589\ub41c \uc0dd\uc131\uc790 \ud568\uc218\uc758 \ub85c\uc9c1\uc740 \uc758\ubbf8\uc5c6\uc774 \ub3d9\uc791\ud55c \ucc44\ub85c \ub05d\ub0a0 \uac83\uc774\ub2e4. \uc0dd\uc131\uc790 \ud568\uc218\ub294 \ucee8\ud2b8\ub799\ud2b8\uac00 \ubc30\ud3ec\ub418\ub294 \uc21c\uac04\uc5d0 \ud55c \ubc88 \uc2e4\ud589\ub41c \uc774\ud6c4\ub85c \ud504\ub85d\uc2dc \ucee8\ud2b8\ub799\ud2b8\uc5d0\uc11c \ud638\ucd9c\ud560 \uc218 \uc5c6\uae30 \ub54c\ubb38\uc5d0, \ub9cc\uc57d \ucd08\uae30 \uc14b\ud305\uc774 \ud544\uc694\ud558\ub2e4\uba74 \uc0dd\uc131\uc790 \ud568\uc218\uac00 \uc544\ub2cc \ub2e4\ub978 \ubc29\uc2dd\uc744 \uc0ac\uc6a9\ud574\uc57c \ud55c\ub2e4."),(0,l.kt)("p",null,"\uc77c\ubc18\uc801\uc73c\ub85c \uc0ac\uc6a9\ub418\ub294 \ubc29\uc2dd\uc740 \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc5d0\uc11c \uc784\uc758\uc758 \ucd08\uae30\ud654 \ud568\uc218\ub97c \ub9cc\ub4e4\uc5b4\ub193\uace0 \ubc84\uc804 \ubcc4\ub85c \ub531 \ud55c \ubc88\ub9cc \uc2e4\ud589\ub418\uace0, \ud55c \ubc88 \ud638\ucd9c\ub41c \uc774\ud6c4\ub85c\ub294 \ud638\ucd9c\ub418\ub354\ub77c\ub3c4 \uc2e4\ud589\ub418\uc9c0 \uc54a\uac8c ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/proxy/utils/Initializable.sol#L107"},"\uc81c\ud55c \ud574\ub193\ub294 \ubc29\uc2dd"),"\uc774\ub2e4."),(0,l.kt)("p",null,"\uac19\uc740 \uc774\uc720\ub85c \ud504\ub85d\uc2dc \ud328\ud134\uc744 \uc0ac\uc6a9\ud560 \ub54c\ub294 \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\ub97c \uc791\uc131\ud560 \ub54c \ubcc0\uc218\uc5d0 \ucd08\uae30\uac12\uc744 \ub300\uc785\ud558\ub294 \ubc29\uc2dd\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\ub2e4. \ub300\uc785\ud55c \uac12\uc740 \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc758 \uc2a4\ud1a0\ub9ac\uc9c0\uc5d0 \uc800\uc7a5\ub3fc\uc788\uc744 \ubfd0, \ud504\ub85d\uc2dc \ucee8\ud2b8\ub799\ud2b8\uc758 \uc2a4\ud1a0\ub9ac\uc9c0\uc640\ub294 \uc0c1\uad00\uc774 \uc5c6\uae30 \ub54c\ubb38\uc774\ub2e4."),(0,l.kt)("h3",{id:"\ud568\uc218-\ucda9\ub3cc"},"\ud568\uc218 \ucda9\ub3cc"),(0,l.kt)("p",null,"\ub2e4\uc2dc ERC1967\ub85c \ub3cc\uc544\uc640\uc11c, ERC1967\uc744 \uc0ac\uc6a9\ud588\uc744 \ub54c \ubc1c\uc0dd\ud560 \uc218 \uc788\ub294 \uc704\ud5d8 \uc911\uc5d0\ub294 \uc2a4\ud1a0\ub9ac\uc9c0 \ucda9\ub3cc\ub9cc \uc874\uc7ac\ud558\ub294 \uac83\uc740 \uc544\ub2c8\ub2e4. \uc704\uc5d0\uc11c \ud14c\uc2a4\ud2b8\ub97c \uc704\ud574 \uad6c\ud604\ub41c ERC1967 \ucee8\ud2b8\ub799\ud2b8\ub97c \uc0b4\ud3b4\ubcf4\uba74, \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc758 \uc8fc\uc18c\ub97c \ubcc0\uacbd\ud558\ub294 ",(0,l.kt)("inlineCode",{parentName:"p"},"upgradeTo")," \ud568\uc218\uc640 \uc5c5\uadf8\ub808\uc774\ub4dc \ud558\uba74\uc11c \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc5d0 \ubbf8\ub9ac \uc791\uc131\ud574\ub193\uc740 \ucd08\uae30\ud654 \ud568\uc218\ub97c \ud568\uaed8 \ud638\ucd9c\ud558\ub294 \uacbd\uc6b0\uc5d0 \ud65c\uc6a9\ud558\ub294 ",(0,l.kt)("inlineCode",{parentName:"p"},"upgradeToAndCall")," \ud568\uc218, \uadf8\ub9ac\uace0 \ud604\uc7ac \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc758 \uc8fc\uc18c\ub97c \uc870\ud68c\ud558\ub294 ",(0,l.kt)("inlineCode",{parentName:"p"},"implementation")," \ud568\uc218\uac00 \uc678\ubd80 \ud568\uc218\ub85c \uc874\uc7ac\ud558\ub294 \uac83\uc744 \ubcfc \uc218 \uc788\ub2e4."),(0,l.kt)("p",null,"\uc6b0\ub9ac\ub294 \uc5ec\uae30\uc11c \ud55c \uac00\uc9c0 \ud569\ub2f9\ud55c \uad81\uae08\uc99d\uc744 \uac00\uc9c8 \uc218 \uc788\ub2e4. \ub9cc\uc57d \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc5d0\ub3c4 ",(0,l.kt)("inlineCode",{parentName:"p"},"upgradeTo"),"\ub77c\ub294 \uc774\ub984\uc758 \ud568\uc218\uac00 \uc874\uc7ac\ud55c\ub2e4\uba74, \ud504\ub85d\uc2dc \ucee8\ud2b8\ub799\ud2b8\ub85c ",(0,l.kt)("inlineCode",{parentName:"p"},"upgradeTo")," \ud568\uc218\ub97c \ud638\ucd9c \ud588\uc744 \ub54c, \ud504\ub85d\uc2dc \ucee8\ud2b8\ub799\ud2b8\uc5d0 \uc874\uc7ac\ud558\ub294 \ud568\uc218\uac00 \ub3d9\uc791\ud574\uc57c \uc815\uc0c1\uc801\uc73c\ub85c \ub3d9\uc791\ud55c \uac83\uc77c\uae4c \uc544\ub2c8\uba74 \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc5d0 \uc874\uc7ac\ud558\ub294 \ud568\uc218\uac00 \ub3d9\uc791\ud574\uc57c \uc815\uc0c1\uc801\uc73c\ub85c \ub3d9\uc791\ud55c \uac83\uc77c\uae4c?"),(0,l.kt)("p",null,"\ud504\ub85d\uc2dc \ucee8\ud2b8\ub799\ud2b8\uc5d0 \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc758 \uc8fc\uc18c\uac12\uc774 \uaf2d \ud544\uc694\ud55c \uac83\ucc98\ub7fc, \uc5c5\uadf8\ub808\uc774\ub4dc\ub97c \uc704\ud574\uc11c\ub294 \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc758 \uc8fc\uc18c\ub97c \uc218\uc815\ud558\ub294 \ub85c\uc9c1\uc758 \ud568\uc218\uac00 \uaf2d \ud544\uc694\ud558\ub2e4. \ubb3c\ub860 \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\ub97c \uc791\uc131\ud558\ub294 \uac1c\ubc1c\uc790\uac00 \uc774 \uc810\uc744 \uc798 \uc219\uc9c0\ud558\uace0 \uc788\uc744 \uac83\uc774\uae30 \ub54c\ubb38\uc5d0 \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc5d0 \uad73\uc774 \ud504\ub85d\uc2dc \ucee8\ud2b8\ub799\ud2b8\uc5d0\uc11c \uc790\uccb4\uc801\uc73c\ub85c \uc0ac\uc6a9\ud558\ub294 \ud568\uc218\uc640 \ub3d9\uc77c\ud55c \ud568\uc218\uba85\uacfc \uc778\uc790\ub97c \uac00\uc9c4 \ud568\uc218\ub97c \ub9cc\ub4e4\uc9c0\ub294 \uc54a\uc744 \uac83\uc774\ub2e4."),(0,l.kt)("p",null,"\ud558\uc9c0\ub9cc \uc0ac\ub78c\uc740 \uc5b8\uc81c\ub098 \uc2e4\uc218\ub97c \ud560 \uc218 \uc788\uc744 \ubfd0\ub354\ub7ec, \ub354 \uae4c\ub2e4\ub85c\uc6b4 \ubb38\uc81c\ub294 \ud568\uc218\uba85\uc774 \ub3d9\uc77c\ud558\uc9c0 \uc54a\ub354\ub77c\ub3c4 \ub3d9\uc77c\ud55c \ud568\uc218\ub85c \uc778\uc2dd\ub418\ub294 \uacbd\uc6b0\uac00 \ubc1c\uc0dd\ud560 \uc218 \uc788\ub2e4\ub294 \uac83\uc774\ub2e4."),(0,l.kt)("h3",{id:"\ucee8\ud2b8\ub799\ud2b8\uac00-\ud568\uc218\ub97c-\uc2dd\ubcc4\ud558\ub294-\ubc29\uc2dd"},"\ucee8\ud2b8\ub799\ud2b8\uac00 \ud568\uc218\ub97c \uc2dd\ubcc4\ud558\ub294 \ubc29\uc2dd"),(0,l.kt)("p",null,"\ucee8\ud2b8\ub799\ud2b8\uc5d0 \uc5b4\ub5a4 \ud568\uc218\ub97c \ud638\ucd9c\ud558\ub294 \uc694\uccad\uc774 \ub4e4\uc5b4\uc654\uc744 \ub54c, \ud638\ucd9c\ub41c \ud568\uc218\uac00 \ubb34\uc5c7\uc778\uc9c0\ub294 \ud2b8\ub79c\uc7ad\uc158\uc758 \ub370\uc774\ud130 \ud544\ub4dc(calldata)\uc5d0 \ub4e4\uc5b4\uc788\ub294 \ub370\uc774\ud130\ub4e4\uc744 \ud1b5\ud574 \uacb0\uc815\ub41c\ub2e4. \uc5ec\uae30\uc5d0\ub294 \ud568\uc218\uc758 \uc774\ub984\uacfc \uc778\uc790 \ud0c0\uc785\uc744 sha3 \ud574\uc2f1\ud55c \ud568\uc218 \uc2dc\uadf8\ub2c8\ucc98\uc758 4\ubc14\uc774\ud2b8 \ud568\uc218 \uc2dd\ubcc4\uc790\uc640 \uc778\uc790\uac12\ub4e4\uc774 \ud3ec\ud568\ub418\uc5b4\uc788\ub2e4."),(0,l.kt)("p",null,"fallback \ud568\uc218\ub97c \uae30\ubc18\uc73c\ub85c \uad6c\ud604\ub41c \ud504\ub85d\uc2dc \ucee8\ud2b8\ub799\ud2b8\ub294 calldata\uc5d0 \ub2f4\uae34 \ud568\uc218 \uc2dd\ubcc4\uc790\uc640 \ub3d9\uc77c\ud55c \uc2dd\ubcc4\uc790\ub97c \uac00\uc9c4 \ud568\uc218\uac00 \uc874\uc7ac\ud558\ub294\uc9c0 \ud655\uc778\ud558\uace0, \uc874\uc7ac\ud558\uc9c0 \uc54a\uc73c\uba74 fallback \ud568\uc218\ub97c \uc2e4\ud589\uc2dc\ud0ac \uac83\uc774\ub2e4. \uadf8\ub7ec\uba74 fallback \ud568\uc218\uc5d0\uc11c\ub294 \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc5d0 \ud574\ub2f9 \ud568\uc218\ub97c delegatecall \ud558\ub294 \ub85c\uc9c1\uc744 \uc218\ud589\ud560 \uac83\uc774\ub2e4."),(0,l.kt)("p",null,"\ubb38\uc81c\ub294 \ud568\uc218 \uc2dd\ubcc4\uc790\uac00 \ud574\uc2dc\uac12\uc758 \uc55e\ubd80\ubd84 4\ubc14\uc774\ud2b8 \uac12\ub9cc\uc73c\ub85c \uc774\ub8e8\uc5b4\uc9c4\ub2e4\ub294 \uac83\uc774\ub2e4. \ub54c\ubb38\uc5d0 \ud568\uc218\uba85\uacfc \uc778\uc790\uac00 \ub2e4\ub978 \ud568\uc218\ub77c\ud558\ub354\ub77c\ub3c4 \ub3d9\uc77c\ud55c \ud568\uc218 \uc2dd\ubcc4\uc790\ub97c \uac16\uac8c \ub418\ub294 \uacbd\uc6b0\uac00 \ubc1c\uc0dd\ud560 \uc218 \uc788\ub2e4. \ud558\ub098\uc758 \ucee8\ud2b8\ub799\ud2b8 \uc548\uc5d0\uc11c \ud568\uc218 \uc2dd\ubcc4\uc790\uac00 \ucda9\ub3cc\ub418\ub294 \uacbd\uc6b0\uc5d0\ub294 ",(0,l.kt)("a",{parentName:"p",href:"https://solidity-kr.readthedocs.io/ko/latest/using-the-compiler.html"},"\uc194\ub9ac\ub514\ud2f0 \ucef4\ud30c\uc77c\ub7ec"),"\uac00 \ucef4\ud30c\uc77c \uacfc\uc815\uc5d0\uc11c \uc5d0\ub7ec\ub97c \ubc1c\uc0dd\uc2dc\ud0a4\uae30 \ub54c\ubb38\uc5d0 \ubbf8\ub9ac \ubc29\uc9c0\ud560 \uc218 \uc788\ub2e4."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'"DeclarationError" : \uc720\ud6a8\ud558\uc9c0 \uc54a\uac70\ub098 \ud639\uc740 \uc758\uacb0 \ud560\uc218 \uc5c6\ub294(unresolvable), \uc2dd\ubcc4\uc790 \uc774\ub984\ucda9\ub3cc\uc785\ub2c8\ub2e4.\n')),(0,l.kt)("p",null,"\ud558\uc9c0\ub9cc \ud504\ub85d\uc2dc \ucee8\ud2b8\ub799\ud2b8\uc640 \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc5d0\uc11c\ucc98\ub7fc \uc11c\ub85c \ub2e4\ub978 \ucee8\ud2b8\ub799\ud2b8\uc5d0\uc11c \ud568\uc218 \uc2dd\ubcc4\uc790\uac00 \uc911\ubcf5\ub418\ub294 \uacbd\uc6b0\ub294 \ucef4\ud30c\uc77c \uacfc\uc815\uc5d0\uc11c \ubc29\uc9c0\ud560 \uc218 \uc5c6\ub2e4."),(0,l.kt)("hr",null),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sol",metastring:'title="contracts/ERC1967/v3.sol"',title:'"contracts/ERC1967/v3.sol"'},"//SPDX-License-Identifier: Unlicense\npragma solidity ^0.8.0;\n\ncontract ERC1967ImplementationV3 {\n    mapping(address => uint256) public counts;\n\n    function count() external {\n        counts[msg.sender] += 3;\n    }\n\n    function upgradeTo(address _target) external {\n        counts[_target] += 3;\n    }\n}\n")),(0,l.kt)("p",null,"\uc704\ucc98\ub7fc \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc5d0 \ud504\ub85d\uc2dc \ucee8\ud2b8\ub799\ud2b8\uc640 \ub3d9\uc77c\ud55c \uc774\ub984\uacfc \ud30c\ub77c\ubbf8\ud130\ub97c \uac00\uc9c4 ",(0,l.kt)("inlineCode",{parentName:"p"},"upgradeTo")," \ud568\uc218\uac00 \uc788\uc744 \ub54c, \ud574\ub2f9 \ud568\uc218\ub97c \ud638\ucd9c\ud558\uba74 \uc5b4\ub5bb\uac8c \ub420\uae4c?"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},'console.log("V3 ------ upgradeTo function Error ------");  \nawait expect(proxy.upgradeTo(users[0].address)).to.be.revertedWith("ERC1967: new implementation is not a contract");\n')),(0,l.kt)("p",null,"\ud14c\uc2a4\ud2b8 \uacb0\uacfc\ub97c \ubcf4\uba74, \uc5c5\uadf8\ub808\uc774\ub4dc \ud558\ub824\ub294 \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc758 \uc8fc\uc18c\uac00 \ucee8\ud2b8\ub799\ud2b8\uc778\uc9c0 \ud655\uc778\ud558\ub294 require\ubb38\uc5d0 \uac78\ub824 revert \ub418\ub294 \uac83\uc744 \ubcfc \uc218 \uc788\ub2e4."),(0,l.kt)("p",null,"\ud504\ub85d\uc2dc \ucee8\ud2b8\ub799\ud2b8\uc5d0\ub294 \ud574\ub2f9 \ud568\uc218\uc2dd\ubcc4\uc790\ub97c \uac00\uc9c4 \ud568\uc218\uac00 \uc774\ubbf8 \uc874\uc7ac\ud558\uae30 \ub54c\ubb38\uc5d0 fallback \ud568\uc218\ub85c \ub118\uc5b4\uac00\uc9c0 \uc54a\uace0 \ud504\ub85d\uc2dc \ucee8\ud2b8\ub799\ud2b8\uc758 ",(0,l.kt)("inlineCode",{parentName:"p"},"upgradeTo")," \ud568\uc218\uac00 \uc2e4\ud589\ub41c\ub2e4."),(0,l.kt)("p",null,"\ub9cc\uc57d \ud568\uc218\ud638\ucd9c\uc790\uac00 \ucee8\ud2b8\ub799\ud2b8\ub97c \uc5c5\uadf8\ub808\uc774\ub4dc \ud558\ub824\ub358\uac8c \uc544\ub2c8\ub77c, \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc5d0 \uc788\ub294 target \uc8fc\uc18c\uc5d0 \uce74\uc6b4\ud2b8\ub97c 3 \ub354 \ud574\uc8fc\ub294 \uae30\ub2a5\uc744 \uc218\ud589\ud558\uace0 \uc2f6\uc5c8\ub358 \uac83\uc774\ub77c\uba74 \uc694\uccad\uc758 \uc2e4\ud328\uac00 \ubb34\ucc99 \ub2f9\ud669\uc2a4\uc6e0\uc744 \uac83\uc774\ub2e4."),(0,l.kt)("p",null,"\uc774\ucc98\ub7fc \ud638\ucd9c\uc790\uc758 \uc758\ub3c4\uc640\ub294 \ub2e4\ub974\uac8c \ucee8\ud2b8\ub799\ud2b8\uc758 \uae30\ub2a5\ub4e4\uc774 \ub3d9\uc791\ud560 \uc218 \uc788\uae30 \ub54c\ubb38\uc5d0 ERC1967\uc744 \uc0ac\uc6a9\ud560 \ub54c\ub294 \ud568\uc218 \ucda9\ub3cc\uc758 \ubb38\uc81c\ub97c \uace0\ub824\ud574\uc57c\ud55c\ub2e4."))}b.isMDXComponent=!0}}]);