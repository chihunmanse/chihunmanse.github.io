"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[6330],{1470(e,t,n){n.d(t,{A:()=>k});var a=n(8168),l=n(6540),r=n(53),o=n(3104),i=n(6347),s=n(7485),u=n(1682),c=n(9466);function g(e){return function(e){return l.Children.map(e,e=>{if(!e||(0,l.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}(e).map(({props:{value:e,label:t,attributes:n,default:a}})=>({value:e,label:t,attributes:n,default:a}))}function p(e){const{values:t,children:n}=e;return(0,l.useMemo)(()=>{const e=t??g(n);return function(e){const t=(0,u.X)(e,(e,t)=>e.value===t.value);if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[t,n])}function y({value:e,tabValues:t}){return t.some(t=>t.value===e)}function d({queryString:e=!1,groupId:t}){const n=(0,i.W6)(),a=function({queryString:e=!1,groupId:t}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:e,groupId:t});return[(0,s.aZ)(a),(0,l.useCallback)(e=>{if(!a)return;const t=new URLSearchParams(n.location.search);t.set(a,e),n.replace({...n.location,search:t.toString()})},[a,n])]}function m(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,r=p(e),[o,i]=(0,l.useState)(()=>function({defaultValue:e,tabValues:t}){if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!y({value:e,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${t.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const n=t.find(e=>e.default)??t[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:t,tabValues:r})),[s,u]=d({queryString:n,groupId:a}),[g,m]=function({groupId:e}){const t=function(e){return e?`docusaurus.tab.${e}`:null}(e),[n,a]=(0,c.Dv)(t);return[n,(0,l.useCallback)(e=>{t&&a.set(e)},[t,a])]}({groupId:a}),b=(()=>{const e=s??g;return y({value:e,tabValues:r})?e:null})();(0,l.useLayoutEffect)(()=>{b&&i(b)},[b]);return{selectedValue:o,selectValue:(0,l.useCallback)(e=>{if(!y({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);i(e),u(e),m(e)},[u,m,r]),tabValues:r}}var b=n(2303);const f="tabList__CuJ",v="tabItem_LNqP";function h({className:e,block:t,selectedValue:n,selectValue:i,tabValues:s}){const u=[],{blockElementScrollPositionUntilNextRender:c}=(0,o.a_)(),g=e=>{const t=e.currentTarget,a=u.indexOf(t),l=s[a].value;l!==n&&(c(t),i(l))},p=e=>{let t=null;switch(e.key){case"Enter":g(e);break;case"ArrowRight":{const n=u.indexOf(e.currentTarget)+1;t=u[n]??u[0];break}case"ArrowLeft":{const n=u.indexOf(e.currentTarget)-1;t=u[n]??u[u.length-1];break}}t?.focus()};return l.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":t},e)},s.map(({value:e,label:t,attributes:o})=>l.createElement("li",(0,a.A)({role:"tab",tabIndex:n===e?0:-1,"aria-selected":n===e,key:e,ref:e=>u.push(e),onKeyDown:p,onClick:g},o,{className:(0,r.A)("tabs__item",v,o?.className,{"tabs__item--active":n===e})}),t??e)))}function N({lazy:e,children:t,selectedValue:n}){const a=(Array.isArray(t)?t:[t]).filter(Boolean);if(e){const e=a.find(e=>e.props.value===n);return e?(0,l.cloneElement)(e,{className:"margin-top--md"}):null}return l.createElement("div",{className:"margin-top--md"},a.map((e,t)=>(0,l.cloneElement)(e,{key:t,hidden:e.props.value!==n})))}function S(e){const t=m(e);return l.createElement("div",{className:(0,r.A)("tabs-container",f)},l.createElement(h,(0,a.A)({},e,t)),l.createElement(N,(0,a.A)({},e,t)))}function k(e){const t=(0,b.A)();return l.createElement(S,(0,a.A)({key:String(t)},e))}},4386(e,t,n){n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>y,frontMatter:()=>i,metadata:()=>u,toc:()=>g});var a=n(8168),l=(n(6540),n(5680)),r=n(1470),o=n(9365);const i={title:"Solidity Storage Layout",description:"Understanding Solidity storage layout and slot allocation rules",keywords:["solidity","ethereum","assembly","evm"],tags:["Solidity","EVM"],sidebar_position:3},s="Solidity Storage Layout",u={unversionedId:"blockchain/storage-layout",id:"blockchain/storage-layout",title:"Solidity Storage Layout",description:"Understanding Solidity storage layout and slot allocation rules",source:"@site/docs/04-blockchain/03-storage-layout.mdx",sourceDirName:"04-blockchain",slug:"/blockchain/storage-layout",permalink:"/blockchain/storage-layout",draft:!1,tags:[{label:"Solidity",permalink:"/tags/solidity"},{label:"EVM",permalink:"/tags/evm"}],version:"current",sidebarPosition:3,frontMatter:{title:"Solidity Storage Layout",description:"Understanding Solidity storage layout and slot allocation rules",keywords:["solidity","ethereum","assembly","evm"],tags:["Solidity","EVM"],sidebar_position:3},sidebar:"docs",previous:{title:"Contract Error Handling",permalink:"/blockchain/contract-error-handling"},next:{title:"DeFi",permalink:"/blockchain/defi/"}},c={},g=[{value:"EVM \uc2a4\ud1a0\ub9ac\uc9c0 \uad6c\uc870",id:"evm-\uc2a4\ud1a0\ub9ac\uc9c0-\uad6c\uc870",level:2},{value:"\uae30\ubcf8 \ud560\ub2f9 \uaddc\uce59",id:"\uae30\ubcf8-\ud560\ub2f9-\uaddc\uce59",level:2},{value:"Storage Packing",id:"storage-packing",level:2},{value:"\ud328\ud0b9 \uaddc\uce59",id:"\ud328\ud0b9-\uaddc\uce59",level:3},{value:"\ud328\ud0b9 \uc21c\uc11c\uc758 \uc911\uc694\uc131",id:"\ud328\ud0b9-\uc21c\uc11c\uc758-\uc911\uc694\uc131",level:3},{value:"\uc5ec\ub7ec \uc791\uc740 \ud0c0\uc785\uc758 \ud328\ud0b9",id:"\uc5ec\ub7ec-\uc791\uc740-\ud0c0\uc785\uc758-\ud328\ud0b9",level:3},{value:"\ub3d9\uc801 \ud0c0\uc785\uc758 \uc800\uc7a5 \ubc29\uc2dd",id:"\ub3d9\uc801-\ud0c0\uc785\uc758-\uc800\uc7a5-\ubc29\uc2dd",level:2},{value:"Mapping",id:"mapping",level:3},{value:"\uc911\ucca9 \ub9e4\ud551",id:"\uc911\ucca9-\ub9e4\ud551",level:4},{value:"Dynamic Array",id:"dynamic-array",level:3},{value:"Bytes\uc640 Strings",id:"bytes\uc640-strings",level:2},{value:"\uc9e7\uc740 \ub370\uc774\ud130 (31\ubc14\uc774\ud2b8 \uc774\ud558)",id:"\uc9e7\uc740-\ub370\uc774\ud130-31\ubc14\uc774\ud2b8-\uc774\ud558",level:3},{value:"\uae34 \ub370\uc774\ud130 (32\ubc14\uc774\ud2b8 \uc774\uc0c1)",id:"\uae34-\ub370\uc774\ud130-32\ubc14\uc774\ud2b8-\uc774\uc0c1",level:3},{value:"Structs\uc640 \uc0c1\uc18d",id:"structs\uc640-\uc0c1\uc18d",level:2},{value:"Struct \uc800\uc7a5",id:"struct-\uc800\uc7a5",level:3},{value:"\uc0c1\uc18d\uacfc C3 Linearization",id:"\uc0c1\uc18d\uacfc-c3-linearization",level:3},{value:"Assembly\ub85c \uc2a4\ud1a0\ub9ac\uc9c0 \uc811\uadfc",id:"assembly\ub85c-\uc2a4\ud1a0\ub9ac\uc9c0-\uc811\uadfc",level:2},{value:"sload\uc640 sstore",id:"sload\uc640-sstore",level:3},{value:"\ud328\ud0b9\ub41c \uc2ac\ub86f\uc758 \uac1c\ubcc4 \uac12 \uc811\uadfc",id:"\ud328\ud0b9\ub41c-\uc2ac\ub86f\uc758-\uac1c\ubcc4-\uac12-\uc811\uadfc",level:3},{value:"\uc815\ub9ac",id:"\uc815\ub9ac",level:2},{value:"\ud504\ub85d\uc2dc \ud328\ud134\uacfc\uc758 \uc5f0\uad00\uc131",id:"\ud504\ub85d\uc2dc-\ud328\ud134\uacfc\uc758-\uc5f0\uad00\uc131",level:3},{value:"\uac00\uc2a4 \ucd5c\uc801\ud654 \ud301",id:"\uac00\uc2a4-\ucd5c\uc801\ud654-\ud301",level:3},{value:"\ucc38\uc870",id:"\ucc38\uc870",level:2}],p={toc:g};function y({components:e,...t}){return(0,l.yg)("wrapper",(0,a.A)({},p,t,{components:e,mdxType:"MDXLayout"}),(0,l.yg)("h1",{id:"solidity-storage-layout"},"Solidity Storage Layout"),(0,l.yg)("p",null,"EVM\uc758 \uc2a4\ud1a0\ub9ac\uc9c0\ub294 \uc2a4\ub9c8\ud2b8 \ucee8\ud2b8\ub799\ud2b8\uc758 \uc0c1\ud0dc\ub97c \uc601\uad6c\uc801\uc73c\ub85c \uc800\uc7a5\ud558\ub294 \uacf5\uac04\uc774\ub2e4. \ucee8\ud2b8\ub799\ud2b8\uc758 \uc0c1\ud0dc \ubcc0\uc218\ub4e4\uc774 \uc5b4\ub5a4 \uaddc\uce59\uc5d0 \ub530\ub77c \uc2a4\ud1a0\ub9ac\uc9c0\uc5d0 \ubc30\uce58\ub418\ub294\uc9c0 \uc774\ud574\ud558\ub294 \uac83\uc740 \uac00\uc2a4 \ucd5c\uc801\ud654, \ud504\ub85d\uc2dc \ud328\ud134 \uad6c\ud604, \uadf8\ub9ac\uace0 \ubcf4\uc548 \ucde8\uc57d\uc810 \ubc29\uc9c0\ub97c \uc704\ud574 \uc911\uc694\ud558\ub2e4."),(0,l.yg)("p",null,(0,l.yg)("a",{parentName:"p",href:"/blockchain/upgradeable-contract/delegate-call"},"\uc774\uc804 \uae00"),"\uc5d0\uc11c delegatecall\uc744 \uc0ac\uc6a9\ud560 \ub54c \uc2a4\ud1a0\ub9ac\uc9c0 \ucda9\ub3cc \ubb38\uc81c\ub97c \uac04\ub7b5\ud788 \ub2e4\ub918\ub294\ub370, \uc774\ubc88 \uae00\uc5d0\uc11c\ub294 \uc2a4\ud1a0\ub9ac\uc9c0 \ub808\uc774\uc544\uc6c3 \uc790\uccb4\uc5d0 \ub300\ud574 \uae4a\uc774 \uc788\uac8c \uc0b4\ud3b4\ubcf4\ub824\uace0 \ud55c\ub2e4."),(0,l.yg)("h2",{id:"evm-\uc2a4\ud1a0\ub9ac\uc9c0-\uad6c\uc870"},"EVM \uc2a4\ud1a0\ub9ac\uc9c0 \uad6c\uc870"),(0,l.yg)("p",null,"EVM\uc758 \uc2a4\ud1a0\ub9ac\uc9c0\ub294 ",(0,l.yg)("strong",{parentName:"p"},"2^256\uac1c\uc758 \uc2ac\ub86f"),"\uc73c\ub85c \uad6c\uc131\ub41c key-value \uc800\uc7a5\uc18c\uc774\ub2e4. \uac01 \uc2ac\ub86f\uc740 ",(0,l.yg)("strong",{parentName:"p"},"32\ubc14\uc774\ud2b8(256\ube44\ud2b8)")," \ud06c\uae30\ub97c \uac00\uc9c0\uba70, \uc2ac\ub86f \ubc88\ud638(0\ubd80\ud130 \uc2dc\uc791)\ub97c \ud0a4\ub85c \uc0ac\uc6a9\ud558\uc5ec \uac12\uc5d0 \uc811\uadfc\ud55c\ub2e4."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Slot 0  \u2502  32 bytes (256 bits)                              \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Slot 1  \u2502  32 bytes (256 bits)                              \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Slot 2  \u2502  32 bytes (256 bits)                              \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502   ...   \u2502  ...                                              \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Slot 2^256-1 \u2502  32 bytes (256 bits)                         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n")),(0,l.yg)("p",null,"\uc2a4\ud1a0\ub9ac\uc9c0 \uc77d\uae30(",(0,l.yg)("inlineCode",{parentName:"p"},"SLOAD"),")\uc640 \uc4f0\uae30(",(0,l.yg)("inlineCode",{parentName:"p"},"SSTORE"),")\ub294 EVM\uc5d0\uc11c \uac00\uc7a5 \ube44\uc6a9\uc774 \ub9ce\uc774 \ub4dc\ub294 \uc5f0\uc0b0 \uc911 \ud558\ub098\uc774\ub2e4. \ud2b9\ud788 0\uc774 \uc544\ub2cc \uac12\uc744 \ucc98\uc74c \uc4f8 \ub54c\ub294 20,000 \uac00\uc2a4\uac00 \uc18c\ubaa8\ub418\uba70, \uc774\ubbf8 \uac12\uc774 \uc788\ub294 \uc2ac\ub86f\uc744 \uc218\uc815\ud560 \ub54c\ub3c4 5,000 \uac00\uc2a4\uac00 \ub4e0\ub2e4. \uc774\ub7ec\ud55c \ube44\uc6a9 \uad6c\uc870 \ub54c\ubb38\uc5d0 \uc2a4\ud1a0\ub9ac\uc9c0 \ub808\uc774\uc544\uc6c3\uc744 \ud6a8\uc728\uc801\uc73c\ub85c \uc124\uacc4\ud558\ub294 \uac83\uc774 \uc911\uc694\ud558\ub2e4."),(0,l.yg)("h2",{id:"\uae30\ubcf8-\ud560\ub2f9-\uaddc\uce59"},"\uae30\ubcf8 \ud560\ub2f9 \uaddc\uce59"),(0,l.yg)("p",null,"Solidity\ub294 \uc0c1\ud0dc \ubcc0\uc218\ub97c ",(0,l.yg)("strong",{parentName:"p"},"\uc120\uc5b8\ub41c \uc21c\uc11c"),"\ub300\ub85c \uc2ac\ub86f\uc5d0 \ud560\ub2f9\ud55c\ub2e4. \uccab \ubc88\uc9f8 \ubcc0\uc218\ub294 \uc2ac\ub86f 0\ubd80\ud130 \uc2dc\uc791\ud558\uba70, \uc774\ud6c4 \ubcc0\uc218\ub4e4\uc740 \uc21c\ucc28\uc801\uc73c\ub85c \ub2e4\uc74c \uc2ac\ub86f\uc5d0 \ubc30\uce58\ub41c\ub2e4."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sol",metastring:'title="contracts/storage-layout/BasicSlot.sol"',title:'"contracts/storage-layout/BasicSlot.sol"'},"contract BasicSlot {\n    // slot 0\n    uint256 public a = 1;\n    // slot 1\n    uint256 public b = 2;\n    // slot 2: addr(20 bytes) + flag(1 byte) = 21 bytes packed\n    address public addr = 0x1234567890123456789012345678901234567890;\n    bool public flag = true;\n}\n")),(0,l.yg)("p",null,"\uc704 \ucf54\ub4dc\uc5d0\uc11c ",(0,l.yg)("inlineCode",{parentName:"p"},"uint256")," \ud0c0\uc785\uc778 ",(0,l.yg)("inlineCode",{parentName:"p"},"a"),"\uc640 ",(0,l.yg)("inlineCode",{parentName:"p"},"b"),"\ub294 \uac01\uac01 32\ubc14\uc774\ud2b8 \uc804\uccb4\ub97c \uc0ac\uc6a9\ud558\ubbc0\ub85c \uc2ac\ub86f 0\uacfc 1\uc5d0 \uac1c\ubcc4\uc801\uc73c\ub85c \uc800\uc7a5\ub41c\ub2e4. \ubc18\uba74 ",(0,l.yg)("inlineCode",{parentName:"p"},"address"),"(20\ubc14\uc774\ud2b8)\uc640 ",(0,l.yg)("inlineCode",{parentName:"p"},"bool"),"(1\ubc14\uc774\ud2b8)\uc740 \ud569\uccd0\uc11c 21\ubc14\uc774\ud2b8\uc774\ubbc0\ub85c \uc2ac\ub86f 2\uc5d0 \ud568\uaed8 \ud328\ud0b9\ub41c\ub2e4."),(0,l.yg)("p",null,"\uc2e4\uc81c\ub85c \uc2ac\ub86f \uac12\uc744 \ud655\uc778\ud574\ubcf4\uba74:"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-ts",metastring:'title="test/storage-layout/StorageLayout.test.ts"',title:'"test/storage-layout/StorageLayout.test.ts"'},'it("Variables are allocated to slots in declaration order", async function () {\n  const BasicSlot = await ethers.getContractFactory("BasicSlot");\n  const contract = await BasicSlot.deploy();\n\n  // slot 0: a = 1\n  const slot0 = await contract.getSlot(0);\n  expect(BigInt(slot0)).to.equal(1n);\n\n  // slot 1: b = 2\n  const slot1 = await contract.getSlot(1);\n  expect(BigInt(slot1)).to.equal(2n);\n\n  // slot 2: addr(20 bytes) + flag(1 byte) packed\n  // lower-order aligned: addr on right, flag on left\n  const slot2 = await contract.getSlot(2);\n\n  // address: rightmost 20 bytes (40 hex chars)\n  const addr = "0x" + slot2.slice(-40).toLowerCase();\n  expect(addr).to.equal("0x1234567890123456789012345678901234567890");\n\n  // flag: 1 byte to the left of address (21st byte)\n  // slot2 is 0x + 64 chars, rightmost 40 chars are addr, next 2 chars are flag\n  const flagHex = slot2.slice(-42, -40);\n  expect(parseInt(flagHex, 16)).to.equal(1); // true\n});\n')),(0,l.yg)("p",null,"\uc5ec\uae30\uc11c \uc8fc\ubaa9\ud560 \uc810\uc740 ",(0,l.yg)("strong",{parentName:"p"},"lower-order aligned")," \ubc29\uc2dd\uc774\ub2e4. \uac12\uc740 \uc2ac\ub86f\uc758 \uc624\ub978\ucabd(\ub0ae\uc740 \uc8fc\uc18c)\ubd80\ud130 \ucc44\uc6cc\uc9c4\ub2e4. \uc704 \uc608\uc2dc\uc5d0\uc11c ",(0,l.yg)("inlineCode",{parentName:"p"},"address"),"\uac00 \uba3c\uc800 \uc624\ub978\ucabd 20\ubc14\uc774\ud2b8\uc5d0 \uc800\uc7a5\ub418\uace0, ",(0,l.yg)("inlineCode",{parentName:"p"},"bool"),"\uc740 \uadf8 \uc67c\ucabd 1\ubc14\uc774\ud2b8\uc5d0 \uc800\uc7a5\ub41c\ub2e4."),(0,l.yg)("h2",{id:"storage-packing"},"Storage Packing"),(0,l.yg)("p",null,"32\ubc14\uc774\ud2b8 \ubbf8\ub9cc\uc758 \ubcc0\uc218\ub4e4\uc774 \uc5f0\uc18d\uc73c\ub85c \uc120\uc5b8\ub418\uba74 Solidity\ub294 \uc774\ub4e4\uc744 \ud558\ub098\uc758 \uc2ac\ub86f\uc5d0 ",(0,l.yg)("strong",{parentName:"p"},"\ud328\ud0b9"),"\ud55c\ub2e4. \uc774\ub97c \ud1b5\ud574 \uc2a4\ud1a0\ub9ac\uc9c0 \uc0ac\uc6a9\ub7c9\uacfc \uac00\uc2a4 \ube44\uc6a9\uc744 \uc808\uc57d\ud560 \uc218 \uc788\ub2e4."),(0,l.yg)("h3",{id:"\ud328\ud0b9-\uaddc\uce59"},"\ud328\ud0b9 \uaddc\uce59"),(0,l.yg)("ol",null,(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("strong",{parentName:"li"},"\uc5f0\uc18d\ub41c \uc791\uc740 \ubcc0\uc218\ub4e4"),"\uc740 32\ubc14\uc774\ud2b8 \uc774\ub0b4\ub77c\uba74 \uac19\uc740 \uc2ac\ub86f\uc5d0 \uc800\uc7a5\ub41c\ub2e4."),(0,l.yg)("li",{parentName:"ol"},"\uc0c8 \ubcc0\uc218\uac00 \ub0a8\uc740 \uacf5\uac04\uc5d0 ",(0,l.yg)("strong",{parentName:"li"},"\ub4e4\uc5b4\uac00\uc9c0 \uc54a\uc73c\uba74")," \ub2e4\uc74c \uc2ac\ub86f\uc73c\ub85c \ub118\uc5b4\uac04\ub2e4."),(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("strong",{parentName:"li"},"Struct"),"\uc640 ",(0,l.yg)("strong",{parentName:"li"},"\ubc30\uc5f4"),"\uc740 \ud56d\uc0c1 \uc0c8 \uc2ac\ub86f\uc5d0\uc11c \uc2dc\uc791\ud55c\ub2e4."),(0,l.yg)("li",{parentName:"ol"},"Struct\ub098 \ubc30\uc5f4 ",(0,l.yg)("strong",{parentName:"li"},"\ub2e4\uc74c \ubcc0\uc218"),"\ub3c4 \uc0c8 \uc2ac\ub86f\uc5d0\uc11c \uc2dc\uc791\ud55c\ub2e4.")),(0,l.yg)("h3",{id:"\ud328\ud0b9-\uc21c\uc11c\uc758-\uc911\uc694\uc131"},"\ud328\ud0b9 \uc21c\uc11c\uc758 \uc911\uc694\uc131"),(0,l.yg)("p",null,"\ubcc0\uc218 \uc120\uc5b8 \uc21c\uc11c\uc5d0 \ub530\ub77c \uc2ac\ub86f \uc0ac\uc6a9\ub7c9\uc774 \ub2ec\ub77c\uc9c8 \uc218 \uc788\ub2e4."),(0,l.yg)(r.A,{mdxType:"Tabs"},(0,l.yg)(o.A,{value:"\ube44\ud6a8\uc728\uc801",mdxType:"TabItem"},(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sol"},"contract StoragePacking {\n    // slot 0: a (16 bytes)\n    uint128 public a = 1;\n    // slot 1: b (32 bytes) - \uc0c8 \uc2ac\ub86f \uc2dc\uc791\n    uint256 public b = 2;\n    // slot 2: c (16 bytes) - \uc0c8 \uc2ac\ub86f \uc2dc\uc791\n    uint128 public c = 3;\n    // \ucd1d 3\uac1c \uc2ac\ub86f \uc0ac\uc6a9\n}\n"))),(0,l.yg)(o.A,{value:"\ud6a8\uc728\uc801",mdxType:"TabItem"},(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sol"},"contract StoragePackingOptimized {\n    // slot 0: a (16 bytes) + c (16 bytes) = 32 bytes \ud328\ud0b9\n    uint128 public a = 1;\n    uint128 public c = 3;\n    // slot 1: b (32 bytes)\n    uint256 public b = 2;\n    // \ucd1d 2\uac1c \uc2ac\ub86f \uc0ac\uc6a9\n}\n")))),(0,l.yg)("p",null,(0,l.yg)("inlineCode",{parentName:"p"},"uint128"),", ",(0,l.yg)("inlineCode",{parentName:"p"},"uint256"),", ",(0,l.yg)("inlineCode",{parentName:"p"},"uint128")," \uc21c\uc11c\ub85c \uc120\uc5b8\ud558\uba74 3\uac1c\uc758 \uc2ac\ub86f\uc744 \uc0ac\uc6a9\ud558\uc9c0\ub9cc, ",(0,l.yg)("inlineCode",{parentName:"p"},"uint128"),", ",(0,l.yg)("inlineCode",{parentName:"p"},"uint128"),", ",(0,l.yg)("inlineCode",{parentName:"p"},"uint256")," \uc21c\uc11c\ub85c \ubcc0\uacbd\ud558\uba74 2\uac1c\uc758 \uc2ac\ub86f\ub9cc \uc0ac\uc6a9\ud55c\ub2e4. \uccab \ubc88\uc9f8 \uacbd\uc6b0 ",(0,l.yg)("inlineCode",{parentName:"p"},"b"),"(32\ubc14\uc774\ud2b8)\uac00 ",(0,l.yg)("inlineCode",{parentName:"p"},"a"),"(16\ubc14\uc774\ud2b8) \ub2e4\uc74c\uc5d0 \uc624\uba74\uc11c \ub0a8\uc740 16\ubc14\uc774\ud2b8\uc5d0 \ub4e4\uc5b4\uac00\uc9c0 \ubabb\ud574 \uc0c8 \uc2ac\ub86f\uc73c\ub85c \ub118\uc5b4\uac00\uace0, ",(0,l.yg)("inlineCode",{parentName:"p"},"c"),"\ub3c4 \ub9c8\ucc2c\uac00\uc9c0\ub85c \uc0c8 \uc2ac\ub86f\uc774 \ud544\uc694\ud558\ub2e4."),(0,l.yg)("h3",{id:"\uc5ec\ub7ec-\uc791\uc740-\ud0c0\uc785\uc758-\ud328\ud0b9"},"\uc5ec\ub7ec \uc791\uc740 \ud0c0\uc785\uc758 \ud328\ud0b9"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sol",metastring:'title="contracts/storage-layout/StoragePacking.sol"',title:'"contracts/storage-layout/StoragePacking.sol"'},"contract MultiPacking {\n    // slot 0: flag1(1) + flag2(1) + num(1) + addr(20) = 23 bytes \ud328\ud0b9\n    bool public flag1 = true;       // 1 byte\n    bool public flag2 = false;      // 1 byte\n    uint8 public num = 255;         // 1 byte\n    address public addr = 0x1234567890123456789012345678901234567890; // 20 bytes\n\n    // slot 1: value (32 bytes) - \uc0c8 \uc2ac\ub86f \uc2dc\uc791\n    uint256 public value = 100;\n}\n")),(0,l.yg)("p",null,(0,l.yg)("inlineCode",{parentName:"p"},"bool"),"(1\ubc14\uc774\ud2b8), ",(0,l.yg)("inlineCode",{parentName:"p"},"uint8"),"(1\ubc14\uc774\ud2b8), ",(0,l.yg)("inlineCode",{parentName:"p"},"address"),"(20\ubc14\uc774\ud2b8)\uac00 \uc5f0\uc18d\uc73c\ub85c \uc120\uc5b8\ub418\uba74 \ucd1d 23\ubc14\uc774\ud2b8\ub85c \ud558\ub098\uc758 \uc2ac\ub86f\uc5d0 \ud328\ud0b9\ub41c\ub2e4. \ub2e4\uc74c\uc5d0 \uc624\ub294 ",(0,l.yg)("inlineCode",{parentName:"p"},"uint256"),"\uc740 32\ubc14\uc774\ud2b8 \uc804\uccb4\uac00 \ud544\uc694\ud558\ubbc0\ub85c \uc0c8 \uc2ac\ub86f\uc5d0\uc11c \uc2dc\uc791\ud55c\ub2e4."),(0,l.yg)("h2",{id:"\ub3d9\uc801-\ud0c0\uc785\uc758-\uc800\uc7a5-\ubc29\uc2dd"},"\ub3d9\uc801 \ud0c0\uc785\uc758 \uc800\uc7a5 \ubc29\uc2dd"),(0,l.yg)("p",null,"\uace0\uc815 \ud06c\uae30 \ud0c0\uc785\uacfc \ub2ec\ub9ac ",(0,l.yg)("strong",{parentName:"p"},"\ub9e4\ud551(mapping)"),"\uacfc ",(0,l.yg)("strong",{parentName:"p"},"\ub3d9\uc801 \ubc30\uc5f4(dynamic array)"),"\uc740 \ud06c\uae30\ub97c \ubbf8\ub9ac \uc54c \uc218 \uc5c6\ub2e4. Solidity\ub294 \uc774\ub4e4\uc758 \uc2e4\uc81c \ub370\uc774\ud130\ub97c ",(0,l.yg)("inlineCode",{parentName:"p"},"keccak256")," \ud574\uc2dc \uae30\ubc18\uc758 \uc704\uce58\uc5d0 \ubd84\uc0b0 \uc800\uc7a5\ud55c\ub2e4."),(0,l.yg)("h3",{id:"mapping"},"Mapping"),(0,l.yg)("p",null,"\ub9e4\ud551\uc740 \uc120\uc5b8\ub41c \uc704\uce58\uc758 \uc2ac\ub86f \uc790\uccb4\uc5d0\ub294 \uc544\ubb34\uac83\ub3c4 \uc800\uc7a5\ud558\uc9c0 \uc54a\ub294\ub2e4. \ub300\uc2e0 \uac01 \ud0a4\uc5d0 \ud574\ub2f9\ud558\ub294 \uac12\uc740 \ub2e4\uc74c \uacf5\uc2dd\uc73c\ub85c \uacc4\uc0b0\ub41c \uc2ac\ub86f\uc5d0 \uc800\uc7a5\ub41c\ub2e4."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"slot = keccak256(key . p)\n")),(0,l.yg)("p",null,"\uc5ec\uae30\uc11c ",(0,l.yg)("inlineCode",{parentName:"p"},"."),"\ub294 \uc5f0\uacb0(concatenation)\uc744 \uc758\ubbf8\ud558\uace0, ",(0,l.yg)("inlineCode",{parentName:"p"},"p"),"\ub294 \ub9e4\ud551\uc774 \uc120\uc5b8\ub41c \uc2ac\ub86f \ubc88\ud638\uc774\ub2e4."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sol",metastring:'title="contracts/storage-layout/MappingStorage.sol"',title:'"contracts/storage-layout/MappingStorage.sol"'},"contract MappingStorage {\n    // slot 0\n    uint256 public baseValue = 100;\n\n    // slot 1 (\uc2ac\ub86f \uc790\uccb4\ub294 \ube44\uc5b4\uc788\uc74c)\n    mapping(address => uint256) public balances;\n\n    constructor() {\n        balances[0x1234567890123456789012345678901234567890] = 1000;\n    }\n\n    function computeMappingSlot(address key, uint256 slot) external pure returns (bytes32) {\n        return keccak256(abi.encode(key, slot));\n    }\n}\n")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-ts",metastring:'title="test/storage-layout/StorageLayout.test.ts"',title:'"test/storage-layout/StorageLayout.test.ts"'},'it("Mapping value location is computed as keccak256(key, slot)", async function () {\n  const MappingStorage = await ethers.getContractFactory("MappingStorage");\n  const contract = await MappingStorage.deploy();\n\n  const key = "0x1234567890123456789012345678901234567890";\n  const mappingSlot = 1n; // balances is at slot 1\n\n  // Calculate expected slot\n  const abiCoder = new AbiCoder();\n  const encoded = abiCoder.encode(["address", "uint256"], [key, mappingSlot]);\n  const expectedSlot = keccak256(encoded);\n\n  // Compute via contract function\n  const computedSlot = await contract.computeMappingSlot(key, mappingSlot);\n  expect(computedSlot).to.equal(expectedSlot);\n\n  // Verify actual value\n  const value = await contract.getSlot(computedSlot);\n  expect(BigInt(value)).to.equal(1000n);\n});\n')),(0,l.yg)("h4",{id:"\uc911\ucca9-\ub9e4\ud551"},"\uc911\ucca9 \ub9e4\ud551"),(0,l.yg)("p",null,"\uc911\ucca9 \ub9e4\ud551\uc758 \uacbd\uc6b0 \ud574\uc2dc\ub97c \uc7ac\uadc0\uc801\uc73c\ub85c \uc801\uc6a9\ud55c\ub2e4."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sol"},"mapping(uint256 => mapping(address => uint256)) public nestedMap;\n// nestedMap[key1][key2]\uc758 \uc704\uce58:\n// 1. intermediateSlot = keccak256(key1 . baseSlot)\n// 2. finalSlot = keccak256(key2 . intermediateSlot)\n")),(0,l.yg)("h3",{id:"dynamic-array"},"Dynamic Array"),(0,l.yg)("p",null,"\ub3d9\uc801 \ubc30\uc5f4\uc740 \uc120\uc5b8\ub41c \uc2ac\ub86f\uc5d0 ",(0,l.yg)("strong",{parentName:"p"},"\ubc30\uc5f4\uc758 \uae38\uc774"),"\ub97c \uc800\uc7a5\ud558\uace0, \uc2e4\uc81c \uc694\uc18c\ub4e4\uc740 \ub2e4\uc74c \uacf5\uc2dd\uc73c\ub85c \uacc4\uc0b0\ub41c \uc704\uce58\ubd80\ud130 \uc21c\ucc28\uc801\uc73c\ub85c \uc800\uc7a5\ub41c\ub2e4."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"elementSlot = keccak256(p) + index\n")),(0,l.yg)("p",null,"\uc5ec\uae30\uc11c ",(0,l.yg)("inlineCode",{parentName:"p"},"p"),"\ub294 \ubc30\uc5f4\uc774 \uc120\uc5b8\ub41c \uc2ac\ub86f \ubc88\ud638\uc774\ub2e4."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sol",metastring:'title="contracts/storage-layout/DynamicArrayStorage.sol"',title:'"contracts/storage-layout/DynamicArrayStorage.sol"'},"contract DynamicArrayStorage {\n    // slot 0\n    uint256 public baseValue = 100;\n\n    // slot 1: \ubc30\uc5f4 \uae38\uc774 \uc800\uc7a5, \uc2e4\uc81c \ub370\uc774\ud130\ub294 keccak256(1)\ubd80\ud130\n    uint256[] public numbers;\n\n    constructor() {\n        numbers.push(111);\n        numbers.push(222);\n        numbers.push(333);\n    }\n\n    function computeArrayElementSlot(uint256 slot, uint256 index) external pure returns (bytes32) {\n        return bytes32(uint256(keccak256(abi.encode(slot))) + index);\n    }\n}\n")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-ts",metastring:'title="test/storage-layout/StorageLayout.test.ts"',title:'"test/storage-layout/StorageLayout.test.ts"'},'it("Array elements are stored at keccak256(slot) + index", async function () {\n  const DynamicArrayStorage = await ethers.getContractFactory("DynamicArrayStorage");\n  const contract = await DynamicArrayStorage.deploy();\n\n  // Calculate numbers[0] location\n  const element0Slot = await contract.computeArrayElementSlot(1, 0);\n  const value0 = await contract.getSlot(element0Slot);\n  expect(BigInt(value0)).to.equal(111n);\n\n  // Calculate numbers[1] location\n  const element1Slot = await contract.computeArrayElementSlot(1, 1);\n  const value1 = await contract.getSlot(element1Slot);\n  expect(BigInt(value1)).to.equal(222n);\n\n  // Calculate numbers[2] location\n  const element2Slot = await contract.computeArrayElementSlot(1, 2);\n  const value2 = await contract.getSlot(element2Slot);\n  expect(BigInt(value2)).to.equal(333n);\n});\n')),(0,l.yg)("h2",{id:"bytes\uc640-strings"},"Bytes\uc640 Strings"),(0,l.yg)("p",null,(0,l.yg)("inlineCode",{parentName:"p"},"bytes"),"\uc640 ",(0,l.yg)("inlineCode",{parentName:"p"},"string")," \ud0c0\uc785\uc740 \uc800\uc7a5 \ubc29\uc2dd\uc774 \ub370\uc774\ud130 \uae38\uc774\uc5d0 \ub530\ub77c \ub2ec\ub77c\uc9c4\ub2e4."),(0,l.yg)("h3",{id:"\uc9e7\uc740-\ub370\uc774\ud130-31\ubc14\uc774\ud2b8-\uc774\ud558"},"\uc9e7\uc740 \ub370\uc774\ud130 (31\ubc14\uc774\ud2b8 \uc774\ud558)"),(0,l.yg)("p",null,"\ub370\uc774\ud130\uc640 \uae38\uc774 \uc815\ubcf4\uac00 ",(0,l.yg)("strong",{parentName:"p"},"\uac19\uc740 \uc2ac\ub86f"),"\uc5d0 \uc800\uc7a5\ub41c\ub2e4:"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},"\ub370\uc774\ud130: \uc2ac\ub86f\uc758 \uc0c1\uc704 \ubc14\uc774\ud2b8\ub4e4"),(0,l.yg)("li",{parentName:"ul"},"\uae38\uc774 \uc815\ubcf4: \ucd5c\ud558\uc704 \ubc14\uc774\ud2b8\uc5d0 ",(0,l.yg)("inlineCode",{parentName:"li"},"length * 2")," \uac12 \uc800\uc7a5")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 [data: 31 bytes max]                  \u2502 [length*2: 1 byte] \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n")),(0,l.yg)("h3",{id:"\uae34-\ub370\uc774\ud130-32\ubc14\uc774\ud2b8-\uc774\uc0c1"},"\uae34 \ub370\uc774\ud130 (32\ubc14\uc774\ud2b8 \uc774\uc0c1)"),(0,l.yg)("p",null,"\uc2ac\ub86f\uc5d0\ub294 ",(0,l.yg)("inlineCode",{parentName:"p"},"length * 2 + 1")," \uac12\ub9cc \uc800\uc7a5\ub418\uace0, \uc2e4\uc81c \ub370\uc774\ud130\ub294 ",(0,l.yg)("inlineCode",{parentName:"p"},"keccak256(slot)")," \uc704\uce58\ubd80\ud130 \uc800\uc7a5\ub41c\ub2e4. \ucd5c\ud558\uc704 \ube44\ud2b8\uac00 1\uc774\uba74 \uae34 \ub370\uc774\ud130\uc784\uc744 \ub098\ud0c0\ub0b8\ub2e4."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sol",metastring:'title="contracts/storage-layout/BytesStringStorage.sol"',title:'"contracts/storage-layout/BytesStringStorage.sol"'},'contract BytesStringStorage {\n    // slot 0: \uc9e7\uc740 \ubb38\uc790\uc5f4 - \ub370\uc774\ud130\uc640 \uae38\uc774\uac00 \uac19\uc740 \uc2ac\ub86f\uc5d0\n    string public shortString = "hello";  // 5 bytes\n\n    // slot 1: \uae34 \ubb38\uc790\uc5f4 - \uc2ac\ub86f\uc5d0\ub294 \uae38\uc774*2+1, \ub370\uc774\ud130\ub294 keccak256(1)\ubd80\ud130\n    string public longString = "This is a very long string that exceeds 31 bytes in length";\n\n    function isShortData(bytes32 slotValue) external pure returns (bool) {\n        // \ucd5c\ud558\uc704 \ube44\ud2b8\uac00 0\uc774\uba74 \uc9e7\uc740 \ub370\uc774\ud130\n        return uint256(slotValue) & 1 == 0;\n    }\n\n    function getShortDataLength(bytes32 slotValue) external pure returns (uint256) {\n        // \ucd5c\ud558\uc704 \ubc14\uc774\ud2b8 / 2 = \uc2e4\uc81c \uae38\uc774\n        return (uint256(slotValue) & 0xFF) / 2;\n    }\n}\n')),(0,l.yg)("h2",{id:"structs\uc640-\uc0c1\uc18d"},"Structs\uc640 \uc0c1\uc18d"),(0,l.yg)("h3",{id:"struct-\uc800\uc7a5"},"Struct \uc800\uc7a5"),(0,l.yg)("p",null,"Struct\ub294 \ud56d\uc0c1 ",(0,l.yg)("strong",{parentName:"p"},"\uc0c8 \uc2ac\ub86f"),"\uc5d0\uc11c \uc2dc\uc791\ud558\uba70, \ub0b4\ubd80 \uba64\ubc84\ub4e4\uc740 \uc77c\ubc18 \ubcc0\uc218\uc640 \ub3d9\uc77c\ud55c \ud328\ud0b9 \uaddc\uce59\uc744 \ub530\ub978\ub2e4."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sol",metastring:'title="contracts/storage-layout/StructStorage.sol"',title:'"contracts/storage-layout/StructStorage.sol"'},"contract StructStorage {\n    struct User {\n        uint128 balance;    // 16 bytes\n        uint64 lastUpdate;  // 8 bytes\n        bool isActive;      // 1 byte\n        // \uc704 3\uac1c\uac00 \ud558\ub098\uc758 \uc2ac\ub86f\uc5d0 \ud328\ud0b9 (25 bytes)\n        address wallet;     // 20 bytes -> \ub2e4\uc74c \uc2ac\ub86f\n        uint256 totalTx;    // 32 bytes -> \ub2e4\uc74c \uc2ac\ub86f\n    }\n\n    // slot 0, 1, 2: user1 \uad6c\uc870\uccb4 (3\uac1c \uc2ac\ub86f)\n    User public user1;\n\n    // slot 3, 4, 5: user2 \uad6c\uc870\uccb4 (3\uac1c \uc2ac\ub86f)\n    User public user2;\n}\n")),(0,l.yg)("p",null,(0,l.yg)("inlineCode",{parentName:"p"},"User")," \uad6c\uc870\uccb4\ub294 3\uac1c\uc758 \uc2ac\ub86f\uc744 \uc0ac\uc6a9\ud55c\ub2e4:"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},"\uc2ac\ub86f 0: ",(0,l.yg)("inlineCode",{parentName:"li"},"balance"),"(16) + ",(0,l.yg)("inlineCode",{parentName:"li"},"lastUpdate"),"(8) + ",(0,l.yg)("inlineCode",{parentName:"li"},"isActive"),"(1) = 25\ubc14\uc774\ud2b8 \ud328\ud0b9"),(0,l.yg)("li",{parentName:"ul"},"\uc2ac\ub86f 1: ",(0,l.yg)("inlineCode",{parentName:"li"},"wallet"),"(20\ubc14\uc774\ud2b8)"),(0,l.yg)("li",{parentName:"ul"},"\uc2ac\ub86f 2: ",(0,l.yg)("inlineCode",{parentName:"li"},"totalTx"),"(32\ubc14\uc774\ud2b8)")),(0,l.yg)("h3",{id:"\uc0c1\uc18d\uacfc-c3-linearization"},"\uc0c1\uc18d\uacfc C3 Linearization"),(0,l.yg)("p",null,"\uc0c1\uc18d \uad00\uacc4\uc5d0\uc11c \uc2a4\ud1a0\ub9ac\uc9c0 \ub808\uc774\uc544\uc6c3\uc740 ",(0,l.yg)("strong",{parentName:"p"},"C3 linearization")," \uaddc\uce59\uc744 \ub530\ub978\ub2e4. \uac00\uc7a5 \uae30\ubcf8(base) \ucee8\ud2b8\ub799\ud2b8\uc758 \ubcc0\uc218\ubd80\ud130 \uc2ac\ub86f\uc774 \ud560\ub2f9\ub41c\ub2e4."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sol",metastring:'title="contracts/storage-layout/InheritanceStorage.sol"',title:'"contracts/storage-layout/InheritanceStorage.sol"'},"contract Base {\n    // slot 0\n    uint256 public baseValue = 100;\n    // slot 1\n    address public baseOwner;\n}\n\ncontract Middle is Base {\n    // slot 2 (Base\uc758 \uc2ac\ub86f \uc774\ud6c4)\n    uint256 public middleValue = 200;\n}\n\ncontract Child is Middle {\n    // slot 3 (Middle\uc758 \uc2ac\ub86f \uc774\ud6c4)\n    uint256 public childValue = 300;\n}\n")),(0,l.yg)("p",null,"\ub2e4\uc911 \uc0c1\uc18d\uc758 \uacbd\uc6b0:"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sol"},"contract A {\n    uint256 public aValue = 1;  // slot 0\n}\n\ncontract B {\n    uint256 public bValue = 2;  // slot 0 (\ub3c5\ub9bd\uc801)\n}\n\n// C3 linearization: MultipleInheritance -> B -> A\n// \uc2e4\uc81c \ub808\uc774\uc544\uc6c3: A.aValue(slot 0) -> B.bValue(slot 1) -> cValue(slot 2)\ncontract MultipleInheritance is A, B {\n    uint256 public cValue = 3;  // slot 2\n}\n")),(0,l.yg)("p",null,"\uc0c1\uc18d \uc21c\uc11c\uac00 ",(0,l.yg)("inlineCode",{parentName:"p"},"is A, B"),"\uc774\uba74 linearization \uacb0\uacfc A\uac00 \uba3c\uc800, B\uac00 \uadf8 \ub2e4\uc74c\uc774\ubbc0\ub85c ",(0,l.yg)("inlineCode",{parentName:"p"},"aValue"),"\uac00 \uc2ac\ub86f 0, ",(0,l.yg)("inlineCode",{parentName:"p"},"bValue"),"\uac00 \uc2ac\ub86f 1\uc5d0 \ubc30\uce58\ub41c\ub2e4."),(0,l.yg)("h2",{id:"assembly\ub85c-\uc2a4\ud1a0\ub9ac\uc9c0-\uc811\uadfc"},"Assembly\ub85c \uc2a4\ud1a0\ub9ac\uc9c0 \uc811\uadfc"),(0,l.yg)("p",null,"Solidity\uc758 \uc778\ub77c\uc778 \uc5b4\uc148\ube14\ub9ac\ub97c \uc0ac\uc6a9\ud558\uba74 \uc2a4\ud1a0\ub9ac\uc9c0\ub97c \uc9c1\uc811 \uc77d\uace0 \uc4f8 \uc218 \uc788\ub2e4. \uc774\ub97c \ud1b5\ud574 ",(0,l.yg)("inlineCode",{parentName:"p"},"private")," \ubcc0\uc218\uc5d0\ub3c4 \uc811\uadfc\ud560 \uc218 \uc788\uc73c\uba70, \ud328\ud0b9\ub41c \uc2ac\ub86f\uc758 \ud2b9\uc815 \ubd80\ubd84\ub9cc \uc870\uc791\ud560 \uc218\ub3c4 \uc788\ub2e4."),(0,l.yg)("h3",{id:"sload\uc640-sstore"},"sload\uc640 sstore"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sol",metastring:'title="contracts/storage-layout/AssemblyAccess.sol"',title:'"contracts/storage-layout/AssemblyAccess.sol"'},"contract AssemblyAccess {\n    // slot 0: private\uc5ec\ub3c4 \uc628\uccb4\uc778\uc5d0 \uc800\uc7a5\ub428\n    uint256 private secretNumber = 12345;\n\n    // slot 1: \ud328\ud0b9\ub41c \ubcc0\uc218\ub4e4\n    uint128 private value1 = 100;  // lower 128 bits\n    uint128 private value2 = 200;  // upper 128 bits\n\n    function readSlot(uint256 slot) external view returns (bytes32) {\n        bytes32 value;\n        assembly {\n            value := sload(slot)\n        }\n        return value;\n    }\n\n    function writeSlot(uint256 slot, bytes32 value) external {\n        assembly {\n            sstore(slot, value)\n        }\n    }\n}\n")),(0,l.yg)("p",null,(0,l.yg)("inlineCode",{parentName:"p"},"private")," \ud0a4\uc6cc\ub4dc\ub294 Solidity \ub808\ubca8\uc5d0\uc11c\uc758 \uc811\uadfc \uc81c\uc5b4\uc77c \ubfd0, \uc628\uccb4\uc778 \ub370\uc774\ud130\ub294 \ub204\uad6c\ub098 \uc77d\uc744 \uc218 \uc788\ub2e4."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-ts"},'it("Private variables can be read through slots", async function () {\n  const AssemblyAccess = await ethers.getContractFactory("AssemblyAccess");\n  const contract = await AssemblyAccess.deploy();\n\n  // slot 0: secretNumber\n  const slot0 = await contract.readSlot(0);\n  expect(BigInt(slot0)).to.equal(12345n);\n});\n')),(0,l.yg)("h3",{id:"\ud328\ud0b9\ub41c-\uc2ac\ub86f\uc758-\uac1c\ubcc4-\uac12-\uc811\uadfc"},"\ud328\ud0b9\ub41c \uc2ac\ub86f\uc758 \uac1c\ubcc4 \uac12 \uc811\uadfc"),(0,l.yg)("p",null,"\ud328\ud0b9\ub41c \uc2ac\ub86f\uc5d0\uc11c \ud2b9\uc815 \uac12\ub9cc \uc77d\uac70\ub098 \uc4f0\ub824\uba74 \ube44\ud2b8 \ub9c8\uc2a4\ud0b9\uacfc \uc2dc\ud504\ud2b8 \uc5f0\uc0b0\uc774 \ud544\uc694\ud558\ub2e4."),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-sol",metastring:'title="contracts/storage-layout/AssemblyAccess.sol"',title:'"contracts/storage-layout/AssemblyAccess.sol"'},"// value1 \uc77d\uae30 (lower 128 bits)\nfunction readPackedValue1() external view returns (uint128) {\n    uint128 result;\n    assembly {\n        let slotValue := sload(1)\n        // lower 128 bits \ub9c8\uc2a4\ud0b9\n        result := and(slotValue, 0xffffffffffffffffffffffffffffffff)\n    }\n    return result;\n}\n\n// value2 \uc77d\uae30 (upper 128 bits)\nfunction readPackedValue2() external view returns (uint128) {\n    uint128 result;\n    assembly {\n        let slotValue := sload(1)\n        // 128\ube44\ud2b8 \uc624\ub978\ucabd \uc2dc\ud504\ud2b8\n        result := shr(128, slotValue)\n    }\n    return result;\n}\n\n// value1\ub9cc \uc218\uc815 (value2 \uc720\uc9c0)\nfunction writePackedValue1(uint128 newValue) external {\n    assembly {\n        let slotValue := sload(1)\n        // upper 128 bits \uc720\uc9c0, lower 128 bits \ud074\ub9ac\uc5b4\n        let cleared := and(slotValue, not(0xffffffffffffffffffffffffffffffff))\n        // \uc0c8 \uac12 \uc124\uc815\n        sstore(1, or(cleared, newValue))\n    }\n}\n")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre",className:"language-ts"},'it("Modifying individual values in packed slot", async function () {\n  const AssemblyAccess = await ethers.getContractFactory("AssemblyAccess");\n  const contract = await AssemblyAccess.deploy();\n\n  // Change only value1\n  await contract.writePackedValue1(999);\n\n  // value1 is changed\n  expect(await contract.getValue1()).to.equal(999n);\n  // value2 is unchanged\n  expect(await contract.getValue2()).to.equal(200n);\n});\n')),(0,l.yg)("h2",{id:"\uc815\ub9ac"},"\uc815\ub9ac"),(0,l.yg)("ol",null,(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("strong",{parentName:"li"},"\uc21c\ucc28\uc801 \ud560\ub2f9"),": \ubcc0\uc218\ub294 \uc120\uc5b8 \uc21c\uc11c\ub300\ub85c \uc2ac\ub86f 0\ubd80\ud130 \ud560\ub2f9\ub41c\ub2e4."),(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("strong",{parentName:"li"},"Lower-order aligned"),": \uac12\uc740 \uc2ac\ub86f\uc758 \uc624\ub978\ucabd(\ub0ae\uc740 \ubc14\uc774\ud2b8)\ubd80\ud130 \ucc44\uc6cc\uc9c4\ub2e4."),(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("strong",{parentName:"li"},"\ud328\ud0b9"),": 32\ubc14\uc774\ud2b8 \ubbf8\ub9cc \ubcc0\uc218\ub4e4\uc740 \uac00\ub2a5\ud55c \ud55c \uac19\uc740 \uc2ac\ub86f\uc5d0 \ubb36\uc778\ub2e4."),(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("strong",{parentName:"li"},"\ub3d9\uc801 \ud0c0\uc785"),": \ub9e4\ud551\uacfc \ub3d9\uc801 \ubc30\uc5f4\uc740 keccak256 \uae30\ubc18\uc73c\ub85c \ubd84\uc0b0 \uc800\uc7a5\ub41c\ub2e4."),(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("strong",{parentName:"li"},"\uc0c1\uc18d"),": C3 linearization\uc5d0 \ub530\ub77c \ubd80\ubaa8 \ucee8\ud2b8\ub799\ud2b8\ubd80\ud130 \uc2ac\ub86f\uc774 \ud560\ub2f9\ub41c\ub2e4.")),(0,l.yg)("h3",{id:"\ud504\ub85d\uc2dc-\ud328\ud134\uacfc\uc758-\uc5f0\uad00\uc131"},"\ud504\ub85d\uc2dc \ud328\ud134\uacfc\uc758 \uc5f0\uad00\uc131"),(0,l.yg)("p",null,(0,l.yg)("a",{parentName:"p",href:"/blockchain/upgradeable-contract/delegate-call"},"\uc774\uc804 \uae00"),"\uc5d0\uc11c \ub2e4\ub918\ub4ef\uc774 delegatecall\uc744 \uc0ac\uc6a9\ud558\ub294 \ud504\ub85d\uc2dc \ud328\ud134\uc5d0\uc11c\ub294 \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8\uc640 \ud504\ub85d\uc2dc \ucee8\ud2b8\ub799\ud2b8\uc758 \uc2a4\ud1a0\ub9ac\uc9c0 \ub808\uc774\uc544\uc6c3\uc774 \ubc18\ub4dc\uc2dc \uc77c\uce58\ud574\uc57c \ud55c\ub2e4. \uadf8\ub807\uc9c0 \uc54a\uc73c\uba74 \uc798\ubabb\ub41c \uc2ac\ub86f\uc5d0 \uac12\uc774 \uc800\uc7a5\ub418\uc5b4 \ub370\uc774\ud130 \uc190\uc0c1\uc774 \ubc1c\uc0dd\ud558\uc5ec \uad6c\ud604 \ucee8\ud2b8\ub799\ud2b8 \uc8fc\uc18c\uc640 \uac19\uc740 \uc911\uc694\ud55c \uac12\uc774 \ub36e\uc5b4\uc50c\uc6cc\uc9c8 \uc704\ud5d8\uc774 \uc788\ub2e4."),(0,l.yg)("p",null,"\uc774\ub7ec\ud55c \ubb38\uc81c\ub97c \ubc29\uc9c0\ud558\uae30 \uc704\ud574 ERC-1967\uc740 \ucda9\ub3cc \uac00\ub2a5\uc131\uc774 \uadf9\ud788 \ub0ae\uc740 \ud2b9\uc815 \uc2ac\ub86f(\uc608: ",(0,l.yg)("inlineCode",{parentName:"p"},'keccak256("eip1967.proxy.implementation") - 1'),")\uc5d0 \ud504\ub85d\uc2dc \uad00\ub828 \ub370\uc774\ud130\ub97c \uc800\uc7a5\ud558\ub3c4\ub85d \ud45c\uc900\ud654\ud588\ub2e4."),(0,l.yg)("h3",{id:"\uac00\uc2a4-\ucd5c\uc801\ud654-\ud301"},"\uac00\uc2a4 \ucd5c\uc801\ud654 \ud301"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},"\uac19\uc740 \uc2ac\ub86f\uc5d0 \ud328\ud0b9\ub420 \uc218 \uc788\ub3c4\ub85d \uc791\uc740 \ud0c0\uc785 \ubcc0\uc218\ub4e4\uc744 \uc5f0\uc18d\uc73c\ub85c \uc120\uc5b8\ud55c\ub2e4."),(0,l.yg)("li",{parentName:"ul"},"\uc790\uc8fc \ud568\uaed8 \uc77d\ud788\ub294 \ubcc0\uc218\ub4e4\uc744 \uac19\uc740 \uc2ac\ub86f\uc5d0 \ubc30\uce58\ud55c\ub2e4."),(0,l.yg)("li",{parentName:"ul"},"\ubd88\ud544\uc694\ud55c \uc2a4\ud1a0\ub9ac\uc9c0 \uc4f0\uae30\ub97c \uc904\uc778\ub2e4 (memory \ubcc0\uc218 \ud65c\uc6a9).")),(0,l.yg)("p",null,"\uae00\uc5d0\uc11c \uc0ac\uc6a9\ub41c \uc608\uc2dc\ucf54\ub4dc\ub294 ",(0,l.yg)("a",{parentName:"p",href:"https://github.com/chihunmanse/crypto-examples/tree/main/solidity-examples"},"crypto-examples/solidity-examples"),"\uc5d0\uc11c \ud655\uc778\ud560 \uc218 \uc788\ub2e4."),(0,l.yg)("h2",{id:"\ucc38\uc870"},"\ucc38\uc870"),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("a",{parentName:"li",href:"https://docs.soliditylang.org/en/latest/internals/layout_in_storage.html"},"Solidity Docs - Layout of State Variables in Storage")),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("a",{parentName:"li",href:"https://rareskills.io/post/evm-solidity-storage-layout"},"RareSkills - Storage Slots in Solidity"))))}y.isMDXComponent=!0},5680(e,t,n){n.d(t,{xA:()=>c,yg:()=>y});var a=n(6540);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach(function(t){l(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function i(e,t){if(null==e)return{};var n,a,l=function(e,t){if(null==e)return{};var n,a,l={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},g={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef(function(e,t){var n=e.components,l=e.mdxType,r=e.originalType,s=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),p=u(n),y=l,d=p["".concat(s,".").concat(y)]||p[y]||g[y]||r;return n?a.createElement(d,o(o({ref:t},c),{},{components:n})):a.createElement(d,o({ref:t},c))});function y(e,t){var n=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var r=n.length,o=new Array(r);o[0]=p;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:l,o[1]=i;for(var u=2;u<r;u++)o[u]=n[u];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},9365(e,t,n){n.d(t,{A:()=>o});var a=n(6540),l=n(53);const r="tabItem_Ymn6";function o({children:e,hidden:t,className:n}){return a.createElement("div",{role:"tabpanel",className:(0,l.A)(r,n),hidden:t},e)}}}]);