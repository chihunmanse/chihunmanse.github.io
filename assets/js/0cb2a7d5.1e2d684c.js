"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8885],{5680:(e,n,t)=>{t.d(n,{xA:()=>c,yg:()=>y});var a=t(6540);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function p(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var i=a.createContext({}),s=function(e){var n=a.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},c=function(e){var n=s(e.components);return a.createElement(i.Provider,{value:n},e.children)},g="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},u=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,l=e.originalType,i=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),g=s(t),u=r,y=g["".concat(i,".").concat(u)]||g[u]||m[u]||l;return t?a.createElement(y,o(o({ref:n},c),{},{components:t})):a.createElement(y,o({ref:n},c))}));function y(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var l=t.length,o=new Array(l);o[0]=u;var p={};for(var i in n)hasOwnProperty.call(n,i)&&(p[i]=n[i]);p.originalType=e,p[g]="string"==typeof e?e:r,o[1]=p;for(var s=2;s<l;s++)o[s]=t[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}u.displayName="MDXCreateElement"},3276:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>o,default:()=>m,frontMatter:()=>l,metadata:()=>p,toc:()=>s});var a=t(8168),r=(t(6540),t(5680));const l={title:"Request LifeCycle",description:"NestJS\uc758 \uc694\uccad \uc218\uba85 \uc8fc\uae30\uc5d0 \ub300\ud574",tags:["BackEnd","NestJS","Middleware","Guard","Interceptor","Pipe","ExceptionFilter"],sidebar_position:2},o="Request LifeCycle",p={unversionedId:"backend/nest.js/request-lifecycle",id:"backend/nest.js/request-lifecycle",title:"Request LifeCycle",description:"NestJS\uc758 \uc694\uccad \uc218\uba85 \uc8fc\uae30\uc5d0 \ub300\ud574",source:"@site/docs/02-backend/04-nest.js/02-request-lifecycle.md",sourceDirName:"02-backend/04-nest.js",slug:"/backend/nest.js/request-lifecycle",permalink:"/backend/nest.js/request-lifecycle",draft:!1,tags:[{label:"BackEnd",permalink:"/tags/back-end"},{label:"NestJS",permalink:"/tags/nest-js"},{label:"Middleware",permalink:"/tags/middleware"},{label:"Guard",permalink:"/tags/guard"},{label:"Interceptor",permalink:"/tags/interceptor"},{label:"Pipe",permalink:"/tags/pipe"},{label:"ExceptionFilter",permalink:"/tags/exception-filter"}],version:"current",sidebarPosition:2,frontMatter:{title:"Request LifeCycle",description:"NestJS\uc758 \uc694\uccad \uc218\uba85 \uc8fc\uae30\uc5d0 \ub300\ud574",tags:["BackEnd","NestJS","Middleware","Guard","Interceptor","Pipe","ExceptionFilter"],sidebar_position:2},sidebar:"docs",previous:{title:"IoC & NestJS DI",permalink:"/backend/nest.js/IoC&DI"},next:{title:"DevOps",permalink:"/devops/"}},i={},s=[{value:"1. \ubbf8\ub4e4\uc6e8\uc5b4 (Middleware)",id:"1-\ubbf8\ub4e4\uc6e8\uc5b4-middleware",level:2},{value:"\uad6c\ud604",id:"\uad6c\ud604",level:3},{value:"\ud074\ub798\uc2a4",id:"\ud074\ub798\uc2a4",level:4},{value:"\ud568\uc218",id:"\ud568\uc218",level:4},{value:"\uc801\uc6a9",id:"\uc801\uc6a9",level:3},{value:"\ubaa8\ub4c8",id:"\ubaa8\ub4c8",level:4},{value:"\uc804\uc5ed",id:"\uc804\uc5ed",level:4},{value:"2. \uac00\ub4dc (Guard)",id:"2-\uac00\ub4dc-guard",level:2},{value:"\uad6c\ud604",id:"\uad6c\ud604-1",level:3},{value:"\ud2b9\uc815 \ud578\ub4e4\ub7ec\uc5d0 Custom \uba54\ud0c0\ub370\uc774\ud130\ub97c \ucd94\uac00\ud558\uc5ec ExecutionContext \ud65c\uc6a9",id:"\ud2b9\uc815-\ud578\ub4e4\ub7ec\uc5d0-custom-\uba54\ud0c0\ub370\uc774\ud130\ub97c-\ucd94\uac00\ud558\uc5ec-executioncontext-\ud65c\uc6a9",level:4},{value:"\uc801\uc6a9",id:"\uc801\uc6a9-1",level:3},{value:"\ucee8\ud2b8\ub864\ub7ec",id:"\ucee8\ud2b8\ub864\ub7ec",level:4},{value:"\ud568\uc218",id:"\ud568\uc218-1",level:4},{value:"\uc804\uc5ed",id:"\uc804\uc5ed-1",level:4},{value:"3. \uc778\ud130\uc149\ud130 (Interceptor)",id:"3-\uc778\ud130\uc149\ud130-interceptor",level:2},{value:"\uad6c\ud604",id:"\uad6c\ud604-2",level:3},{value:"\uc751\ub2f5 \ub9e4\ud551\uc73c\ub85c \ud65c\uc6a9",id:"\uc751\ub2f5-\ub9e4\ud551\uc73c\ub85c-\ud65c\uc6a9",level:4},{value:"\uce90\uc2dc \uad6c\ud604\uc73c\ub85c \ud65c\uc6a9",id:"\uce90\uc2dc-\uad6c\ud604\uc73c\ub85c-\ud65c\uc6a9",level:4},{value:"\uc801\uc6a9",id:"\uc801\uc6a9-2",level:3},{value:"\ucee8\ud2b8\ub864\ub7ec",id:"\ucee8\ud2b8\ub864\ub7ec-1",level:4},{value:"\ud568\uc218",id:"\ud568\uc218-2",level:4},{value:"\uc804\uc5ed",id:"\uc804\uc5ed-2",level:4},{value:"4. \ud30c\uc774\ud504 (Pipe)",id:"4-\ud30c\uc774\ud504-pipe",level:2},{value:"\uad6c\ud604",id:"\uad6c\ud604-3",level:3},{value:"\ub0b4\uc7a5 \ud30c\uc774\ud504",id:"\ub0b4\uc7a5-\ud30c\uc774\ud504",level:4},{value:"\ucee4\uc2a4\ud140 \ud30c\uc774\ud504",id:"\ucee4\uc2a4\ud140-\ud30c\uc774\ud504",level:4},{value:"\uc801\uc6a9",id:"\uc801\uc6a9-3",level:3},{value:"\ub9e4\uac1c\ubcc0\uc218",id:"\ub9e4\uac1c\ubcc0\uc218",level:4},{value:"\uc804\uc5ed",id:"\uc804\uc5ed-3",level:4},{value:"\uc608\uc678 \ud544\ud130 (Exception Filter)",id:"\uc608\uc678-\ud544\ud130-exception-filter",level:2},{value:"\uad6c\ud604",id:"\uad6c\ud604-4",level:3},{value:"\uc801\uc6a9",id:"\uc801\uc6a9-4",level:3},{value:"\ud568\uc218",id:"\ud568\uc218-3",level:4},{value:"\ucee8\ud2b8\ub864\ub7ec",id:"\ucee8\ud2b8\ub864\ub7ec-2",level:4},{value:"\uc804\uc5ed",id:"\uc804\uc5ed-4",level:4},{value:"Summary",id:"summary",level:2}],c={toc:s},g="wrapper";function m(e){let{components:n,...t}=e;return(0,r.yg)(g,(0,a.A)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,r.yg)("h1",{id:"request-lifecycle"},"Request LifeCycle"),(0,r.yg)("h2",{id:"1-\ubbf8\ub4e4\uc6e8\uc5b4-middleware"},"1. \ubbf8\ub4e4\uc6e8\uc5b4 (Middleware)"),(0,r.yg)("p",null,"\ubbf8\ub4e4\uc6e8\uc5b4\ub294 \ub77c\uc6b0\ud130 \ud578\ub4e4\ub7ec \uc774\uc804\uc5d0 \ud638\ucd9c\ub418\ub294 \ud568\uc218\uc774\ub2e4. \uc694\uccad \ubc0f \uc751\ub2f5 \uac1d\uccb4\uc5d0 \uc811\uadfc\ud560 \uc218 \uc788\uc73c\uba70, \uc694\uccad-\uc751\ub2f5 \uc8fc\uae30\uc5d0 \uc788\ub294 \ub2e4\uc74c \ubbf8\ub4e4\uc6e8\uc5b4 \ud568\uc218\uc5d0\ub3c4 \uc811\uadfc\ud560 \uc218 \uc788\ub2e4."),(0,r.yg)("h3",{id:"\uad6c\ud604"},"\uad6c\ud604"),(0,r.yg)("h4",{id:"\ud074\ub798\uc2a4"},"\ud074\ub798\uc2a4"),(0,r.yg)("p",null,"\ud074\ub798\uc2a4\ub85c \uad6c\ud604\uc2dc ",(0,r.yg)("inlineCode",{parentName:"p"},"@Injectable()")," \ub370\ucf54\ub808\uc774\ud130\uc640 \ud568\uaed8 ",(0,r.yg)("inlineCode",{parentName:"p"},"NestMiddleware")," \uc778\ud130\ud398\uc774\uc2a4\ub97c \uad6c\ud604\ud574\uc57c \ud55c\ub2e4."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},'import { Injectable, NestMiddleware } from "@nestjs/common";\nimport { Request, Response, NextFunction } from "express";\n\n@Injectable()\nexport class LoggerMiddleware implements NestMiddleware {\n  use(req: Request, res: Response, next: NextFunction) {\n    console.log("Request...");\n    next(); // \ubc18\ub4dc\uc2dc next()\ub97c \ud638\ucd9c\ud558\uc5ec \ub2e4\uc74c \ubbf8\ub4e4\uc6e8\uc5b4\ub098 \ucee8\ud2b8\ub864\ub7ec\ub85c \ub118\uc5b4\uac00\ub3c4\ub85d \ud574\uc57c \ud568\n  }\n}\n')),(0,r.yg)("h4",{id:"\ud568\uc218"},"\ud568\uc218"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},'import { Request, Response, NextFunction } from "express";\n\nexport function logger(req: Request, res: Response, next: NextFunction) {\n  console.log(`Request...`);\n  next();\n}\n')),(0,r.yg)("h3",{id:"\uc801\uc6a9"},"\uc801\uc6a9"),(0,r.yg)("h4",{id:"\ubaa8\ub4c8"},"\ubaa8\ub4c8"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},'import { Module, MiddlewareConsumer } from "@nestjs/common";\nimport { LoggerMiddleware } from "./logger.middleware";\nimport { UsersController } from "./users.controller";\n\n@Module({\n  controllers: [UsersController],\n})\nexport class AppModule {\n  configure(consumer: MiddlewareConsumer) {\n    consumer\n      .apply(LoggerMiddleware) // \ubbf8\ub4e4\uc6e8\uc5b4 \uc801\uc6a9 - \ud568\uc218 \ubbf8\ub4e4\uc6e8\uc5b4\ub3c4 \uac19\uc740 \ubc29\uc2dd\uc73c\ub85c \uc801\uc6a9 (.apply(logger))\n      .forRoutes("users"); // \ud2b9\uc815 \ub77c\uc6b0\ud2b8\uc5d0\ub9cc \uc801\uc6a9 (users \uacbd\ub85c\uc5d0\ub9cc \uc801\uc6a9)\n  }\n}\n\nconsumer.apply(LoggerMiddleware).forRoutes("*"); // \ubaa8\ub4e0 \uacbd\ub85c\uc5d0 \ub300\ud574 \ubbf8\ub4e4\uc6e8\uc5b4\uac00 \uc801\uc6a9\ub428\n\nconsumer\n  .apply(LoggerMiddleware)\n  .forRoutes({ path: "users", method: RequestMethod.GET }); // GET \uba54\uc11c\ub4dc\uc5d0\ub9cc \uc801\uc6a9\n')),(0,r.yg)("h4",{id:"\uc804\uc5ed"},"\uc804\uc5ed"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},"const app = await NestFactory.create(AppModule);\napp.use(logger);\n")),(0,r.yg)("p",null,"\uae00\ub85c\ubc8c \ubbf8\ub4e4\uc6e8\uc5b4\uc5d0\uc11c\ub294 DI \ucee8\ud14c\uc774\ub108\uc5d0 \uc811\uadfc\ud560 \uc218 \uc5c6\uae30 \ub54c\ubb38\uc5d0 \ud074\ub798\uc2a4 \ubbf8\ub4e4\uc6e8\uc5b4\uac00 \uc544\ub2cc \ud568\uc218\ud615 \ubbf8\ub4e4\uc6e8\uc5b4\ub9cc \uc0ac\uc6a9\ud560 \uc218 \uc788\ub2e4. \ud074\ub798\uc2a4 \ubbf8\ub4e4\uc6e8\uc5b4\ub97c \uc804\uc5ed\uc73c\ub85c \uc124\uc815\ud558\uace0 \uc2f6\ub2e4\uba74 AppModule\uc5d0\uc11c \ubaa8\ub4e0 \uacbd\ub85c\uc5d0 \ubbf8\ub4e4\uc6e8\uc5b4\ub97c \uc124\uc815\ud558\uba74 \ub41c\ub2e4."),(0,r.yg)("h2",{id:"2-\uac00\ub4dc-guard"},"2. \uac00\ub4dc (Guard)"),(0,r.yg)("p",null,"\uac00\ub4dc\ub294 ",(0,r.yg)("inlineCode",{parentName:"p"},"CanActivate")," \uc778\ud130\ud398\uc774\uc2a4\ub97c \uad6c\ud604\ud558\ub294 ",(0,r.yg)("inlineCode",{parentName:"p"},"@Injectable()")," \ub370\ucf54\ub808\uc774\ud130\uac00 \ub2ec\ub9b0 \ud074\ub798\uc2a4\uc774\ub2e4."),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"\uac00\ub4dc\ub294 \ub2e8\uc77c \ucc45\uc784\uc744 \uac00\uc9c0\uba70, \ud2b9\uc815 \uc870\uac74(\uad8c\ud55c, \uc5ed\ud560)\uc5d0 \ub530\ub77c \uc8fc\uc5b4\uc9c4 \uc694\uccad\uc774 \ub77c\uc6b0\ud130 \ud578\ub4e4\ub7ec\uc5d0 \uc758\ud574 \ucc98\ub9ac\ub420\uc9c0 \uc5ec\ubd80\ub97c \uacb0\uc815\ud55c\ub2e4."),(0,r.yg)("li",{parentName:"ul"},"\ud1a0\ud070\uc744 \uac80\uc99d\ud558\uac70\ub098 \uc694\uccad \uac1d\uccb4\uc5d0 \uc18d\uc131\uc744 \ucd94\uac00\ud558\ub294 \uc791\uc5c5\uc740 \ud2b9\uc815 \ub77c\uc6b0\ud2b8\uc758 \ucee8\ud14d\uc2a4\ud2b8\uc640 \uc5f0\uacb0\ub418\uc5b4 \uc788\uc9c0 \uc54a\uae30 \ub54c\ubb38\uc5d0 \uc804\ud1b5\uc801\uc778 Express \uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc5d0\uc11c \uc778\uac00/\uc778\uc99d\uc740 \ubbf8\ub4e4\uc6e8\uc5b4\uc5d0 \uc758\ud574 \ucc98\ub9ac\ub418\uc5c8\ub2e4. \ud558\uc9c0\ub9cc \ubbf8\ub4e4\uc6e8\uc5b4\ub294 ",(0,r.yg)("inlineCode",{parentName:"li"},"next()")," \ud568\uc218\ub97c \ud638\ucd9c\ud55c \ud6c4\uc5d0 \uc5b4\ub5a4 \ud578\ub4e4\ub7ec\uac00 \uc2e4\ud589\ub420\uc9c0 \uc54c\uc9c0 \ubabb\ud55c\ub2e4. \ubc18\uba74 \uac00\ub4dc\ub294 ",(0,r.yg)("inlineCode",{parentName:"li"},"ExecutionContext"),"\uc5d0 \uc811\uadfc\ud560 \uc218 \uc788\uc5b4 \ub2e4\uc74c\uc5d0 \ubb34\uc5c7\uc774 \uc2e4\ud589\ub420\uc9c0\ub97c \uc54c\uace0 \uc788\ub2e4. \ub530\ub77c\uc11c \uac00\ub4dc\ub294 \uc694\uccad/\uc751\ub2f5 \uc0ac\uc774\ud074\uc5d0\uc11c \uc815\ud655\ud788 \ud544\uc694\ud55c \uc2dc\uc810\uc5d0 \ucc98\ub9ac \ub85c\uc9c1\uc744 \uac1c\uc785\ud560 \uc218 \uc788\uace0, \uc774\ub97c \uc120\uc5b8\uc801\uc73c\ub85c \uc218\ud589\ud560 \uc218 \uc788\ub2e4.")),(0,r.yg)("h3",{id:"\uad6c\ud604-1"},"\uad6c\ud604"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},'import { Injectable, CanActivate, ExecutionContext } from "@nestjs/common";\nimport { Observable } from "rxjs";\n\n@Injectable()\nexport class AuthGuard implements CanActivate {\n  canActivate(\n    context: ExecutionContext\n  ): boolean | Promise<boolean> | Observable<boolean> {\n    const request = context.switchToHttp().getRequest();\n    return validateRequest(request);\n  }\n}\n')),(0,r.yg)("p",null,"\uac00\ub4dc\ub294 ",(0,r.yg)("inlineCode",{parentName:"p"},"canActivate()")," \ud568\uc218\ub97c \uad6c\ud604\ud574\uc57c \ud55c\ub2e4. \ud574\ub2f9 \ud568\uc218\ub294 \ud604\uc7ac \uc694\uccad\uc758 \ud5c8\uc6a9 \uc5ec\ubd80\ub97c boolean\uc73c\ub85c \ubc18\ud658\ud55c\ub2e4. true\ub97c \ubc18\ud658\ud558\uba74 \uc694\uccad\uc774 \ucc98\ub9ac\ub418\uace0 false\ub97c \ubc18\ud658\ud558\uba74 \uc790\ub3d9\uc73c\ub85c ",(0,r.yg)("inlineCode",{parentName:"p"},"ForbiddenException")," \uc744 \ubc1c\uc0dd\uc2dc\ud0a8\ub2e4."),(0,r.yg)("h4",{id:"\ud2b9\uc815-\ud578\ub4e4\ub7ec\uc5d0-custom-\uba54\ud0c0\ub370\uc774\ud130\ub97c-\ucd94\uac00\ud558\uc5ec-executioncontext-\ud65c\uc6a9"},"\ud2b9\uc815 \ud578\ub4e4\ub7ec\uc5d0 Custom \uba54\ud0c0\ub370\uc774\ud130\ub97c \ucd94\uac00\ud558\uc5ec ExecutionContext \ud65c\uc6a9"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},'import { Reflector } from "@nestjs/core";\n\nexport const Roles = Reflector.createDecorator<string[]>();\n')),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},"@Post()\n@Roles(['admin'])\nasync create(@Body() createCatDto: CreateCatDto) {\n  this.catsService.create(createCatDto);\n}\n")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},'import { Injectable, CanActivate, ExecutionContext } from "@nestjs/common";\nimport { Reflector } from "@nestjs/core";\nimport { Roles } from "./roles.decorator";\n\n@Injectable()\nexport class RolesGuard implements CanActivate {\n  constructor(private reflector: Reflector) {}\n\n  canActivate(context: ExecutionContext): boolean {\n    const roles = this.reflector.get(Roles, context.getHandler());\n    if (!roles) {\n      return false;\n    }\n    const request = context.switchToHttp().getRequest();\n    const user = request.user;\n    return matchRoles(roles, user.roles);\n  }\n}\n')),(0,r.yg)("h3",{id:"\uc801\uc6a9-1"},"\uc801\uc6a9"),(0,r.yg)("p",null,"\uac00\ub4dc\ub294 \uc804\uc5ed, \ucee8\ud2b8\ub864\ub7ec, \ud568\uc218 \ubc94\uc704\ub85c \uc801\uc6a9\ud560 \uc218 \uc788\ub2e4."),(0,r.yg)("h4",{id:"\ucee8\ud2b8\ub864\ub7ec"},"\ucee8\ud2b8\ub864\ub7ec"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},'@Controller("cats")\n@UseGuards(RolesGuard)\nexport class CatsController {}\n')),(0,r.yg)("h4",{id:"\ud568\uc218-1"},"\ud568\uc218"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},"@Post()\n@Roles(['admin'])\n@UseGuards(RolesGuard)\nasync create(@Body() createCatDto: CreateCatDto) {\n  this.catsService.create(createCatDto);\n}\n")),(0,r.yg)("h4",{id:"\uc804\uc5ed-1"},"\uc804\uc5ed"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},"const app = await NestFactory.create(AppModule);\napp.useGlobalGuards(new RolesGuard());\n")),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"\ubaa8\ub4c8 \ub0b4\uc5d0\uc11c \uc124\uc815")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},'import { Module } from "@nestjs/common";\nimport { APP_GUARD } from "@nestjs/core";\n\n@Module({\n  providers: [\n    {\n      provide: APP_GUARD,\n      useClass: RolesGuard,\n    },\n  ],\n})\nexport class AppModule {}\n')),(0,r.yg)("h2",{id:"3-\uc778\ud130\uc149\ud130-interceptor"},"3. \uc778\ud130\uc149\ud130 (Interceptor)"),(0,r.yg)("p",null,"\uc778\ud130\uc149\ud130\ub294 ",(0,r.yg)("inlineCode",{parentName:"p"},"NestInterceptor")," \uc778\ud130\ud398\uc774\uc2a4\ub97c \uad6c\ud604\ud558\ub294 ",(0,r.yg)("inlineCode",{parentName:"p"},"@Injectable()")," \ub370\ucf54\ub808\uc774\ud130\uac00 \ub2ec\ub9b0 \ud074\ub798\uc2a4\uc774\ub2e4."),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"\uba54\uc11c\ub4dc \uc2e4\ud589 \uc804\ud6c4\uc5d0 \ucd94\uac00 \ub85c\uc9c1\uc744 \ubc14\uc778\ub529\ud560 \uc218 \uc788\ub2e4."),(0,r.yg)("li",{parentName:"ul"},"\ud568\uc218\uc5d0\uc11c \ubc18\ud658\ub41c \uacb0\uacfc\ub97c \ubcc0\ud615\ud560 \uc218 \uc788\ub2e4."),(0,r.yg)("li",{parentName:"ul"},"\ud568\uc218\uc5d0\uc11c \ubc1c\uc0dd\ud55c \uc608\uc678\ub97c \ubcc0\ud615\ud560 \uc218 \uc788\ub2e4."),(0,r.yg)("li",{parentName:"ul"},"\uae30\ubcf8 \ud568\uc218 \ub3d9\uc791\uc744 \ud655\uc7a5\ud560 \uc218 \uc788\ub2e4."),(0,r.yg)("li",{parentName:"ul"},"\ud2b9\uc815 \uc870\uac74(\uc608: \uce90\uc2f1 \ubaa9\uc801)\uc5d0 \ub530\ub77c \uae30\ub2a5\uc744 \uc7ac\uc815\uc758\ud560 \uc218 \uc788\ub2e4.")),(0,r.yg)("h3",{id:"\uad6c\ud604-2"},"\uad6c\ud604"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},'import {\n  Injectable,\n  NestInterceptor,\n  ExecutionContext,\n  CallHandler,\n} from "@nestjs/common";\nimport { Observable } from "rxjs";\nimport { tap } from "rxjs/operators";\n\n@Injectable()\nexport class LoggingInterceptor implements NestInterceptor {\n  intercept(context: ExecutionContext, next: CallHandler): Observable<any> {\n    console.log("Before...");\n\n    const now = Date.now();\n    return next\n      .handle()\n      .pipe(tap(() => console.log(`After... ${Date.now() - now}ms`)));\n  }\n}\n')),(0,r.yg)("p",null,"\uc778\ud130\uc149\ud130\ub294 ",(0,r.yg)("inlineCode",{parentName:"p"},"intercept()")," \ud568\uc218\ub97c \uad6c\ud604\ud558\uba70, \ud574\ub2f9 \ud568\uc218\ub294 \ub450 \uac1c\uc758 \uc778\uc218\ub97c \ubc1b\ub294\ub2e4. \uccab \ubc88\uc9f8 \uc778\uc218\ub294 ",(0,r.yg)("inlineCode",{parentName:"p"},"ExecutionContext")," \uc778\uc2a4\ud134\uc2a4(\uac00\ub4dc\uc5d0\uc11c\uc640 \ub3d9\uc77c\ud55c \uac1d\uccb4)\uc774\ub2e4. \ub450 \ubc88\uc9f8 \uc778\uc218\ub294 ",(0,r.yg)("inlineCode",{parentName:"p"},"CallHandler"),"\uc774\ub2e4. ",(0,r.yg)("inlineCode",{parentName:"p"},"CallHandler")," \uc778\ud130\ud398\uc774\uc2a4\ub294 ",(0,r.yg)("inlineCode",{parentName:"p"},"handle()")," \ud568\uc218\ub97c \uad6c\ud604\ud558\uba70, \uc774 \ud568\uc218\ub97c \uc0ac\uc6a9\ud558\uc5ec \uc778\ud130\uc149\ud130 \ub0b4\uc5d0\uc11c \ud2b9\uc815 \uc2dc\uc810\uc5d0 \ub77c\uc6b0\ud2b8 \ud578\ub4e4\ub7ec \ud568\uc218\ub97c \ud638\ucd9c\ud560 \uc218 \uc788\ub2e4. ",(0,r.yg)("inlineCode",{parentName:"p"},"intercept()")," \uba54\uc11c\ub4dc\uc758 \uad6c\ud604\uc5d0\uc11c ",(0,r.yg)("inlineCode",{parentName:"p"},"handle()")," \ud568\uc218\ub97c \ud638\ucd9c\ud558\uc9c0 \uc54a\uc73c\uba74 \ub77c\uc6b0\ud2b8 \ud578\ub4e4\ub7ec\ub294 \uc2e4\ud589\ub418\uc9c0 \uc54a\ub294\ub2e4."),(0,r.yg)("p",null,"\uc774 \uc811\uadfc \ubc29\uc2dd\uc740 ",(0,r.yg)("inlineCode",{parentName:"p"},"intercept()")," \ud568\uc218\uac00 \uc694\uccad/\uc751\ub2f5 \uc2a4\ud2b8\ub9bc\uc744 \ud6a8\uacfc\uc801\uc73c\ub85c \ub798\ud551\ud568\uc744 \uc758\ubbf8\ud55c\ub2e4. \uacb0\uacfc\uc801\uc73c\ub85c \ucd5c\uc885 \ub77c\uc6b0\ud2b8 \ud578\ub4e4\ub7ec\uc758 \uc2e4\ud589 \uc804\ud6c4\uc5d0 \uc0ac\uc6a9\uc790 \uc815\uc758 \ub85c\uc9c1\uc744 \uad6c\ud604\ud560 \uc218 \uc788\ub2e4. ",(0,r.yg)("inlineCode",{parentName:"p"},"handle()")," \ud568\uc218\ub294 ",(0,r.yg)("inlineCode",{parentName:"p"},"Observable"),"\uc744 \ubc18\ud658\ud558\ubbc0\ub85c, RxJS \uc5f0\uc0b0\uc790\ub97c \uc0ac\uc6a9\ud558\uc5ec \uc751\ub2f5\uc744 \ucd94\uac00\ub85c \uc870\uc791\ud560 \uc218 \uc788\ub2e4. \uad00\uc810 \uc9c0\ud5a5 \ud504\ub85c\uadf8\ub798\ubc0d(AOP) \uc6a9\uc5b4\ub85c, \ub77c\uc6b0\ud2b8 \ud578\ub4e4\ub7ec\uc758 \ud638\ucd9c(\uc989, ",(0,r.yg)("inlineCode",{parentName:"p"},"handle()")," \ud638\ucd9c)\uc740 ",(0,r.yg)("inlineCode",{parentName:"p"},"Pointcut"),"\uc774\ub77c\uace0 \ud558\uba70, \uc774\ub294 \ucd94\uac00 \ub85c\uc9c1\uc774 \uc0bd\uc785\ub418\ub294 \uc9c0\uc810\uc744 \ub098\ud0c0\ub0b8\ub2e4."),(0,r.yg)("p",null,"\uc608\ub97c \ub4e4\uc5b4, ",(0,r.yg)("inlineCode",{parentName:"p"},"CatsController")," \ub0b4\uc5d0 \uc815\uc758\ub41c ",(0,r.yg)("inlineCode",{parentName:"p"},"create()")," \ud578\ub4e4\ub7ec\ub85c \ud5a5\ud558\ub294 \uc694\uccad\uc774 \uc788\ub2e4\uace0 \ud588\uc744 \ub54c, \ub9cc\uc57d ",(0,r.yg)("inlineCode",{parentName:"p"},"handle()")," \ud568\uc218\ub97c \ud638\ucd9c\ud558\uc9c0 \uc54a\ub294 \uc778\ud130\uc149\ud130\uac00 \uadf8 \uc694\uccad \uacbd\ub85c\uc758 \uc5b4\ub290 \uc9c0\uc810\uc5d0\uc11c\ub4e0 \ud638\ucd9c\ub418\uba74, ",(0,r.yg)("inlineCode",{parentName:"p"},"create()")," \ud568\uc218\ub294 \uc2e4\ud589\ub418\uc9c0 \uc54a\uc744 \uac83\uc774\ub2e4. ",(0,r.yg)("inlineCode",{parentName:"p"},"handle()"),"\uc774 \ud638\ucd9c\ub418\uace0(\uadf8 ",(0,r.yg)("inlineCode",{parentName:"p"},"Observable"),"\uc774 \ubc18\ud658\ub418\uba74) \ub098\uc11c\uc57c ",(0,r.yg)("inlineCode",{parentName:"p"},"create()")," \ud578\ub4e4\ub7ec\uac00 \ud2b8\ub9ac\uac70\ub41c\ub2e4. \uadf8\ub9ac\uace0 ",(0,r.yg)("inlineCode",{parentName:"p"},"Observable"),"\uc744 \ud1b5\ud574 \uc751\ub2f5 \uc2a4\ud2b8\ub9bc\uc774 \uc218\uc2e0\ub418\uba74, \uc2a4\ud2b8\ub9bc\uc5d0 \ub300\ud574 \ucd94\uac00 \uc791\uc5c5\uc744 \uc218\ud589\ud558\uace0 \ucd5c\uc885 \uacb0\uacfc\ub97c \ud638\ucd9c\uc790\uc5d0\uac8c \ubc18\ud658\ud560 \uc218 \uc788\ub2e4."),(0,r.yg)("h4",{id:"\uc751\ub2f5-\ub9e4\ud551\uc73c\ub85c-\ud65c\uc6a9"},"\uc751\ub2f5 \ub9e4\ud551\uc73c\ub85c \ud65c\uc6a9"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},'import {\n  Injectable,\n  NestInterceptor,\n  ExecutionContext,\n  CallHandler,\n} from "@nestjs/common";\nimport { Observable } from "rxjs";\nimport { map } from "rxjs/operators";\n\n@Injectable()\nexport class ExcludeNullInterceptor implements NestInterceptor {\n  intercept(context: ExecutionContext, next: CallHandler): Observable<any> {\n    return next.handle().pipe(map((value) => (value === null ? "" : value)));\n  }\n}\n')),(0,r.yg)("h4",{id:"\uce90\uc2dc-\uad6c\ud604\uc73c\ub85c-\ud65c\uc6a9"},"\uce90\uc2dc \uad6c\ud604\uc73c\ub85c \ud65c\uc6a9"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},'import {\n  Injectable,\n  NestInterceptor,\n  ExecutionContext,\n  CallHandler,\n} from "@nestjs/common";\nimport { Observable, of } from "rxjs";\n\n@Injectable()\nexport class CacheInterceptor implements NestInterceptor {\n  intercept(context: ExecutionContext, next: CallHandler): Observable<any> {\n    const isCached = true;\n    if (isCached) {\n      return of([]);\n    }\n    return next.handle();\n  }\n}\n')),(0,r.yg)("h3",{id:"\uc801\uc6a9-2"},"\uc801\uc6a9"),(0,r.yg)("p",null,"\uc778\ud130\uc149\ud130\ub294 \uc804\uc5ed, \ucee8\ud2b8\ub864\ub7ec, \ud568\uc218 \ubc94\uc704\ub85c \uc801\uc6a9\ud560 \uc218 \uc788\ub2e4."),(0,r.yg)("h4",{id:"\ucee8\ud2b8\ub864\ub7ec-1"},"\ucee8\ud2b8\ub864\ub7ec"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},"@UseInterceptors(LoggingInterceptor)\nexport class CatsController {}\n")),(0,r.yg)("h4",{id:"\ud568\uc218-2"},"\ud568\uc218"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},"@Post()\n@UseInterceptors(LoggingInterceptor)\nasync create(@Body() createCatDto: CreateCatDto) {\n  this.catsService.create(createCatDto);\n}\n")),(0,r.yg)("h4",{id:"\uc804\uc5ed-2"},"\uc804\uc5ed"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},"const app = await NestFactory.create(AppModule);\napp.useGlobalInterceptors(new LoggingInterceptor());\n")),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"\ubaa8\ub4c8 \ub0b4\uc5d0\uc11c \uc124\uc815")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},'import { Module } from "@nestjs/common";\nimport { APP_INTERCEPTOR } from "@nestjs/core";\n\n@Module({\n  providers: [\n    {\n      provide: APP_INTERCEPTOR,\n      useClass: LoggingInterceptor,\n    },\n  ],\n})\nexport class AppModule {}\n')),(0,r.yg)("h2",{id:"4-\ud30c\uc774\ud504-pipe"},"4. \ud30c\uc774\ud504 (Pipe)"),(0,r.yg)("p",null,"\ud30c\uc774\ud504\ub294 ",(0,r.yg)("inlineCode",{parentName:"p"},"PipeTransform")," \uc778\ud130\ud398\uc774\uc2a4\ub97c \uad6c\ud604\ud558\ub294 ",(0,r.yg)("inlineCode",{parentName:"p"},"@Injectable()")," \ub370\ucf54\ub808\uc774\ud130\uac00 \ub2ec\ub9b0 \ud074\ub798\uc2a4\uc774\ub2e4."),(0,r.yg)("ol",null,(0,r.yg)("li",{parentName:"ol"},"\ubcc0\ud658: \uc785\ub825 \ub370\uc774\ud130\ub97c \uc6d0\ud558\ub294 \ucd9c\ub825\uc73c\ub85c \ubcc0\ud658\ud55c\ub2e4."),(0,r.yg)("li",{parentName:"ol"},"\uac80\uc99d: \uc785\ub825 \ub370\uc774\ud130\ub97c \ud3c9\uac00\ud558\uace0, \uc720\ud6a8\ud560 \uacbd\uc6b0 \ud1b5\uacfc\uc2dc\ud0a4\uba70, \ub370\uc774\ud130\uac00 \uc798\ubabb\ub418\uc5c8\uc744 \ub54c\ub294 \uc608\uc678\ub97c \ubc1c\uc0dd\uc2dc\ud0a8\ub2e4.")),(0,r.yg)("p",null,"\ud30c\uc774\ud504\ub294 \ucee8\ud2b8\ub864\ub7ec\uc758 \ub77c\uc6b0\ud2b8 \ud578\ub4e4\ub7ec\uc5d0\uc11c \ucc98\ub9ac\ub418\uace0 \uc788\ub294 \uc778\uc218\uc5d0 \ub300\ud574 \uc791\ub3d9\ud55c\ub2e4. Nest\ub294 \ud568\uc218\uac00 \ud638\ucd9c\ub418\uae30 \uc9c1\uc804\uc5d0 \ud30c\uc774\ud504\ub97c \uc0bd\uc785\ud558\uba70, \ud30c\uc774\ud504\ub294 \ud574\ub2f9 \ud568\uc218\ub85c \ud5a5\ud558\ub294 \uc778\uc218\ub97c \uc218\uc2e0\ud55c\ub2e4. \uc774 \uc2dc\uc810\uc5d0\uc11c \ubcc0\ud658\uc774\ub098 \uac80\uc99d \uc791\uc5c5\uc774 \uc774\ub8e8\uc5b4\uc9c0\uace0, \uadf8 \ud6c4 \ub77c\uc6b0\ud2b8 \ud578\ub4e4\ub7ec\uac00 \ubcc0\ud658\ub41c \uc778\uc218(\uc788\uc744 \uacbd\uc6b0)\ub85c \ud638\ucd9c\ub41c\ub2e4."),(0,r.yg)("h3",{id:"\uad6c\ud604-3"},"\uad6c\ud604"),(0,r.yg)("h4",{id:"\ub0b4\uc7a5-\ud30c\uc774\ud504"},"\ub0b4\uc7a5 \ud30c\uc774\ud504"),(0,r.yg)("p",null,"Nest\uc5d0\uc11c\ub294 9\uac1c\uc758 \ud30c\uc774\ud504\ub97c \uae30\ubcf8\uc801\uc73c\ub85c \uc81c\uacf5\ud55c\ub2e4."),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"ValidationPipe")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"ParseIntPipe")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"ParseFloatPipe")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"ParseBoolPipe")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"ParseArrayPipe")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"ParseUUIDPipe")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"ParseEnumPipe")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"DefaultValuePipe")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"ParseFilePipe"))),(0,r.yg)("h4",{id:"\ucee4\uc2a4\ud140-\ud30c\uc774\ud504"},"\ucee4\uc2a4\ud140 \ud30c\uc774\ud504"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},'import { PipeTransform, Injectable, ArgumentMetadata } from "@nestjs/common";\n\n@Injectable()\nexport class ValidationPipe implements PipeTransform {\n  transform(value: any, metadata: ArgumentMetadata) {\n    return value;\n  }\n}\n')),(0,r.yg)("p",null,"\ud30c\uc774\ud504\ub294 ",(0,r.yg)("inlineCode",{parentName:"p"},"transform()")," \ud568\uc218\ub97c \uad6c\ud604\ud574\uc57c \ud55c\ub2e4. \uc774 \ud568\uc218\ub294 \ub450 \uac1c\uc758 \ub9e4\uac1c\ubcc0\uc218\ub97c \uac00\uc9c4\ub2e4."),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"value")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"metadata"))),(0,r.yg)("p",null,(0,r.yg)("inlineCode",{parentName:"p"},"value")," \ub294 \ud604\uc7ac \ucc98\ub9ac \uc911\uc778 \ud568\uc218\uc758 \uc778\uc218(\ub77c\uc6b0\ud2b8 \ud578\ub4e4\ub7ec \ud568\uc218\uac00 \ubc1b\uae30 \uc804\uc758 \uac12)\uc774\uba70, ",(0,r.yg)("inlineCode",{parentName:"p"},"metadata"),"\ub294 \ud604\uc7ac \ucc98\ub9ac \uc911\uc778 \ud568\uc218\uc758 \uba54\ud0c0\ub370\uc774\ud130\uc774\ub2e4. ",(0,r.yg)("inlineCode",{parentName:"p"},"metadata")," \uac1d\uccb4\ub294 \ub2e4\uc74c\uacfc \uac19\uc740 \uc18d\uc131\ub4e4\uc744 \uac00\uc9c4\ub2e4."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},'export interface ArgumentMetadata {\n  type: "body" | "query" | "param" | "custom";\n  metatype?: Type<unknown>;\n  data?: string;\n}\n')),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"type"),": \uc778\uc218\uac00 ",(0,r.yg)("inlineCode",{parentName:"li"},"@Body()"),", ",(0,r.yg)("inlineCode",{parentName:"li"},"@Query()"),", ",(0,r.yg)("inlineCode",{parentName:"li"},"@Param()"),"\uc778\uc9c0, \ub610\ub294 \uc0ac\uc6a9\uc790 \uc815\uc758 \ud30c\ub77c\ubbf8\ud130\uc778\uc9c0 \ub098\ud0c0\ub0b8\ub2e4."),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"metatype"),": \uc778\uc218\uc758 \uba54\ud0c0\ud0c0\uc785\uc744 \uc81c\uacf5\ud55c\ub2e4. \uc608\ub97c \ub4e4\uc5b4, ",(0,r.yg)("inlineCode",{parentName:"li"},"String")," \uac19\uc740 \uac12\uc774 \uc62c \uc218 \uc788\ub2e4. \ub77c\uc6b0\ud2b8 \ud578\ub4e4\ub7ec \ud568\uc218\uc5d0\uc11c \ud0c0\uc785 \uc120\uc5b8\uc744 \uc0dd\ub7b5\ud558\uac70\ub098 \uae30\ubcf8 \uc790\ubc14\uc2a4\ud06c\ub9bd\ud2b8\ub97c \uc0ac\uc6a9\ud560 \uacbd\uc6b0, \uc774 \uac12\uc740 ",(0,r.yg)("inlineCode",{parentName:"li"},"undefined"),"\uac00 \ub41c\ub2e4."),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"data"),": \ub370\ucf54\ub808\uc774\ud130\uc5d0 \uc804\ub2ec\ub41c \ubb38\uc790\uc5f4, \uc608\ub97c \ub4e4\uc5b4 ",(0,r.yg)("inlineCode",{parentName:"li"},"@Body('string')"),"\uc5d0\uc11c\uc758 'string'\uc774\ub2e4. \ub370\ucf54\ub808\uc774\ud130 \uad04\ud638\ub97c \ube44\uc6cc\ub450\uba74 \uc774 \uac12\uc740 ",(0,r.yg)("inlineCode",{parentName:"li"},"undefined"),"\uac00 \ub41c\ub2e4.")),(0,r.yg)("h3",{id:"\uc801\uc6a9-3"},"\uc801\uc6a9"),(0,r.yg)("p",null,"\ud30c\uc774\ud504\ub294 \uc804\uc5ed, \ucee8\ud2b8\ub864\ub7ec, \ud568\uc218, \ub9e4\uac1c\ubcc0\uc218 \ubc94\uc704\ub85c \uc801\uc6a9\ud560 \uc218 \uc788\ub2e4."),(0,r.yg)("h4",{id:"\ub9e4\uac1c\ubcc0\uc218"},"\ub9e4\uac1c\ubcc0\uc218"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},"@Post()\nasync create(\n  @Body(new ValidationPipe()) createCatDto: CreateCatDto,\n) {\n  this.catsService.create(createCatDto);\n}\n")),(0,r.yg)("h4",{id:"\uc804\uc5ed-3"},"\uc804\uc5ed"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},"async function bootstrap() {\n  const app = await NestFactory.create(AppModule);\n  app.useGlobalPipes(new ValidationPipe());\n  await app.listen(3000);\n}\nbootstrap();\n")),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"\ubaa8\ub4c8 \ub0b4\uc5d0\uc11c \uc124\uc815")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},'import { Module } from "@nestjs/common";\nimport { APP_PIPE } from "@nestjs/core";\n\n@Module({\n  providers: [\n    {\n      provide: APP_PIPE,\n      useClass: ValidationPipe,\n    },\n  ],\n})\nexport class AppModule {}\n')),(0,r.yg)("h2",{id:"\uc608\uc678-\ud544\ud130-exception-filter"},"\uc608\uc678 \ud544\ud130 (Exception Filter)"),(0,r.yg)("p",null,"Nest\uc5d0\ub294 \uc560\ud50c\ub9ac\ucf00\uc774\uc158 \uc804\ubc18\uc5d0\uc11c \ucc98\ub9ac\ub418\uc9c0 \uc54a\uc740 \uc608\uc678\ub97c \ucc98\ub9ac\ud558\ub294 \ub0b4\uc7a5 \uc608\uc678 \ucc98\ub9ac \uacc4\uce35\uc774 \uc788\ub2e4. \uc560\ud50c\ub9ac\ucf00\uc774\uc158 \ucf54\ub4dc\uc5d0\uc11c \uc608\uc678\uac00 \ucc98\ub9ac\ub418\uc9c0 \uc54a\uc73c\uba74, \uc774 \uacc4\uce35\uc774 \uc608\uc678\ub97c \uc7a1\uc544 \uc801\uc808\ud55c \uc0ac\uc6a9\uc790 \uce5c\ud654\uc801\uc778 \uc751\ub2f5\uc744 \uc790\ub3d9\uc73c\ub85c \ub0b4\ubcf4\ub0b8\ub2e4."),(0,r.yg)("p",null,"\uc774 \ub3d9\uc791\uc740 ",(0,r.yg)("inlineCode",{parentName:"p"},"HttpException")," \uc720\ud615(\ubc0f \uadf8 \ud558\uc704 \ud074\ub798\uc2a4) \uc608\uc678\ub97c \ucc98\ub9ac\ud558\ub294 \ub0b4\uc7a5 \uae00\ub85c\ubc8c \uc608\uc678 \ud544\ud130\uc5d0 \uc758\ud574 \uc218\ud589\ub41c\ub2e4. \uc608\uc678\uac00 \uc778\uc2dd\ub418\uc9c0 \uc54a\uc744 \uacbd\uc6b0(\uc989, ",(0,r.yg)("inlineCode",{parentName:"p"},"HttpException"),"\uc774\ub098 \uadf8 \ud558\uc704 \ud074\ub798\uc2a4\uac00 \uc544\ub2d0 \uacbd\uc6b0), \ub0b4\uc7a5 \uc608\uc678 \ud544\ud130\ub294 \uc544\ub798\uc640 \uac19\uc740 \uae30\ubcf8 JSON \uc751\ub2f5\uc744 \uc0dd\uc131\ud55c\ub2e4."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-json"},'{\n  "statusCode": 500,\n  "message": "Internal server error"\n}\n')),(0,r.yg)("p",null,"\uae30\ubcf8\uc73c\ub85c \ub0b4\uc7a5\ub41c \uc608\uc678 \ud544\ud130\uc5d0\uc11c \uc81c\uacf5\ub418\ub294 \uae30\ub2a5 \uc678\uc5d0 \ub85c\uae45\uc744 \ucd94\uac00\ud558\uac70\ub098 \uc608\uc678\uc5d0 \ub300\ud55c \ucee4\uc2a4\ud140 \uc751\ub2f5 \ub85c\uc9c1\uc744 \uad6c\ud604\ud558\uace0 \uc2f6\uc740 \uacbd\uc6b0 \uc608\uc678 \ud544\ud130\ub97c \uc0ac\uc6a9\ud560 \uc218 \uc788\ub2e4. \uc608\uc678 \ud544\ud130\ub294 ",(0,r.yg)("inlineCode",{parentName:"p"},"ExceptionFilter")," \uc778\ud130\ud398\uc774\uc2a4\ub97c \uad6c\ud604\ud574\uc57c \ud55c\ub2e4."),(0,r.yg)("h3",{id:"\uad6c\ud604-4"},"\uad6c\ud604"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},'import {\n  ExceptionFilter,\n  Catch,\n  ArgumentsHost,\n  HttpException,\n} from "@nestjs/common";\nimport { Request, Response } from "express";\n\n@Catch(HttpException)\nexport class HttpExceptionFilter implements ExceptionFilter {\n  catch(exception: HttpException, host: ArgumentsHost) {\n    const ctx = host.switchToHttp();\n    const response = ctx.getResponse<Response>();\n    const request = ctx.getRequest<Request>();\n    const status = exception.getStatus();\n\n    response.status(status).json({\n      statusCode: status,\n      timestamp: new Date().toISOString(),\n      path: request.url,\n    });\n  }\n}\n')),(0,r.yg)("p",null,"\uc608\uc678 \ud544\ud130\ub294 ",(0,r.yg)("inlineCode",{parentName:"p"},"catch()")," \ud568\uc218\ub97c \uad6c\ud604\ud574\uc57c \ud55c\ub2e4. ",(0,r.yg)("inlineCode",{parentName:"p"},"catch()")," \ud568\uc218\uc758 \ud30c\ub77c\ubbf8\ud130\ub97c \uc0b4\ud3b4\ubcf4\uba74, ",(0,r.yg)("inlineCode",{parentName:"p"},"exception"),"\uc740 \ud604\uc7ac \ucc98\ub9ac \uc911\uc778 \uc608\uc678 \uac1d\uccb4\uc774\uba70, ",(0,r.yg)("inlineCode",{parentName:"p"},"host"),"\ub294 ",(0,r.yg)("inlineCode",{parentName:"p"},"ArgumentsHost")," \uac1d\uccb4\uc774\ub2e4. ",(0,r.yg)("inlineCode",{parentName:"p"},"ArgumentsHost"),"\ub294 \uc694\uccad \ud578\ub4e4\ub7ec\ub85c \uc804\ub2ec\ub41c ",(0,r.yg)("inlineCode",{parentName:"p"},"Request"),"\uc640 ",(0,r.yg)("inlineCode",{parentName:"p"},"Response")," \uac1d\uccb4\uc5d0 \uc811\uadfc\ud558\ub294 \ub370 \uc0ac\uc6a9\ub41c\ub2e4."),(0,r.yg)("p",null,(0,r.yg)("inlineCode",{parentName:"p"},"@Catch(HttpException)")," \ub370\ucf54\ub808\uc774\ud130\ub294 \ud544\ud130\uac00 ",(0,r.yg)("inlineCode",{parentName:"p"},"HttpException")," \ud0c0\uc785\uc758 \uc608\uc678\ub9cc \ucc98\ub9ac\ud558\ub3c4\ub85d \uc694\uad6c\ud558\ub294 \uba54\ud0c0\ub370\uc774\ud130\ub97c \ubc14\uc778\ub529\ud55c\ub2e4. \uc774 \ub370\ucf54\ub808\uc774\ud130\ub294 \ud558\ub098\uc758 \ud30c\ub77c\ubbf8\ud130\ub97c \ubc1b\uac70\ub098 \uc27c\ud45c\ub85c \uad6c\ubd84\ub41c \uc5ec\ub7ec \ud30c\ub77c\ubbf8\ud130\ub97c \ubc1b\uc744 \uc218 \uc788\uc5b4, \uc5ec\ub7ec \uc608\uc678 \ud0c0\uc785\uc5d0 \ub300\ud574 \ud544\ud130\ub97c \uc124\uc815\ud560 \uc218 \uc788\ub2e4."),(0,r.yg)("h3",{id:"\uc801\uc6a9-4"},"\uc801\uc6a9"),(0,r.yg)("p",null,"\uc608\uc678 \ud544\ud130\ub294 \ucee8\ud2b8\ub864\ub7ec/\ub9ac\uc878\ubc84/\uac8c\uc774\ud2b8\uc6e8\uc774\uc758 \ud568\uc218 \ubc94\uc704, \ucee8\ud2b8\ub864\ub7ec \ubc94\uc704, \uc804\uc5ed \ubc94\uc704 \ub4f1\uc73c\ub85c \uc124\uc815\ud560 \uc218 \uc788\ub2e4."),(0,r.yg)("h4",{id:"\ud568\uc218-3"},"\ud568\uc218"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},"@Post()\n@UseFilters(HttpExceptionFilter)\nasync create(@Body() createCatDto: CreateCatDto) {\n  throw new ForbiddenException();\n}\n")),(0,r.yg)("h4",{id:"\ucee8\ud2b8\ub864\ub7ec-2"},"\ucee8\ud2b8\ub864\ub7ec"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},"@UseFilters(HttpExceptionFilter)\nexport class CatsController {}\n")),(0,r.yg)("h4",{id:"\uc804\uc5ed-4"},"\uc804\uc5ed"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},"async function bootstrap() {\n  const app = await NestFactory.create(AppModule);\n  app.useGlobalFilters(new HttpExceptionFilter());\n  await app.listen(3000);\n}\nbootstrap();\n")),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"\ubaa8\ub4c8 \ub0b4\uc5d0\uc11c \uc124\uc815")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-typescript"},'import { Module } from "@nestjs/common";\nimport { APP_FILTER } from "@nestjs/core";\n\n@Module({\n  providers: [\n    {\n      provide: APP_FILTER,\n      useClass: HttpExceptionFilter,\n    },\n  ],\n})\nexport class AppModule {}\n')),(0,r.yg)("h2",{id:"summary"},"Summary"),(0,r.yg)("ol",null,(0,r.yg)("li",{parentName:"ol"},"\uc694\uccad (Incoming request)"),(0,r.yg)("li",{parentName:"ol"},"\ubbf8\ub4e4\uc6e8\uc5b4 (Middleware)",(0,r.yg)("ol",{parentName:"li"},(0,r.yg)("li",{parentName:"ol"},"\uc804\uc5ed \ubbf8\ub4e4\uc6e8\uc5b4 (Globally bound middleware)"),(0,r.yg)("li",{parentName:"ol"},"\ubaa8\ub4c8 \ubbf8\ub4e4\uc6e8\uc5b4 (Module bound middleware)"))),(0,r.yg)("li",{parentName:"ol"},"\uac00\ub4dc (Guards)",(0,r.yg)("ol",{parentName:"li"},(0,r.yg)("li",{parentName:"ol"},"\uc804\uc5ed \uac00\ub4dc (Global guards)"),(0,r.yg)("li",{parentName:"ol"},"\ucee8\ud2b8\ub864\ub7ec \uac00\ub4dc (Controller guards)"),(0,r.yg)("li",{parentName:"ol"},"\ub77c\uc6b0\ud2b8 \uac00\ub4dc (Route guards)"))),(0,r.yg)("li",{parentName:"ol"},"\uc778\ud130\uc149\ud130 (\ucee8\ud2b8\ub864\ub7ec \uc774\uc804) (Interceptors (pre-controller))",(0,r.yg)("ol",{parentName:"li"},(0,r.yg)("li",{parentName:"ol"},"\uc804\uc5ed \uc778\ud130\uc149\ud130 (Global interceptors)"),(0,r.yg)("li",{parentName:"ol"},"\ucee8\ud2b8\ub864\ub7ec \uc778\ud130\uc149\ud130 (Controller interceptors)"),(0,r.yg)("li",{parentName:"ol"},"\ub77c\uc6b0\ud2b8 \uc778\ud130\uc149\ud130 (Route interceptors)"))),(0,r.yg)("li",{parentName:"ol"},"\ud30c\uc774\ud504 (Pipes)",(0,r.yg)("ol",{parentName:"li"},(0,r.yg)("li",{parentName:"ol"},"\uc804\uc5ed \ud30c\uc774\ud504 (Global pipes)"),(0,r.yg)("li",{parentName:"ol"},"\ucee8\ud2b8\ub864\ub7ec \ud30c\uc774\ud504 (Controller pipes)"),(0,r.yg)("li",{parentName:"ol"},"\ub77c\uc6b0\ud2b8 \ud30c\uc774\ud504 (Route pipes)"),(0,r.yg)("li",{parentName:"ol"},"\ub77c\uc6b0\ud2b8 \ud30c\ub77c\ubbf8\ud130 \ud30c\uc774\ud504 (Route parameter pipes)"))),(0,r.yg)("li",{parentName:"ol"},"\ucee8\ud2b8\ub864\ub7ec (\uba54\uc11c\ub4dc \ud578\ub4e4\ub7ec) (Controller (method handler))"),(0,r.yg)("li",{parentName:"ol"},"\uc11c\ube44\uc2a4 (\uc874\uc7ac\ud560 \uacbd\uc6b0) (Service (if exists))"),(0,r.yg)("li",{parentName:"ol"},"\uc778\ud130\uc149\ud130 (\uc694\uccad \ud6c4) (Interceptors (post-request))",(0,r.yg)("ol",{parentName:"li"},(0,r.yg)("li",{parentName:"ol"},"\ub77c\uc6b0\ud2b8 \uc778\ud130\uc149\ud130 (Route interceptor)"),(0,r.yg)("li",{parentName:"ol"},"\ucee8\ud2b8\ub864\ub7ec \uc778\ud130\uc149\ud130 (Controller interceptor)"),(0,r.yg)("li",{parentName:"ol"},"\uc804\uc5ed \uc778\ud130\uc149\ud130 (Global interceptor)"))),(0,r.yg)("li",{parentName:"ol"},"\uc608\uc678 \ud544\ud130 (Exception filters)",(0,r.yg)("ol",{parentName:"li"},(0,r.yg)("li",{parentName:"ol"},"\ub77c\uc6b0\ud2b8 \uc608\uc678 \ud544\ud130 (Route exception filter)"),(0,r.yg)("li",{parentName:"ol"},"\ucee8\ud2b8\ub864\ub7ec \uc608\uc678 \ud544\ud130 (Controller exception filter)"),(0,r.yg)("li",{parentName:"ol"},"\uc804\uc5ed \uc608\uc678 \ud544\ud130 (Global exception filter)"))),(0,r.yg)("li",{parentName:"ol"},"\uc11c\ubc84 \uc751\ub2f5 (Server response)")),(0,r.yg)("hr",null),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"\ucc38\uc870")),(0,r.yg)("p",null,(0,r.yg)("a",{parentName:"p",href:"https://docs.nestjs.com/faq/request-lifecycle"},"https://docs.nestjs.com/faq/request-lifecycle")),(0,r.yg)("p",null,(0,r.yg)("a",{parentName:"p",href:"https://docs.nestjs.com/middleware"},"https://docs.nestjs.com/middleware")),(0,r.yg)("p",null,(0,r.yg)("a",{parentName:"p",href:"https://docs.nestjs.com/guards"},"https://docs.nestjs.com/guards")),(0,r.yg)("p",null,(0,r.yg)("a",{parentName:"p",href:"https://docs.nestjs.com/interceptors"},"https://docs.nestjs.com/interceptors")),(0,r.yg)("p",null,(0,r.yg)("a",{parentName:"p",href:"https://docs.nestjs.com/pipes"},"https://docs.nestjs.com/pipes")),(0,r.yg)("p",null,(0,r.yg)("a",{parentName:"p",href:"https://docs.nestjs.com/exception-filters"},"https://docs.nestjs.com/exception-filters")))}m.isMDXComponent=!0}}]);