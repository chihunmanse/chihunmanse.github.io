<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-blockchain/cryptography/ecdsa">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">ECDSA (Elliptic Curve Digital Signature Algorithm) | Chihun&#x27;s Dev Blog</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://chihunmanse.github.io/img/m.png"><meta data-rh="true" name="twitter:image" content="https://chihunmanse.github.io/img/m.png"><meta data-rh="true" property="og:url" content="https://chihunmanse.github.io/blockchain/cryptography/ecdsa"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="ECDSA (Elliptic Curve Digital Signature Algorithm) | Chihun&#x27;s Dev Blog"><meta data-rh="true" name="description" content="블록체인 트랜잭션의 핵심, 타원곡선 기반 디지털 서명 알고리즘의 원리와 구현"><meta data-rh="true" property="og:description" content="블록체인 트랜잭션의 핵심, 타원곡선 기반 디지털 서명 알고리즘의 원리와 구현"><meta data-rh="true" name="keywords" content="ECDSA,elliptic curve,digital signature,secp256k1,blockchain,ethereum,bitcoin,schnorr,eddsa,mpc"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://chihunmanse.github.io/blockchain/cryptography/ecdsa"><link data-rh="true" rel="alternate" href="https://chihunmanse.github.io/blockchain/cryptography/ecdsa" hreflang="en"><link data-rh="true" rel="alternate" href="https://chihunmanse.github.io/blockchain/cryptography/ecdsa" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.5b6de4da.css">
<link rel="preload" href="/assets/js/runtime~main.ababe4bb.js" as="script">
<link rel="preload" href="/assets/js/main.01b4c91d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">Chihun&#x27;s Dev Blog</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/tags">Tags</a><a href="https://github.com/chihunmanse" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><b>Chihun&#x27;s Dev Blog</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Home</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/datastructure-algorithm">DataStructure &amp; Algorithm</a><button aria-label="Toggle the collapsible sidebar category &#x27;DataStructure &amp; Algorithm&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/backend">Backend</a><button aria-label="Toggle the collapsible sidebar category &#x27;Backend&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/devops">DevOps</a><button aria-label="Toggle the collapsible sidebar category &#x27;DevOps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/blockchain">BlockChain</a><button aria-label="Toggle the collapsible sidebar category &#x27;BlockChain&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/blockchain/upgradeable-contract">Upgradeable Contract</a><button aria-label="Toggle the collapsible sidebar category &#x27;Upgradeable Contract&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blockchain/contract-error-handling">Contract Error Handling</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/blockchain/cryptography">Cryptography</a><button aria-label="Toggle the collapsible sidebar category &#x27;Cryptography&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/blockchain/cryptography/hash-function">Hash Function</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/blockchain/cryptography/elliptic-curve-cryptography">Elliptic Curve Cryptography</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/blockchain/cryptography/ecdsa">ECDSA (Elliptic Curve Digital Signature Algorithm)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/blockchain/cryptography/shamir-secret-sharing">Shamir&#x27;s Secret Sharing (SSS)</a></li></ul></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/blockchain"><span itemprop="name">BlockChain</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/blockchain/cryptography"><span itemprop="name">Cryptography</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">ECDSA (Elliptic Curve Digital Signature Algorithm)</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>ECDSA (Elliptic Curve Digital Signature Algorithm)</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="왜-디지털-서명이-필요한가">왜 디지털 서명이 필요한가<a href="#왜-디지털-서명이-필요한가" class="hash-link" aria-label="Direct link to 왜 디지털 서명이 필요한가" title="Direct link to 왜 디지털 서명이 필요한가">​</a></h2><p>블록체인에서 트랜잭션을 보낼 때, 네트워크는 한 가지 핵심적인 질문에 답해야 한다. <strong>&quot;이 트랜잭션이 정말 해당 지갑의 소유자가 보낸 것인가?&quot;</strong></p><p>전통적인 금융 시스템에서는 은행이 신원을 확인하고, 비밀번호나 OTP로 본인 인증을 수행한다. 하지만 블록체인은 중앙 기관이 없다. 그렇다면 어떻게 신원을 증명할 수 있을까?</p><p>디지털 서명은 이 딜레마를 해결한다. <strong>개인키를 공개하지 않으면서도, 개인키를 알고 있다는 사실을 증명</strong>할 수 있게 해준다. 이것이 바로 ECDSA(Elliptic Curve Digital Signature Algorithm)가 하는 일이다.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="사전-지식-타원곡선-암호학">사전 지식: 타원곡선 암호학<a href="#사전-지식-타원곡선-암호학" class="hash-link" aria-label="Direct link to 사전 지식: 타원곡선 암호학" title="Direct link to 사전 지식: 타원곡선 암호학">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ecdsa에-필요한-핵심-개념">ECDSA에 필요한 핵심 개념<a href="#ecdsa에-필요한-핵심-개념" class="hash-link" aria-label="Direct link to ECDSA에 필요한 핵심 개념" title="Direct link to ECDSA에 필요한 핵심 개념">​</a></h3><p><strong>1. 타원곡선과 점 덧셈</strong></p><p>타원곡선은 <code>y² = x³ + ax + b</code> 형태의 방정식을 만족하는 점들의 집합이다. 이전 글에서 보았듯이, 곡선 위의 두 점을 더해서 새로운 점을 만드는 특별한 연산이 있다. 이것이 ECDSA의 수학적 기반이다.</p><p><strong>2. 스칼라 곱셈과 일방향성</strong></p><p>점 P를 k번 더하는 연산을 <strong>스칼라 곱셈</strong>이라고 부르고, <code>k × P</code>로 표기한다. 이 연산의 핵심은 <strong>일방향성</strong>이다:</p><ul><li><strong>순방향 (쉬움)</strong>: k와 P를 알면 <code>k × P = Q</code>를 빠르게 계산할 수 있다</li><li><strong>역방향 (어려움)</strong>: Q와 P를 알더라도 k를 찾는 것은 사실상 불가능하다</li></ul><p>이것이 ECDSA 보안의 수학적 기반이다. 공개키 Q를 공개해도 개인키 k를 역산할 수 없기 때문이다.</p><p><strong>3. 생성점 G와 위수 n</strong></p><ul><li><strong>생성점 G</strong>: 모든 사람이 알고 있는 표준 점. 공개키는 <code>Q = d × G</code>로 계산된다</li><li><strong>위수 n</strong>: 곡선 위의 점 개수. 개인키는 1부터 n-1 사이의 값이다</li></ul><p>secp256k1에서 n은 약 2²⁵⁶이므로, 개인키는 256비트 범위 내에서 선택한다.</p><p><strong>4. secp256k1 곡선</strong></p><p>비트코인과 이더리움이 사용하는 곡선으로, <code>y² = x³ + 7 (mod p)</code> 형태다. a = 0이어서 계산이 단순화되고, 투명하고 검증된 보안을 제공한다.</p><p><strong>왜 이 개념들이 ECDSA에 중요한가?</strong></p><p>ECDSA는 이 일방향성을 활용한다. 개인키를 직접 공개하지 않고도, 개인키를 알고 있다는 사실을 수학적으로 증명할 수 있게 해준다. 서명 생성 과정에서 스칼라 곱셈을 사용하고, 검증 과정에서 이 일방향성을 이용해 서명의 유효성을 확인한다.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ecdsa-동작-원리">ECDSA 동작 원리<a href="#ecdsa-동작-원리" class="hash-link" aria-label="Direct link to ECDSA 동작 원리" title="Direct link to ECDSA 동작 원리">​</a></h2><p>이전 글 <a href="/blockchain/cryptography/elliptic-curve-cryptography">타원곡선 암호학</a>에서 배운 개념들을 활용하여, 이제 실제로 디지털 서명을 생성하고 검증하는 방법을 배워보자.</p><p>ECDSA는 크게 세 단계로 구성된다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">1. 키 생성: 개인키 d → 공개키 Q = d × G</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2. 서명 생성: 메시지 m + 개인키 d → 서명 (r, s)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">3. 서명 검증: 메시지 m + 서명 (r, s) + 공개키 Q → 유효/무효 판단</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>각 단계에서 타원곡선의 수학적 성질이 어떻게 활용되는지 살펴보자.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1단계-키-생성">1단계: 키 생성<a href="#1단계-키-생성" class="hash-link" aria-label="Direct link to 1단계: 키 생성" title="Direct link to 1단계: 키 생성">​</a></h3><p>키 생성은 타원곡선 암호학의 핵심 개념을 그대로 사용한다.</p><ol><li><p><strong>개인키(d)</strong>: 1부터 n-1 사이의 랜덤한 정수를 선택한다.</p><ul><li>n은 곡선의 <strong>위수(order)</strong>로, 곡선 위의 점 개수다.</li><li>secp256k1에서 n ≈ 2²⁵⁶이므로, 개인키는 256비트(32바이트) 크기다.</li></ul></li><li><p><strong>공개키(Q)</strong>: 개인키와 생성점 G를 곱한다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Q = d × G</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>G는 <strong>생성점(generator point)</strong>으로, secp256k1 표준에서 미리 정해진 점이다.</li><li>스칼라 곱셈 <code>d × G</code>는 이전 글에서 배운 Double-and-Add 알고리즘으로 빠르게 계산된다.</li><li>Q는 타원곡선 위의 점이므로 (x, y) 좌표로 표현된다.</li></ul></li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">개인키: d (256비트 랜덤 정수, 비밀)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">공개키: Q = d × G (타원곡선 위의 점, 공개)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>개인키에서 공개키를 계산하는 것은 쉽지만(순방향), 공개키에서 개인키를 역산하는 것은 <strong>타원곡선 이산 로그 문제(ECDLP)</strong>로 인해 사실상 불가능하다.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2단계-서명-생성">2단계: 서명 생성<a href="#2단계-서명-생성" class="hash-link" aria-label="Direct link to 2단계: 서명 생성" title="Direct link to 2단계: 서명 생성">​</a></h3><p>메시지 m에 대한 서명을 생성하는 과정을 단계별로 살펴보자.</p><p><strong>1. 메시지 해시: z = hash(m)</strong></p><p>메시지를 해시 함수(SHA-256 등)로 처리하여 고정 길이 정수로 변환한다.</p><ul><li>해시를 하는 이유: 메시지 길이가 가변적이므로, 항상 같은 크기의 정수로 변환해야 한다.</li><li>해시 함수의 일방향성 덕분에, 해시값만으로는 원본 메시지를 복원할 수 없다.</li></ul><p><strong>2. 랜덤 nonce 선택: k</strong></p><p>1부터 n-1 사이의 랜덤 정수 k를 선택한다. 이 k를 <strong>nonce(number used once)</strong>라고 부른다.</p><ul><li>nonce가 필요한 이유: 같은 메시지에 대해 매번 다른 서명을 생성하기 위해서다.</li><li>같은 서명을 재사용하면 보안 문제가 발생할 수 있기 때문에 nonce는 매번 달라져야 한다.</li></ul><p><strong>3. 점 계산: R = k × G</strong></p><p>nonce k와 생성점 G를 곱하여 곡선 위의 점 R을 계산한다.</p><ul><li>이전 글에서 배운 스칼라 곱셈을 사용한다.</li><li>R은 곡선 위의 점이므로 (x, y) 좌표를 가진다.</li></ul><p><strong>4. r 값 계산: r = R의 x좌표 mod n</strong></p><p>점 R의 x좌표를 곡선의 위수 n으로 나눈 나머지를 r로 사용한다.</p><ul><li>x 좌표만 사용하는 이유: R은 곡선 위의 점이지만, 서명에선 그중 x좌표만 r로 사용한다. y좌표는 x축 대칭 때문에 두 후보가 있어 모호하므로, 필요할 때는 v(recovery id)로 어느 쪽인지 구분한다.</li><li>mod n을 하는 이유: ECDSA의 모든 계산은 생성점의 위수 n 위에서 이루어진다. r과 s가 0~n-1 범위에 있도록 맞추고, 검증 수식과 일관되게 만들기 위해 mod n을 적용한다.</li></ul><p><strong>5. s 값 계산: s = k⁻¹ × (z + r × d) mod n</strong></p><p>이것이 ECDSA의 핵심 공식이다. 각 요소의 의미를 하나씩 풀어보자.</p><ul><li><strong>k⁻¹</strong>: k의 모듈러 역원 (k × k⁻¹ ≡ 1 mod n)</li><li><strong>z</strong>: 메시지 해시값</li><li><strong>r</strong>: 위에서 계산한 값</li><li><strong>d</strong>: 개인키</li></ul><p>이 공식의 목적은 <strong>개인키 d를 직접 노출하지 않으면서도, d를 알고 있다는 사실을 증명</strong>하는 것이다.</p><ol><li><p><strong>z + r × d</strong>: 메시지 해시값(z)과 개인키(d)를 결합한다.</p><ul><li>이 값만으로는 d를 역산할 수 없다 (r도 모르고, z는 해시값이므로).</li><li>하지만 d를 알고 있어야 이 값을 계산할 수 있다.</li></ul></li><li><p><strong>k⁻¹ × (...)</strong>: nonce k의 역원을 곱한다.</p><ul><li>이것은 검증 과정에서 k를 복원하기 위한 장치다.</li><li>k⁻¹을 곱하면, 검증 시 s × k를 계산하여 원래의 (z + r × d)를 복원할 수 있다.</li></ul></li><li><p><strong>최종 결과 s</strong>:</p><ul><li>s를 계산하려면 개인키 d가 필요하다.</li><li>하지만 s만으로는 d를 역산할 수 없다 (이산 로그 문제).</li><li>검증자는 나중에 이 s 값을 이용해 서명의 유효성을 확인할 수 있다.</li></ul></li></ol><p>최종 서명은 (r, s) 쌍이다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">서명 = (r, s)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">- r: 랜덤 점 R의 x좌표 (32바이트)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">- s: 개인키를 사용한 증명값 (32바이트)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3단계-서명-검증">3단계: 서명 검증<a href="#3단계-서명-검증" class="hash-link" aria-label="Direct link to 3단계: 서명 검증" title="Direct link to 3단계: 서명 검증">​</a></h3><p>서명 (r, s)와 공개키 Q, 메시지 m이 주어졌을 때, <strong>개인키를 모르는 검증자</strong>가 서명의 유효성을 확인하는 과정이다.
핵심은 “서명할 때 만들어진 점 R을 간접적으로 다시 만들어서, r과 맞는지 확인”하는 것이다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">서명 생성 시: s = k⁻¹ × (z + r × d) mod n</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>여기서 k와 d는 숨겨져 있지만, s와 r, 공개키 Q는 공개되어 있다.</p><ol><li><p><strong>메시지 해시</strong>: z = hash(m).</p><ul><li>서명 생성 때와 같은 해시 함수를 사용한다.</li></ul></li><li><p><strong>s의 역원 계산</strong>: s⁻¹ mod n.</p><ul><li>s에 곱하면 원래 값으로 되돌리는 값이다.</li></ul></li><li><p><strong>중간값 계산</strong>: u₁ = z × s⁻¹ mod n, u₂ = r × s⁻¹ mod n.</p><ul><li>u₁은 메시지 해시 쪽의 비율, u₂는 공개키 쪽의 비율이다.</li><li>이 비율로 두 항을 섞으면, 서명 때와 같은 점이 다시 나온다.</li></ul></li><li><p><strong>점 복원</strong>: R&#x27; = u₁ × G + u₂ × Q.</p><ul><li>G는 기준점, Q는 공개키다.</li><li>두 점을 가중치(u₁, u₂)로 섞어 R&#x27;을 만든다.</li></ul></li><li><p><strong>검증</strong>: R&#x27;의 x좌표가 r과 같으면 유효한 서명이다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">검증 성공 조건: R&#x27;.x ≡ r (mod n)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>r은 k로 만든 R의 x좌표이지만, s에는 d가 섞여 있다.</li><li>검증 과정은 s와 Q를 이용해 “서명자가 만든 R”을 다시 만들고, 그 x좌표가 r과 같은지 확인한다.</li></ul></li></ol><p>검증자는 개인키 d를 몰라도 공개키 Q만으로 r과 맞는지 확인할 수 있다.
이때 s 안에는 d가 섞여 있고, Q 역시 d로 만든 값이므로 둘이 서로 맞아야만 R&#x27;이 제대로 복원된다.
즉, r은 k에서 나왔지만, s와 Q가 같은 d를 공유하지 않으면 r과 일치하는 R&#x27;이 나오지 않는다.
따라서 서명이 유효하려면, 서명 생성 시 사용한 개인키 d로 만든 공개키 Q여야 한다.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="비트코인-vs-이더리움">비트코인 vs 이더리움<a href="#비트코인-vs-이더리움" class="hash-link" aria-label="Direct link to 비트코인 vs 이더리움" title="Direct link to 비트코인 vs 이더리움">​</a></h2><p>비트코인과 이더리움은 모두 secp256k1 곡선과 ECDSA를 사용한다. 하지만 세부 구현에서 중요한 차이가 있다.</p><p><strong>공통점</strong></p><table><thead><tr><th>항목</th><th>비트코인</th><th>이더리움</th></tr></thead><tbody><tr><td>타원곡선</td><td>secp256k1</td><td>secp256k1</td></tr><tr><td>서명 알고리즘</td><td>ECDSA</td><td>ECDSA</td></tr><tr><td>개인키 크기</td><td>256비트</td><td>256비트</td></tr><tr><td>공개키 크기</td><td>512비트 (비압축)</td><td>512비트 (비압축)</td></tr></tbody></table><p>동일한 개인키로 비트코인과 이더리움 주소를 모두 생성할 수 있다. 실제로 많은 하드웨어 지갑이 이 방식을 사용한다.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="주소-생성-방식">주소 생성 방식<a href="#주소-생성-방식" class="hash-link" aria-label="Direct link to 주소 생성 방식" title="Direct link to 주소 생성 방식">​</a></h3><p><strong>비트코인 주소 생성</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">공개키 → SHA256 → RIPEMD160 → Base58Check 인코딩</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li>공개키를 SHA256으로 해시</li><li>결과를 RIPEMD160으로 다시 해시 (160비트 = 20바이트)</li><li>버전 바이트 추가 (0x00 for mainnet)</li><li>체크섬 추가 (더블 SHA256의 첫 4바이트)</li><li>Base58Check로 인코딩</li></ol><p>결과: <code>1BvBMSEYstWetqTFn5Au4m4GFg7xJaNVN2</code></p><p><strong>이더리움 주소 생성:</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">공개키 → Keccak256 → 마지막 20바이트 → Hex 인코딩</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li>비압축 공개키(64바이트, 접두사 0x04 제외)를 Keccak256으로 해시</li><li>해시 결과의 마지막 20바이트를 주소로 사용</li><li>0x 접두사와 함께 16진수로 표현</li></ol><p>결과: <code>0x71C7656EC7ab88b098defB751B7401B5f6d8976F</code></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="서명-형식">서명 형식<a href="#서명-형식" class="hash-link" aria-label="Direct link to 서명 형식" title="Direct link to 서명 형식">​</a></h3><p><strong>비트코인: DER 인코딩</strong></p><p>비트코인은 서명을 DER(Distinguished Encoding Rules) 형식으로 인코딩한다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">30 &lt;총 길이&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  02 &lt;r 길이&gt; &lt;r 값&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  02 &lt;s 길이&gt; &lt;s 값&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>DER 인코딩의 특징</p><ul><li>가변 길이 (70~72 바이트)</li><li>r과 s 앞에 0x00 패딩이 필요할 수 있음 (음수로 해석되지 않도록)</li><li>구조화된 형식으로 파싱이 명확함</li></ul><p><strong>이더리움: r, s, v 분리</strong></p><p>이더리움은 서명을 세 개의 값으로 분리해 저장한다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">r: 32바이트 (빅엔디안)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">s: 32바이트 (빅엔디안)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">v: 1바이트 (recovery id + chain id)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>이더리움 서명의 특징</p><ul><li>고정 길이 (65바이트)</li><li>v 값으로 공개키 복구 가능 (ecrecover)</li><li>EIP-155 이후 chain id가 v에 포함되어 리플레이 공격 방지</li></ul><p><strong>v 값의 의미</strong></p><p>이더리움의 v 값은 recovery id에 추가 정보가 더해진 값이다.</p><p><strong>기본 recovery id (0 또는 1)</strong></p><p>ECDSA 서명에서 r 값은 점 R의 x좌표다. 하지만 <strong>r 값만으로는 원래 점 R을 유일하게 결정할 수 없다.</strong>
이전 글 <a href="/blockchain/cryptography/elliptic-curve-cryptography">타원곡선 암호학</a>에서 보았듯이, 타원곡선은 <strong>x축 대칭</strong>이다. 방정식이 y² 형태이기 때문에, 같은 x좌표에 대해 두 개의 y좌표(+y, -y)가 존재할 수 있다.</p><ul><li>r = 5라면, 점 R은 (5, y₁) 또는 (5, -y₁) 중 하나일 수 있다.</li><li>두 점 모두 곡선 위에 있고, x좌표는 같지만 y좌표는 다르다.</li></ul><p><strong>recovery id의 역할</strong></p><p>recovery id는 이 두 후보 중 어떤 점인지 구분하는 역할을 한다.</p><ul><li>recovery id = 0: y좌표가 짝수인 점</li><li>recovery id = 1: y좌표가 홀수인 점</li></ul><p>이 정보가 있으면 r 값과 함께 원래 점 R을 유일하게 복원할 수 있다. 이것이 이더리움의 <code>ecrecover</code> 함수가 공개키를 복구할 수 있는 이유다.</p><p><strong>EIP-155 이전 (v = 27 또는 28)</strong></p><p>초기 이더리움은 recovery id에 27을 더해서 v 값으로 사용했다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">v = recovery_id + 27</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>EIP-155 이후 (chain id 포함)</strong></p><p>리플레이 공격을 방지하기 위해 chain id가 v에 포함되었다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">v = recovery_id + 35 + (chain_id × 2)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">예시 (이더리움 메인넷, chain_id = 1):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">v = 0 + 35 + 2 = 37 또는</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">v = 1 + 35 + 2 = 38</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>이를 통해 이더리움 메인넷에서 생성된 서명이 다른 체인(BSC, Polygon 등)에서 유효하지 않게 된다.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="서명-알고리즘-비교-ecdsa-vs-schnorr-vs-eddsa">서명 알고리즘 비교: ECDSA vs Schnorr vs EdDSA<a href="#서명-알고리즘-비교-ecdsa-vs-schnorr-vs-eddsa" class="hash-link" aria-label="Direct link to 서명 알고리즘 비교: ECDSA vs Schnorr vs EdDSA" title="Direct link to 서명 알고리즘 비교: ECDSA vs Schnorr vs EdDSA">​</a></h2><p>블록체인에서 사용되는 디지털 서명 알고리즘은 ECDSA만 있는 것이 아니다. 각 알고리즘의 특성을 비교해보자.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ecdsa">ECDSA<a href="#ecdsa" class="hash-link" aria-label="Direct link to ECDSA" title="Direct link to ECDSA">​</a></h3><p>현재 비트코인과 이더리움의 표준 서명 알고리즘이다.</p><p><strong>서명 공식</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">s = k⁻¹ × (z + r × d) mod n</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>1992년에 제안된 성숙한 알고리즘</li><li>광범위한 구현과 검증 이력</li><li>서명 생성에 모듈러 역원(k⁻¹) 계산 필요</li><li>비선형 구조로 인해 서명 집계가 불가능</li></ul><p><strong>비선형 구조란?</strong></p><p>ECDSA 서명 공식 <code>s = k⁻¹ × (z + r × d)</code>를 보면, k⁻¹(역원)과 곱셈이 포함되어 있다.</p><ul><li>두 서명 (r₁, s₁)과 (r₂, s₂)를 단순히 더하거나 곱해서 새로운 유효한 서명을 만들 수 없다.</li><li>각 서명은 독립적으로 생성되어야 한다.</li><li>MPC(Multi-Party Computation) 적용 시 복잡한 프로토콜이 필요하다.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="schnorr-서명">Schnorr 서명<a href="#schnorr-서명" class="hash-link" aria-label="Direct link to Schnorr 서명" title="Direct link to Schnorr 서명">​</a></h3><p>비트코인 Taproot 업그레이드(2021)로 도입된 서명 알고리즘이다.</p><p><strong>서명 공식</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">s = k + e × d (mod n)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">여기서 e = hash(R || P || m)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>ECDSA보다 단순한 수학적 구조</li><li>선형성(Linearity)으로 서명 집계 가능</li><li>MuSig 프로토콜로 다중 서명 효율화</li><li>배치 검증으로 여러 서명을 한 번에 빠르게 검증</li></ul><p><strong>선형성의 의미</strong></p><p>선형성은 수학에서 매우 중요한 성질이다. 함수 f가 선형이면 <code>f(a + b) = f(a) + f(b)</code>를 만족한다.</p><p>Schnorr 서명 공식 <code>s = k + e × d</code>는 완전히 선형이다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">서명1: s₁ = k₁ + e × d₁</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">서명2: s₂ = k₂ + e × d₂</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">합산: s = s₁ + s₂ = (k₁ + k₂) + e × (d₁ + d₂)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>이렇게 합산된 서명은 합산된 공개키(P₁ + P₂)에 대해 유효한 단일 서명이 된다.</p><p><strong>왜 선형성이 중요한가?</strong></p><ul><li><strong>서명 집계</strong>: 여러 서명자의 서명을 하나로 합칠 수 있다.</li><li><strong>배치 검증</strong>: 여러 서명을 한 번에 빠르게 검증할 수 있다.</li><li><strong>MPC 친화적</strong>: 각 참여자가 부분 서명을 생성하고 단순히 합산하면 되어, ECDSA에 비해 MPC 적용이 훨씬 간단하다.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="eddsa-ed25519">EdDSA (Ed25519)<a href="#eddsa-ed25519" class="hash-link" aria-label="Direct link to EdDSA (Ed25519)" title="Direct link to EdDSA (Ed25519)">​</a></h3><p>Curve25519 곡선을 사용하는 서명 알고리즘으로, Solana, Cardano, Polkadot 등이 채택했다.</p><ul><li><strong>결정론적 nonce</strong>: 랜덤 생성 대신 메시지와 개인키로 nonce를 유도하여 nonce 재사용 취약점을 원천 차단</li><li><strong>빠른 속도</strong>: 최적화된 구현으로 ECDSA보다 빠름</li><li><strong>작은 서명 크기</strong>: 64바이트</li><li><strong>배치 검증 지원</strong>: 여러 서명을 동시에 빠르게 검증</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="코드로-보는-ecdsa">코드로 보는 ECDSA<a href="#코드로-보는-ecdsa" class="hash-link" aria-label="Direct link to 코드로 보는 ECDSA" title="Direct link to 코드로 보는 ECDSA">​</a></h2><p>ethers.js를 사용해 서명 생성, 검증, r/s/v 값 테스트를 해보자.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockTitle_Ktv7">ecdsa.ts</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> ethers </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ethers&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> privateKey </span><span class="token operator">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0x4c0883a69102937d6231471b5dbb6204fe5129617082792ae468d01a3f362318&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> wallet </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">ethers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Wallet</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">privateKey</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> message </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Hello, ECDSA!&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">async</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">run</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;=== 키 정보 ===&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;개인키:&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> wallet</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">privateKey</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;공개키:&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> wallet</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">signingKey</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">publicKey</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;주소:&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> wallet</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">address</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;\n=== 서명 생성 ===&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;메시지:&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> message</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> signature </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">await</span><span class="token plain"> wallet</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">signMessage</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">message</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;서명:&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> signature</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;\n=== 서명 검증 ===&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> recoveredAddress </span><span class="token operator">=</span><span class="token plain"> ethers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">verifyMessage</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">message</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> signature</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;복구된 주소:&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> recoveredAddress</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;원본 주소:&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> wallet</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">address</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;검증 성공:&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> recoveredAddress </span><span class="token operator">===</span><span class="token plain"> wallet</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">address</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;\n=== r, s, v 분석 ===&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;전체 서명 (65 bytes):&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> signature</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;서명 길이:&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> ethers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">getBytes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">signature</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">length</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;bytes&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> sig </span><span class="token operator">=</span><span class="token plain"> ethers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Signature</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">from</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">signature</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;r (32 bytes):&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> sig</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">r</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;s (32 bytes):&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> sig</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;v (recovery id):&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> sig</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">v</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;\n=== v 값 해석 ===&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">sig</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">v </span><span class="token operator">===</span><span class="token plain"> </span><span class="token number">27</span><span class="token plain"> </span><span class="token operator">||</span><span class="token plain"> sig</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">v </span><span class="token operator">===</span><span class="token plain"> </span><span class="token number">28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;EIP-155 이전 형식 (legacy)&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;recovery id:&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> sig</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">v </span><span class="token operator">-</span><span class="token plain"> </span><span class="token number">27</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> recoveryId </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">sig</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">v </span><span class="token operator">-</span><span class="token plain"> </span><span class="token number">35</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">%</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> chainId </span><span class="token operator">=</span><span class="token plain"> Math</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">floor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">sig</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">v </span><span class="token operator">-</span><span class="token plain"> </span><span class="token number">35</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">/</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;EIP-155 형식&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;recovery id:&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> recoveryId</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;chain id:&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> chainId</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;\n=== 공개키 복구 ===&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> messageHash </span><span class="token operator">=</span><span class="token plain"> ethers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">hashMessage</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">message</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> recoveredPublicKey </span><span class="token operator">=</span><span class="token plain"> ethers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">SigningKey</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">recoverPublicKey</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    messageHash</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    signature</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;복구된 공개키:&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> recoveredPublicKey</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;원본 공개키:&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> wallet</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">signingKey</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">publicKey</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;일치 여부:&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> recoveredPublicKey </span><span class="token operator">===</span><span class="token plain"> wallet</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">signingKey</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">publicKey</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">run</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>위 코드를 실행하면 다음과 같은 결과를 확인할 수 있다.</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">==</span><span class="token operator">=</span><span class="token plain"> 키 정보 </span><span class="token operator">==</span><span class="token operator">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">개인키: 0x4c0883a69102937d6231471b5dbb6204fe5129617082792ae468d01a3f362318</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">공개키: 0x04b9d7ea8c</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">주소: 0x2c7536E3605D9C16a7a3D7b1898e529396a65c23</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">==</span><span class="token operator">=</span><span class="token plain"> 서명 생성 </span><span class="token operator">==</span><span class="token operator">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">메시지: Hello, ECDSA</span><span class="token operator">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">서명: 0xfdaf07b43e6119f3a15c6edd90b11ae7991a083d36ba26e430d698ed0e72c06865405f56d3a9452ad020500150c4bf1bef71f683cbcc20501d65b39fad5e9c4a1c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">==</span><span class="token operator">=</span><span class="token plain"> 서명 검증 </span><span class="token operator">==</span><span class="token operator">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">복구된 주소: 0x2c7536E3605D9C16a7a3D7b1898e529396a65c23</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">원본 주소: 0x2c7536E3605D9C16a7a3D7b1898e529396a65c23</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">검증 성공: </span><span class="token boolean">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">==</span><span class="token operator">=</span><span class="token plain"> r, s, </span><span class="token function" style="color:rgb(80, 250, 123)">v</span><span class="token plain"> 분석 </span><span class="token operator">==</span><span class="token operator">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">전체 서명 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">65</span><span class="token plain"> bytes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">: 0xfdaf07b43e6119f3a15c6edd90b11ae7991a083d36ba26e430d698ed0e72c06865405f56d3a9452ad020500150c4bf1bef71f683cbcc20501d65b39fad5e9c4a1c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">서명 길이: </span><span class="token number">65</span><span class="token plain"> bytes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">r </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">32</span><span class="token plain"> bytes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">: 0xfdaf07b43e6119f3a15c6edd90b11ae7991a083d36ba26e430d698ed0e72c068</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">s </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">32</span><span class="token plain"> bytes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">: 0x65405f56d3a9452ad020500150c4bf1bef71f683cbcc20501d65b39fad5e9c4a</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">v</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">recovery </span><span class="token function" style="color:rgb(80, 250, 123)">id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">: </span><span class="token number">28</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">==</span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">v</span><span class="token plain"> 값 해석 </span><span class="token operator">==</span><span class="token operator">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">EIP-155 이전 형식 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">legacy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">recovery id: </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">==</span><span class="token operator">=</span><span class="token plain"> 공개키 복구 </span><span class="token operator">==</span><span class="token operator">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">복구된 공개키: 0x044e3b81af9c2234cad09d679ce6035ed1392347ce64ce405f5dcd36228a25de6e47fd35c4215d1edf53e6f83de344615ce719bdb0fd878f6ed76f06dd277956de</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">원본 공개키: 0x044e3b81af9c2234cad09d679ce6035ed1392347ce64ce405f5dcd36228a25de6e47fd35c4215d1edf53e6f83de344615ce719bdb0fd878f6ed76f06dd277956de</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">일치 여부: </span><span class="token boolean">true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>같은 메시지라도 서명을 다시 생성하면 값이 달라질 수 있다. 이는 nonce(k)가 매번 달라지기 때문이다.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="보안-고려사항">보안 고려사항<a href="#보안-고려사항" class="hash-link" aria-label="Direct link to 보안 고려사항" title="Direct link to 보안 고려사항">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="nonce-재사용">nonce 재사용<a href="#nonce-재사용" class="hash-link" aria-label="Direct link to nonce 재사용" title="Direct link to nonce 재사용">​</a></h3><p>ECDSA에서 가장 치명적인 취약점은 nonce(k) 재사용이다. 같은 nonce로 두 개의 다른 메시지에 서명하면 개인키가 노출된다.</p><p><strong>nonce 재사용이 위험한 이유</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">s = k⁻¹ × (z + r × d) mod n</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>여기서 k는 랜덤 nonce이고, d는 개인키다. 만약 같은 k를 두 번 사용하면:</p><p><strong>첫 번째 메시지 m₁에 대한 서명</strong></p><ul><li>z₁ = hash(m₁)</li><li>r₁ = (k × G).x mod n</li><li>s₁ = k⁻¹ × (z₁ + r₁ × d) mod n</li></ul><p><strong>두 번째 메시지 m₂에 대한 서명 (같은 k 사용)</strong></p><ul><li>z₂ = hash(m₂)</li><li>r₂ = (k × G).x mod n = r₁ (같은 k이므로 같은 점 R)</li><li>s₂ = k⁻¹ × (z₂ + r₂ × d) mod n</li></ul><p><strong>개인키 추출 과정</strong></p><p>공격자는 공개된 서명 (r₁, s₁)과 (r₂, s₂)를 관찰할 수 있다. r₁ = r₂ = r임을 알 수 있다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">s₁ = k⁻¹(z₁ + rd) mod n</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">s₂ = k⁻¹(z₂ + rd) mod n</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">s₁ - s₂ = k⁻¹(z₁ - z₂) mod n</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">k = (z₁ - z₂)(s₁ - s₂)⁻¹ mod n</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>nonce k를 알아내면, 이제 개인키 d를 계산할 수 있다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">s₁ = k⁻¹(z₁ + rd) mod n</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">s₁ × k = z₁ + rd mod n</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rd = s₁ × k - z₁ mod n</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">d = r⁻¹(s₁ × k - z₁) mod n</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>사례: Sony PlayStation 3 해킹 (2010)</strong></p><p>Sony는 PS3의 소프트웨어 서명에 ECDSA를 사용했는데, 모든 서명에 동일한 nonce를 사용하는 실수를 저질렀다. 해커들은 이를 통해 Sony의 개인키를 추출하여 임의의 소프트웨어에 서명할 수 있게 되었다.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="불충분한-랜덤성">불충분한 랜덤성<a href="#불충분한-랜덤성" class="hash-link" aria-label="Direct link to 불충분한 랜덤성" title="Direct link to 불충분한 랜덤성">​</a></h3><p>nonce가 완전히 랜덤하지 않아도 취약할 수 있다.</p><ul><li>예측 가능한 난수 생성기 사용</li><li>타임스탬프나 순차적 값을 nonce로 사용</li><li>엔트로피가 부족한 환경에서 생성</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="rfc-6979-결정론적-nonce">RFC 6979: 결정론적 nonce<a href="#rfc-6979-결정론적-nonce" class="hash-link" aria-label="Direct link to RFC 6979: 결정론적 nonce" title="Direct link to RFC 6979: 결정론적 nonce">​</a></h3><p>이러한 문제를 해결하기 위해 RFC 6979는 결정론적 nonce 생성 방법을 제안한다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">k = HMAC(private_key, hash(message))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>같은 메시지에는 같은 nonce가 생성되어, 재서명해도 동일한 서명 생성</li><li>개인키와 메시지가 달라지면 nonce도 달라짐</li><li>랜덤 소스 없이도 안전한 nonce 생성</li></ul><p>대부분의 현대 라이브러리(ethers.js 포함)는 RFC 6979를 기본으로 사용한다.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="정리">정리<a href="#정리" class="hash-link" aria-label="Direct link to 정리" title="Direct link to 정리">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="요약">요약<a href="#요약" class="hash-link" aria-label="Direct link to 요약" title="Direct link to 요약">​</a></h3><ul><li><strong>ECDSA</strong>는 타원곡선의 이산 로그 문제에 기반한 디지털 서명 알고리즘이다.</li><li><strong>서명 과정</strong>: 개인키와 랜덤 nonce로 (r, s) 값을 생성</li><li><strong>검증 과정</strong>: 공개키만으로 서명의 유효성 확인 가능</li><li><strong>비트코인 vs 이더리움</strong>: 같은 secp256k1 곡선을 사용하지만 주소 생성, 서명 형식, 해시 방식이 다름</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ecdsa의-한계">ECDSA의 한계<a href="#ecdsa의-한계" class="hash-link" aria-label="Direct link to ECDSA의 한계" title="Direct link to ECDSA의 한계">​</a></h3><ol><li><strong>비선형 구조</strong>: 서명 집계나 MPC 적용이 Schnorr에 비해 복잡함</li><li><strong>양자 컴퓨팅 위협</strong>: Shor 알고리즘으로 이산 로그 문제 해결 가능 (이론적)</li><li><strong>대안의 등장</strong>: Schnorr (Bitcoin Taproot), EdDSA (Solana, Cardano)</li></ol><p>블록체인 생태계는 점진적으로 더 효율적이고 안전한 서명 알고리즘으로 전환하고 있다. 이더리움은 Account Abstraction(ERC-4337)을 통해 계정 수준에서 서명 알고리즘을 추상화하는 방향으로 발전하고 있다.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="참고-자료">참고 자료<a href="#참고-자료" class="hash-link" aria-label="Direct link to 참고 자료" title="Direct link to 참고 자료">​</a></h3><ul><li><a href="https://www.dynamic.xyz/blog/understanding-elliptic-curve-cryptography-and-digital-signatures-in-blockchain" target="_blank" rel="noopener noreferrer">Understanding Elliptic Curve Cryptography - Dynamic.xyz</a></li><li><a href="https://www.cyfrin.io/blog/elliptic-curve-digital-signature-algorithm-and-signatures" target="_blank" rel="noopener noreferrer">ECDSA Explained - Cyfrin</a></li><li><a href="https://avidthinker.github.io/2025/11/28/understanding-ecdsa/" target="_blank" rel="noopener noreferrer">Understanding ECDSA - Web3 Security Blog</a></li><li><a href="https://dev.to/truongpx396/understanding-ethereum-ecdsa-eip-712-and-its-role-in-permit-functionality-26ll" target="_blank" rel="noopener noreferrer">Ethereum ECDSA and EIP-712 - DEV Community</a></li><li><a href="https://github.com/bitcoin/bips/blob/master/bip-0340.mediawiki" target="_blank" rel="noopener noreferrer">BIP-340: Schnorr Signatures for secp256k1</a></li><li><a href="https://eprint.iacr.org/2020/540.pdf" target="_blank" rel="noopener noreferrer">Threshold ECDSA from GG20</a></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/cryptography">Cryptography</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/blockchain">Blockchain</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/ethereum">Ethereum</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/bitcoin">Bitcoin</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blockchain/cryptography/elliptic-curve-cryptography"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Elliptic Curve Cryptography</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blockchain/cryptography/shamir-secret-sharing"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Shamir&#x27;s Secret Sharing (SSS)</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#왜-디지털-서명이-필요한가" class="table-of-contents__link toc-highlight">왜 디지털 서명이 필요한가</a></li><li><a href="#사전-지식-타원곡선-암호학" class="table-of-contents__link toc-highlight">사전 지식: 타원곡선 암호학</a><ul><li><a href="#ecdsa에-필요한-핵심-개념" class="table-of-contents__link toc-highlight">ECDSA에 필요한 핵심 개념</a></li></ul></li><li><a href="#ecdsa-동작-원리" class="table-of-contents__link toc-highlight">ECDSA 동작 원리</a><ul><li><a href="#1단계-키-생성" class="table-of-contents__link toc-highlight">1단계: 키 생성</a></li><li><a href="#2단계-서명-생성" class="table-of-contents__link toc-highlight">2단계: 서명 생성</a></li><li><a href="#3단계-서명-검증" class="table-of-contents__link toc-highlight">3단계: 서명 검증</a></li></ul></li><li><a href="#비트코인-vs-이더리움" class="table-of-contents__link toc-highlight">비트코인 vs 이더리움</a><ul><li><a href="#주소-생성-방식" class="table-of-contents__link toc-highlight">주소 생성 방식</a></li><li><a href="#서명-형식" class="table-of-contents__link toc-highlight">서명 형식</a></li></ul></li><li><a href="#서명-알고리즘-비교-ecdsa-vs-schnorr-vs-eddsa" class="table-of-contents__link toc-highlight">서명 알고리즘 비교: ECDSA vs Schnorr vs EdDSA</a><ul><li><a href="#ecdsa" class="table-of-contents__link toc-highlight">ECDSA</a></li><li><a href="#schnorr-서명" class="table-of-contents__link toc-highlight">Schnorr 서명</a></li><li><a href="#eddsa-ed25519" class="table-of-contents__link toc-highlight">EdDSA (Ed25519)</a></li></ul></li><li><a href="#코드로-보는-ecdsa" class="table-of-contents__link toc-highlight">코드로 보는 ECDSA</a></li><li><a href="#보안-고려사항" class="table-of-contents__link toc-highlight">보안 고려사항</a><ul><li><a href="#nonce-재사용" class="table-of-contents__link toc-highlight">nonce 재사용</a></li><li><a href="#불충분한-랜덤성" class="table-of-contents__link toc-highlight">불충분한 랜덤성</a></li><li><a href="#rfc-6979-결정론적-nonce" class="table-of-contents__link toc-highlight">RFC 6979: 결정론적 nonce</a></li></ul></li><li><a href="#정리" class="table-of-contents__link toc-highlight">정리</a><ul><li><a href="#요약" class="table-of-contents__link toc-highlight">요약</a></li><li><a href="#ecdsa의-한계" class="table-of-contents__link toc-highlight">ECDSA의 한계</a></li><li><a href="#참고-자료" class="table-of-contents__link toc-highlight">참고 자료</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.ababe4bb.js"></script>
<script src="/assets/js/main.01b4c91d.js"></script>
</body>
</html>