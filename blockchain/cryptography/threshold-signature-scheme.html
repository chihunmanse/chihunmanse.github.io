<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-blockchain/cryptography/threshold-signature-scheme">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Threshold Signature Scheme (TSS) | Chihun&#x27;s Dev Blog</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://chihunmanse.github.io/img/m.png"><meta data-rh="true" name="twitter:image" content="https://chihunmanse.github.io/img/m.png"><meta data-rh="true" property="og:url" content="https://chihunmanse.github.io/blockchain/cryptography/threshold-signature-scheme"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Threshold Signature Scheme (TSS) | Chihun&#x27;s Dev Blog"><meta data-rh="true" name="description" content="A distributed multi-party computation approach for secure digital signatures without single points of failure"><meta data-rh="true" property="og:description" content="A distributed multi-party computation approach for secure digital signatures without single points of failure"><meta data-rh="true" name="keywords" content="TSS,threshold signature,MPC,distributed key generation,DKG,ECDSA,Cait-Sith,Beaver Triple,blockchain,wallet"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://chihunmanse.github.io/blockchain/cryptography/threshold-signature-scheme"><link data-rh="true" rel="alternate" href="https://chihunmanse.github.io/blockchain/cryptography/threshold-signature-scheme" hreflang="en"><link data-rh="true" rel="alternate" href="https://chihunmanse.github.io/blockchain/cryptography/threshold-signature-scheme" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.5b6de4da.css">
<link rel="preload" href="/assets/js/runtime~main.54cb9dbe.js" as="script">
<link rel="preload" href="/assets/js/main.3f3a3de7.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">Chihun&#x27;s Dev Blog</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/tags">Tags</a><a href="https://github.com/chihunmanse" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><b>Chihun&#x27;s Dev Blog</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Home</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/datastructure-algorithm">DataStructure &amp; Algorithm</a><button aria-label="Toggle the collapsible sidebar category &#x27;DataStructure &amp; Algorithm&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/backend">Backend</a><button aria-label="Toggle the collapsible sidebar category &#x27;Backend&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/devops">DevOps</a><button aria-label="Toggle the collapsible sidebar category &#x27;DevOps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/blockchain">BlockChain</a><button aria-label="Toggle the collapsible sidebar category &#x27;BlockChain&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/blockchain/upgradeable-contract">Upgradeable Contract</a><button aria-label="Toggle the collapsible sidebar category &#x27;Upgradeable Contract&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blockchain/contract-error-handling">Contract Error Handling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blockchain/storage-layout">Solidity Storage Layout</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/blockchain/defi">DeFi</a><button aria-label="Toggle the collapsible sidebar category &#x27;DeFi&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/blockchain/cryptography">Cryptography</a><button aria-label="Toggle the collapsible sidebar category &#x27;Cryptography&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/blockchain/cryptography/hash-function">Hash Function</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/blockchain/cryptography/elliptic-curve-cryptography">Elliptic Curve Cryptography</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/blockchain/cryptography/ecdsa">ECDSA (Elliptic Curve Digital Signature Algorithm)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/blockchain/cryptography/shamir-secret-sharing">Shamir&#x27;s Secret Sharing (SSS)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/blockchain/cryptography/threshold-signature-scheme">Threshold Signature Scheme (TSS)</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/blockchain/how-ethereum-works">How Ethereum Works</a><button aria-label="Toggle the collapsible sidebar category &#x27;How Ethereum Works&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/blockchain"><span itemprop="name">BlockChain</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/blockchain/cryptography"><span itemprop="name">Cryptography</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Threshold Signature Scheme (TSS)</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Threshold Signature Scheme (TSS)</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="sss의-한계">SSS의 한계<a href="#sss의-한계" class="hash-link" aria-label="Direct link to SSS의 한계" title="Direct link to SSS의 한계">​</a></h2><p><a href="/blockchain/cryptography/shamir-secret-sharing">이전 글</a>에서 Shamir&#x27;s Secret Sharing(SSS)을 통해 비밀을 여러 조각으로 분산하여 보관하는 방법을 살펴보았다. SSS는 단일 실패 지점 문제를 해결하는 훌륭한 기법이지만, 실제 서명 과정에서는 근본적인 한계가 존재한다.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="생성과-복원-시점의-취약성">생성과 복원 시점의 취약성<a href="#생성과-복원-시점의-취약성" class="hash-link" aria-label="Direct link to 생성과 복원 시점의 취약성" title="Direct link to 생성과 복원 시점의 취약성">​</a></h3><p>SSS의 구조적 한계는 비밀의 생성과 복원 시점에서 드러난다.</p><ul><li><strong>생성 시점</strong>: 딜러(Dealer)가 전체 비밀을 알고 있는 상태에서 조각을 생성한다. 이 순간 딜러는 단일 실패 지점이 된다.</li><li><strong>복원 시점</strong>: 서명을 생성하려면 k개의 조각을 모아 비밀을 재조합해야 한다. 재조합이 이루어지는 장치나 환경에서 전체 비밀이 노출된다.</li></ul><p>결국 SSS는 보관의 문제를 해결할 뿐, 사용의 문제를 해결하지 못한다. 아무리 안전하게 분산 보관해도, 서명을 위해 비밀을 한 곳에 모으는 순간 공격 지점이 발생한다.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="sss-vs-tss">SSS vs TSS<a href="#sss-vs-tss" class="hash-link" aria-label="Direct link to SSS vs TSS" title="Direct link to SSS vs TSS">​</a></h3><table><thead><tr><th>특성</th><th>SSS</th><th>TSS</th></tr></thead><tbody><tr><td><strong>키 존재 여부</strong></td><td>생성 시와 서명 시 전체 키가 한 곳에 존재</td><td>전체 키가 절대로 한 곳에 존재하지 않음</td></tr><tr><td><strong>딜러 필요</strong></td><td>필요 (키를 분할하는 신뢰 기관)</td><td>불필요 (분산 키 생성)</td></tr><tr><td><strong>서명 방식</strong></td><td>키 재조합 후 서명</td><td>분산 서명 (키 재조합 없음)</td></tr><tr><td><strong>단일 실패 지점</strong></td><td>존재 (키 생성/서명 시)</td><td>없음</td></tr></tbody></table><p><strong>Threshold Signature Scheme(TSS)</strong>은 이 한계를 근본적으로 해결한다. TSS에서는 개인키가 생성되는 순간부터 서명이 완료되는 순간까지, 전체 개인키가 한 곳에 존재하는 시점이 없다. 각 참여자는 자신의 조각만을 이용해 부분 서명을 생성하고, 이 부분 서명들이 합쳐져 완전한 서명이 된다.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="t-n-threshold-구조">(t, n) Threshold 구조<a href="#t-n-threshold-구조" class="hash-link" aria-label="Direct link to (t, n) Threshold 구조" title="Direct link to (t, n) Threshold 구조">​</a></h3><p>TSS는 SSS와 마찬가지로 <strong>(t, n) 임계값 구조</strong>를 사용한다. n명의 참여자 중 t명 이상이 협력하면 서명을 생성할 수 있고, t명 미만으로는 서명이 불가능하다.</p><p>이것이 가능한 이유는 <strong>라그랑주 보간법</strong> 덕분이다. SSS에서 비밀을 복원할 때와 동일한 수학적 원리를 사용한다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">개인키 x는 t-1차 다항식 f(x)의 y절편: x = f(0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">각 참여자 i는 자신의 share xᵢ = f(i)를 보유</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">t명이 모이면:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">- 라그랑주 보간으로 f(0)을 직접 복원하지 않고</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">- 각자의 share를 이용해 &quot;부분 서명&quot;을 생성</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">- 부분 서명들을 라그랑주 계수로 가중합하여 최종 서명 생성</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>핵심은 <strong>개인키를 복원하지 않고도 서명을 생성</strong>할 수 있다는 점이다. 라그랑주 보간의 선형성을 활용하여, 각 참여자가 자신의 share로 계산한 부분 결과를 합치면 전체 개인키로 계산한 것과 동일한 결과를 얻는다.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="왜-threshold-ecdsa가-어려운가">왜 Threshold ECDSA가 어려운가?<a href="#왜-threshold-ecdsa가-어려운가" class="hash-link" aria-label="Direct link to 왜 Threshold ECDSA가 어려운가?" title="Direct link to 왜 Threshold ECDSA가 어려운가?">​</a></h2><p>TSS의 개념은 단순해 보이지만, 실제 구현은 사용하는 서명 알고리즘에 따라 난이도가 크게 달라진다. 특히 블록체인에서 널리 사용되는 ECDSA는 Threshold 환경에서 구현하기가 까다롭다.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ecdsa-서명-공식의-구조">ECDSA 서명 공식의 구조<a href="#ecdsa-서명-공식의-구조" class="hash-link" aria-label="Direct link to ECDSA 서명 공식의 구조" title="Direct link to ECDSA 서명 공식의 구조">​</a></h3><p><a href="/blockchain/cryptography/ecdsa">ECDSA</a>의 서명 생성 공식을 다시 살펴보자.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">s = k⁻¹ × (m + r × x) mod n</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table><thead><tr><th>기호</th><th>의미</th></tr></thead><tbody><tr><td><code>k</code></td><td>난수 (nonce)</td></tr><tr><td><code>m</code></td><td>메시지 해시</td></tr><tr><td><code>r</code></td><td>R = k × G의 x좌표</td></tr><tr><td><code>x</code></td><td>개인키</td></tr></tbody></table><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="핵심-문제-k--x-곱셈">핵심 문제: k × x 곱셈<a href="#핵심-문제-k--x-곱셈" class="hash-link" aria-label="Direct link to 핵심 문제: k × x 곱셈" title="Direct link to 핵심 문제: k × x 곱셈">​</a></h3><p>Threshold 환경에서 개인키 <code>x</code>와 난수 <code>k</code>는 모두 여러 참여자에게 분산되어 있다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">x = x₁ + x₂ + x₃  (각 참여자가 xᵢ 보유)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">k = k₁ + k₂ + k₃  (각 참여자가 kᵢ 보유)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>문제는 서명 공식에 <code>r × x</code> 항이 포함되어 있고, <code>k⁻¹</code>을 계산해야 한다는 점이다. <code>k × x</code>를 분산 환경에서 계산하려면 다음과 같은 전개가 필요하다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">k × x = (k₁ + k₂ + k₃) × (x₁ + x₂ + x₃)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      = k₁x₁ + k₁x₂ + k₁x₃ + k₂x₁ + k₂x₂ + k₂x₃ + k₃x₁ + k₃x₂ + k₃x₃</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>각 참여자는 자신의 <code>kᵢ</code>와 <code>xᵢ</code>만 알고 있다. <code>kᵢxᵢ</code>는 각자 계산할 수 있지만, 교차항인 <code>kᵢxⱼ</code> (i ≠ j)를 계산하려면 다른 참여자의 비밀값이 필요하다. 그렇다고 비밀값을 직접 공유하면 개인키를 복구할 수 있게 되어 보안이 무너진다.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="schnorr-서명과의-비교">Schnorr 서명과의 비교<a href="#schnorr-서명과의-비교" class="hash-link" aria-label="Direct link to Schnorr 서명과의 비교" title="Direct link to Schnorr 서명과의 비교">​</a></h3><p>Schnorr 서명의 공식은 다음과 같다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">s = k + e × x</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>덧셈과 스칼라 곱셈만으로 구성되어 있어 <strong>선형 구조</strong>를 가진다. 각 참여자가 <code>sᵢ = kᵢ + e × xᵢ</code>를 계산하면, 이를 모두 더해서 최종 서명을 얻을 수 있다. 교차항 문제가 발생하지 않는다.</p><p>반면 ECDSA는 <code>k⁻¹</code>과 <code>k × x</code>를 포함하는 <strong>비선형 구조</strong>이다. 이 비선형성 때문에 Threshold ECDSA는 Threshold Schnorr보다 훨씬 복잡한 암호학적 기법을 필요로 한다.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="주요-threshold-signature-프로토콜">주요 Threshold Signature 프로토콜<a href="#주요-threshold-signature-프로토콜" class="hash-link" aria-label="Direct link to 주요 Threshold Signature 프로토콜" title="Direct link to 주요 Threshold Signature 프로토콜">​</a></h2><p>Threshold 서명을 구현하기 위한 다양한 프로토콜이 연구되어 왔다. 각 프로토콜은 지원하는 서명 알고리즘, 비밀 곱셈 문제를 해결하는 방식, 통신 라운드 수, 보안 모델 등에서 차이가 있다.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="gg18gg20-gennaro-goldfeder">GG18/GG20 (Gennaro-Goldfeder)<a href="#gg18gg20-gennaro-goldfeder" class="hash-link" aria-label="Direct link to GG18/GG20 (Gennaro-Goldfeder)" title="Direct link to GG18/GG20 (Gennaro-Goldfeder)">​</a></h3><p>2018년과 2020년에 Gennaro와 Goldfeder가 발표한 프로토콜이다.</p><p><strong>GG18</strong>은 최초의 실용적인 Threshold ECDSA 프로토콜로 평가받는다. <strong>Paillier 동형암호</strong>를 기반으로 하며, <strong>MtA(Multiplicative-to-Additive)</strong> 프로토콜을 통해 비밀 곱셈 문제를 해결한다.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="paillier-동형암호">Paillier 동형암호<a href="#paillier-동형암호" class="hash-link" aria-label="Direct link to Paillier 동형암호" title="Direct link to Paillier 동형암호">​</a></h4><p><strong>동형암호(Homomorphic Encryption)</strong>는 암호화된 상태에서 연산을 수행할 수 있는 암호 시스템이다. 일반적인 암호화에서는 데이터를 사용하려면 먼저 복호화해야 하지만, 동형암호에서는 암호문에 직접 연산을 수행하고, 그 결과를 복호화하면 평문에 연산한 것과 동일한 결과를 얻는다.</p><p>1999년 Pascal Paillier가 제안한 Paillier 암호는 <strong>가산 동형성(Additive Homomorphism)</strong>을 가진다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Enc(m₁) × Enc(m₂) = Enc(m₁ + m₂)  // 암호문의 곱 = 평문 합의 암호화</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Enc(m)^x = Enc(m × x)              // 암호문의 거듭제곱 = 평문 스칼라곱의 암호화</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>이 성질을 활용하면 암호화된 상태에서 덧셈과 스칼라 곱셈을 수행할 수 있다. 예를 들어, Alice가 <code>Enc(a)</code>를 Bob에게 보내면, Bob은 자신의 비밀 <code>b</code>를 이용해 <code>Enc(a)^b = Enc(a × b)</code>를 계산할 수 있다. Bob은 <code>a</code>를 모르고, Alice는 <code>b</code>를 모르지만, 둘의 곱에 대한 암호문이 생성된다.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="mta-multiplicative-to-additive-프로토콜">MtA (Multiplicative-to-Additive) 프로토콜<a href="#mta-multiplicative-to-additive-프로토콜" class="hash-link" aria-label="Direct link to MtA (Multiplicative-to-Additive) 프로토콜" title="Direct link to MtA (Multiplicative-to-Additive) 프로토콜">​</a></h4><p>MtA는 &quot;곱셈 share를 덧셈 share로 변환&quot;하는 프로토콜이다. 두 당사자 Alice와 Bob이 각자 비밀 <code>a</code>, <code>b</code>를 가지고 있을 때, 최종적으로 <code>A + B = a × b</code>를 만족하는 값 <code>A</code>와 <code>B</code>를 각자 얻는다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Alice: a를 보유 → A를 획득</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Bob: b를 보유 → B를 획득</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">결과: A + B = a × b (mod q)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>이 과정에서 Alice는 <code>b</code>를 알지 못하고, Bob은 <code>a</code>를 알지 못한다. Paillier 암호의 동형 성질을 활용하여 이를 구현한다. Threshold ECDSA에서 <code>k × x</code> 곱셈을 분산 계산할 때 MtA가 핵심 역할을 한다.</p><p><strong>GG20</strong>은 GG18을 개선한 버전이다.</p><ul><li>서명 라운드 감소 (9 → 7라운드, 온라인 1라운드)</li><li><strong>Identifiable Abort</strong> 지원: 프로토콜 실패 시 악의적 참여자를 식별할 수 있다.</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="identifiable-abort">Identifiable Abort<a href="#identifiable-abort" class="hash-link" aria-label="Direct link to Identifiable Abort" title="Direct link to Identifiable Abort">​</a></h4><p>다자간 프로토콜에서 악의적인 참여자가 의도적으로 잘못된 값을 제출하여 프로토콜을 실패시킬 수 있다. <strong>Identifiable Abort</strong>는 이런 상황에서 &quot;누가 잘못했는지&quot; 식별할 수 있는 기능이다.</p><p>이 기능이 없으면 프로토콜이 실패해도 원인을 알 수 없어, 악의적 참여자가 반복적으로 방해할 수 있다. Identifiable Abort가 있으면 문제를 일으킨 참여자를 제외하고 재시도할 수 있다. 다만 이 기능을 추가하면 프로토콜 복잡도와 통신 비용이 증가한다.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cggmp21">CGGMP21<a href="#cggmp21" class="hash-link" aria-label="Direct link to CGGMP21" title="Direct link to CGGMP21">​</a></h3><p>2021년 Canetti, Gennaro, Goldfeder, Makriyannis, Peled가 발표한 프로토콜이다.</p><p>CGGMP21의 주요 특징은 다음과 같다.</p><ul><li>GG20과 CMP20을 결합하여 UC 프레임워크 하에서 보안을 증명했다.</li><li><strong>Pre-signing</strong> 기능을 제공하여 메시지가 확정되기 전에 대부분의 연산을 전처리할 수 있다.</li><li>4라운드 변형과 7라운드 변형이 존재한다.</li><li>Identifiable Abort를 지원한다.</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="universal-composability-uc-프레임워크">Universal Composability (UC) 프레임워크<a href="#universal-composability-uc-프레임워크" class="hash-link" aria-label="Direct link to Universal Composability (UC) 프레임워크" title="Direct link to Universal Composability (UC) 프레임워크">​</a></h4><p><strong>UC 프레임워크</strong>는 암호 프로토콜의 보안을 분석하는 이론적 모델이다. 핵심 아이디어는 &quot;이상적인 세계&quot;와 &quot;현실 세계&quot;를 비교하는 것이다.</p><ul><li><strong>이상적인 세계</strong>: 완벽하게 신뢰할 수 있는 제3자가 모든 계산을 대신 수행</li><li><strong>현실 세계</strong>: 실제 프로토콜이 참여자들 간의 통신으로 실행</li></ul><p>UC 보안이 증명되면, 현실 세계의 프로토콜이 이상적인 세계와 구분할 수 없을 정도로 안전하다는 것을 의미한다. 중요한 특성은 <strong>합성 가능성(Composability)</strong>이다. UC 보안이 증명된 프로토콜은 다른 프로토콜과 결합해도 보안이 유지된다. 복잡한 시스템에서 여러 암호 프로토콜을 함께 사용할 때 이 특성이 중요하다.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="frost">FROST<a href="#frost" class="hash-link" aria-label="Direct link to FROST" title="Direct link to FROST">​</a></h3><p><strong>Flexible Round-Optimized Schnorr Threshold</strong> 프로토콜이다. 2024년 6월 RFC 9591로 표준화되었다.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="schnorr-서명의-선형성">Schnorr 서명의 선형성<a href="#schnorr-서명의-선형성" class="hash-link" aria-label="Direct link to Schnorr 서명의 선형성" title="Direct link to Schnorr 서명의 선형성">​</a></h4><p>앞서 설명했듯이 Schnorr 서명은 <code>s = k + e × x</code> 형태로, 덧셈과 스칼라 곱셈만으로 구성된다. 이 <strong>선형 구조</strong> 덕분에 Threshold 환경에서 구현이 훨씬 단순하다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">참여자 1: s₁ = k₁ + e × x₁</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">참여자 2: s₂ = k₂ + e × x₂</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">참여자 3: s₃ = k₃ + e × x₃</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">최종 서명: s = s₁ + s₂ + s₃ = (k₁+k₂+k₃) + e × (x₁+x₂+x₃) = k + e × x</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>각 참여자가 독립적으로 부분 서명을 계산하고, 이를 단순히 더하면 완전한 서명이 된다. ECDSA처럼 복잡한 비밀 곱셈 프로토콜이 필요 없다.</p><ul><li><strong>2라운드</strong> 서명으로 매우 효율적이다.</li><li>비트코인의 Taproot 업그레이드 이후 Schnorr 서명이 지원되면서 활용도가 높아졌다.</li><li>ECDSA를 지원하지 않는 것이 한계이다. 이더리움 등 ECDSA 기반 체인에서는 사용할 수 없다.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="dkls23">DKLS23<a href="#dkls23" class="hash-link" aria-label="Direct link to DKLS23" title="Direct link to DKLS23">​</a></h3><p>2023년 Doerner, Kondi, Lee, Shelat가 발표한 프로토콜이다.</p><p>DKLS23의 주요 특징은 다음과 같다.</p><ul><li>Paillier 암호 대신 OT를 사용하여 비밀 곱셈을 수행한다. Paillier는 큰 수(2048비트 이상)의 연산이 필요하지만, OT 기반 접근은 더 가벼운 연산으로 구현할 수 있다.</li><li><strong>3라운드</strong> threshold ECDSA를 달성했다.</li><li><strong>악의적 다수(malicious majority)</strong>에 대한 보안을 제공한다. 대부분의 프로토콜이 &quot;정직한 다수&quot;를 가정하는 것과 대조적이다.</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="oblivious-transfer-ot">Oblivious Transfer (OT)<a href="#oblivious-transfer-ot" class="hash-link" aria-label="Direct link to Oblivious Transfer (OT)" title="Direct link to Oblivious Transfer (OT)">​</a></h4><p><strong>Oblivious Transfer</strong>는 MPC의 기본 구성 요소 중 하나이다. 송신자가 여러 메시지를 가지고 있고, 수신자가 그 중 하나를 선택하여 받되, 송신자는 어떤 것이 선택되었는지 알 수 없고, 수신자는 선택하지 않은 메시지를 알 수 없는 프로토콜이다.</p><p><strong>1-out-of-2 OT</strong> 예시:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">송신자: 두 메시지 (m₀, m₁) 보유</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">수신자: 선택 비트 b ∈ {0, 1}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">결과:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">- 수신자: mᵦ만 획득 (m₁₋ᵦ는 알 수 없음)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">- 송신자: b를 알 수 없음</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>OT는 공개키 암호 기반으로 구현되어 비용이 크다. OT Extension은 적은 수의 기본 OT로 많은 OT를 효율적으로 생성하는 기법으로, 대칭키 암호만 사용하여 성능을 크게 향상시킨다.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="프로토콜-비교">프로토콜 비교<a href="#프로토콜-비교" class="hash-link" aria-label="Direct link to 프로토콜 비교" title="Direct link to 프로토콜 비교">​</a></h3><table><thead><tr><th>프로토콜</th><th>서명 알고리즘</th><th>기반 기술</th><th>서명 라운드</th><th>Identifiable Abort</th></tr></thead><tbody><tr><td>GG18</td><td>ECDSA</td><td>Paillier + MtA</td><td>9</td><td>✗</td></tr><tr><td>GG20</td><td>ECDSA</td><td>Paillier + MtA</td><td>7 (온라인 1)</td><td>✓</td></tr><tr><td>CGGMP21</td><td>ECDSA</td><td>Paillier + MtA</td><td>4 or 7</td><td>✓</td></tr><tr><td>FROST</td><td>Schnorr</td><td>-</td><td>2</td><td>✓</td></tr><tr><td>DKLS23</td><td>ECDSA</td><td>OT</td><td>3</td><td>✓</td></tr><tr><td>Cait-Sith</td><td>ECDSA</td><td>Committed Beaver + OT</td><td>1 (온라인)</td><td>✗</td></tr></tbody></table><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cait-sith-프로토콜">Cait-Sith 프로토콜<a href="#cait-sith-프로토콜" class="hash-link" aria-label="Direct link to Cait-Sith 프로토콜" title="Direct link to Cait-Sith 프로토콜">​</a></h2><p><a href="https://github.com/cronokirby/cait-sith" target="_blank" rel="noopener noreferrer">Cait-Sith</a>는 <strong>Committed Beaver Triple</strong>과 <strong>OT Extension</strong>을 기반으로 한 Threshold ECDSA 프로토콜이다. 단순성과 성능을 강조하며, 특히 <strong>키 무관 사전 처리(key-independent preprocessing)</strong>라는 독특한 설계 철학을 가진다.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="beaver-triple-비밀-곱셈의-핵심">Beaver Triple: 비밀 곱셈의 핵심<a href="#beaver-triple-비밀-곱셈의-핵심" class="hash-link" aria-label="Direct link to Beaver Triple: 비밀 곱셈의 핵심" title="Direct link to Beaver Triple: 비밀 곱셈의 핵심">​</a></h3><p>Cait-Sith가 <code>k × x</code> 곱셈 문제를 해결하는 핵심 기법은 <strong>Beaver Triple</strong>이다. 1991년 Donald Beaver가 제안한 이 기법은 MPC에서 비밀 곱셈을 수행하는 표준적인 방법 중 하나이다.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="beaver-triple의-개념">Beaver Triple의 개념<a href="#beaver-triple의-개념" class="hash-link" aria-label="Direct link to Beaver Triple의 개념" title="Direct link to Beaver Triple의 개념">​</a></h4><p>Beaver Triple은 다음 관계를 만족하는 세 값 <code>(a, b, c)</code>이다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">c = a × b</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>핵심은 이 값들이 <strong>사전에 생성</strong>되며, 각 참여자는 이 값들의 <strong>조각(share)</strong>만 보유한다는 점이다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">참여자 1: (a₁, b₁, c₁)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">참여자 2: (a₂, b₂, c₂)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">참여자 3: (a₃, b₃, c₃)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">단, a = a₁ + a₂ + a₃, b = b₁ + b₂ + b₃, c = c₁ + c₂ + c₃</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="beaver-triple을-이용한-비밀-곱셈">Beaver Triple을 이용한 비밀 곱셈<a href="#beaver-triple을-이용한-비밀-곱셈" class="hash-link" aria-label="Direct link to Beaver Triple을 이용한 비밀 곱셈" title="Direct link to Beaver Triple을 이용한 비밀 곱셈">​</a></h4><p>두 비밀값 <code>x</code>와 <code>y</code>의 곱 <code>[x × y]</code>를 계산하는 과정은 다음과 같다. (대괄호 <code>[]</code>는 값이 분산되어 있음을 의미)</p><p><strong>1단계</strong>: 각 참여자가 다음을 계산하여 <strong>공개</strong>한다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">d = x - a  (각 참여자가 dᵢ = xᵢ - aᵢ를 계산하여 합산)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">e = y - b  (각 참여자가 eᵢ = yᵢ - bᵢ를 계산하여 합산)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>2단계</strong>: <code>d</code>와 <code>e</code>가 공개되어도 안전한 이유</p><ul><li><code>a</code>와 <code>b</code>는 완전히 랜덤한 값이다.</li><li><code>d = x - a</code>만으로는 <code>x</code>를 알 수 없다. <code>a</code>를 모르기 때문이다.</li><li>마찬가지로 <code>e = y - b</code>만으로는 <code>y</code>를 알 수 없다.</li></ul><p><strong>3단계</strong>: 각 참여자가 <code>[x × y]</code>의 조각을 계산한다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[x × y] = [c] + e×[a] + d×[b] + d×e</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>이 공식이 왜 성립하는지 수학적인 증명은 아래와 같다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">c + e×a + d×b + d×e</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">= ab + (y-b)a + (x-a)b + (x-a)(y-b)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">= ab + ya - ab + xb - ab + xy - xb - ya + ab</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">= xy  ✓</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>d×e</code> 항은 공개값이므로 한 참여자만 더하면 된다. 나머지 항들은 각자의 조각을 이용해 계산할 수 있다.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="committed-beaver-triple">Committed Beaver Triple<a href="#committed-beaver-triple" class="hash-link" aria-label="Direct link to Committed Beaver Triple" title="Direct link to Committed Beaver Triple">​</a></h4><p>Cait-Sith는 일반 Beaver Triple에 <strong>공개 커밋</strong>을 추가한 <strong>Committed Beaver Triple</strong>을 사용한다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">비밀 share:  [a], [b], [c]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">공개 커밋:   A = a×G, B = b×G, C = c×G</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>커밋의 역할은 다음과 같다.</p><ul><li>참여자들이 올바른 Triple을 사용하는지 검증할 수 있다.</li><li>악의적인 참여자가 잘못된 값을 주입하는 것을 방지한다.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="설계-철학">설계 철학<a href="#설계-철학" class="hash-link" aria-label="Direct link to 설계 철학" title="Direct link to 설계 철학">​</a></h3><p>Cait-Sith의 핵심 아이디어는 &quot;가능한 한 많은 연산을 키와 무관한 사전 처리 단계로 옮기는 것&quot;이다.</p><ul><li>Triple 생성 시점에 어떤 키로 서명할지 알 필요가 없다.</li><li>메시지가 확정되기 전에 Presign까지 완료할 수 있다.</li><li>실제 서명 요청이 들어오면 즉시 완료할 수 있다.</li></ul><p>이 설계는 대량의 키를 관리하는 커스터디 서비스에 특히 유리하다. 백그라운드에서 Triple과 Presign을 미리 생성해두면, 사용자의 서명 요청에 즉각 응답할 수 있다.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4단계-흐름">4단계 흐름<a href="#4단계-흐름" class="hash-link" aria-label="Direct link to 4단계 흐름" title="Direct link to 4단계 흐름">​</a></h3><p>Cait-Sith의 서명 과정은 4단계로 구성된다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ┌─────────┐     ┌────────────┐     ┌─────────┐     ┌────────┐</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  │  Setup  │ ──▶ │ Triple Gen │ ──▶ │ Presign │ ──▶ │  Sign  │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  └─────────┘     └────────────┘     └─────────┘     └────────┘</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       │                │                 │               │</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       ▼                ▼                 ▼               ▼</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     1회 실행          키 무관           메시지 무관         즉시 완료</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ◀───────── 백그라운드 사전 처리 ──────────▶    ◀── 실시간 ──▶</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table><thead><tr><th>단계</th><th>설명</th><th>특징</th></tr></thead><tbody><tr><td><strong>Setup</strong></td><td>OT Extension을 위한 초기 설정</td><td>1회만 실행, 이후 무한한 Triple 생성 가능</td></tr><tr><td><strong>Triple Gen</strong></td><td>Committed Beaver Triple 생성</td><td>키와 무관, 서명당 2개 필요</td></tr><tr><td><strong>Presign</strong></td><td>분산 난수 k와 R = k×G, σ = k×x 계산</td><td>메시지와 무관</td></tr><tr><td><strong>Sign</strong></td><td>메시지 해시와 Presign 결과 조합</td><td>1라운드 통신, 즉시 완료</td></tr></tbody></table><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="각-단계-상세">각 단계 상세<a href="#각-단계-상세" class="hash-link" aria-label="Direct link to 각 단계 상세" title="Direct link to 각 단계 상세">​</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="setup">Setup<a href="#setup" class="hash-link" aria-label="Direct link to Setup" title="Direct link to Setup">​</a></h4><p>참여자들 간의 OT Extension 채널을 설정한다. 앞서 DKLS23에서 설명한 것처럼, OT는 MPC의 기본 구성 요소이며, OT Extension을 통해 효율적으로 대량의 OT를 생성할 수 있다. Setup 단계에서 이 기반을 마련해두면 이후 Triple 생성이 효율적으로 이루어진다.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="triple-generation">Triple Generation<a href="#triple-generation" class="hash-link" aria-label="Direct link to Triple Generation" title="Direct link to Triple Generation">​</a></h4><p>Committed Beaver Triple <code>(a, b, c)</code>와 커밋 <code>(A, B, C)</code>를 생성한다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">비밀 share:  [a], [b], [c]  (c = a × b)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">공개 커밋:   A = a×G, B = b×G, C = c×G</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>각 참여자가 랜덤 <code>aᵢ</code>, <code>bᵢ</code>를 생성하고, OT Extension을 사용하여 <code>cᵢ</code>의 조각을 안전하게 계산한다. 이 단계가 연산량이 가장 많지만, 키와 무관하게 사전에 대량 생성해둘 수 있다.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="presign">Presign<a href="#presign" class="hash-link" aria-label="Direct link to Presign" title="Direct link to Presign">​</a></h4><p>메시지 없이 수행할 수 있는 서명의 전처리 단계이다.</p><ol><li>분산 난수 <code>k</code> 생성 (각 참여자가 <code>kᵢ</code> 기여)</li><li><code>R = k × G</code> 계산 (공개 nonce point, r은 R의 x좌표)</li><li><strong>핵심</strong>: Beaver Triple을 사용하여 <code>σ = k × x</code> 계산</li></ol><p><code>k × x</code> 계산이 가장 어려운 부분이다. 앞서 설명한 Beaver Triple 기법으로 <code>k</code>도 <code>x</code>도 노출되지 않으면서 곱셈을 수행한다.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="sign">Sign<a href="#sign" class="hash-link" aria-label="Direct link to Sign" title="Direct link to Sign">​</a></h4><p>메시지가 확정되면 최종 서명을 생성한다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">각 참여자: sᵢ = kᵢ × m + σᵢ × r</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">최종 서명: s = Σsᵢ (라그랑주 보간 적용)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>무거운 연산은 모두 Presign에서 완료되었으므로, Sign 단계에서는 단순 스칼라 연산만 수행한다. 네트워크 통신도 1라운드로 충분하다.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="주의사항">주의사항<a href="#주의사항" class="hash-link" aria-label="Direct link to 주의사항" title="Direct link to 주의사항">​</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="triple-재사용-금지">Triple 재사용 금지<a href="#triple-재사용-금지" class="hash-link" aria-label="Direct link to Triple 재사용 금지" title="Direct link to Triple 재사용 금지">​</a></h4><p>Beaver Triple은 <strong>절대로 재사용해서는 안 된다</strong>. 재사용 시 개인키가 복구될 수 있다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">서명 1: d₁ = x - a,  e₁ = k₁ - b  공개</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">서명 2: d₂ = x - a,  e₂ = k₂ - b  공개 (같은 Triple 재사용)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">d₁ - d₂ = 0  (x와 a가 동일하므로)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">→ 공격자가 &quot;같은 Triple 사용됨&quot;을 인지</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">→ 두 서명의 관계식에서 x를 역산 가능</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Triple은 &quot;일회용 마스크&quot;이다. 한 번 사용하면 <code>d = x - a</code>가 공개되므로, 같은 <code>a</code>를 다시 사용하면 마스킹 효과가 사라진다.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="distributed-key-generation-dkg">Distributed Key Generation (DKG)<a href="#distributed-key-generation-dkg" class="hash-link" aria-label="Direct link to Distributed Key Generation (DKG)" title="Direct link to Distributed Key Generation (DKG)">​</a></h2><p>TSS의 또 다른 핵심 구성 요소는 <strong>Distributed Key Generation(DKG)</strong>이다. 신뢰할 수 있는 제3자 없이 분산된 방식으로 키 쌍을 생성한다.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="dkg의-목표">DKG의 목표<a href="#dkg의-목표" class="hash-link" aria-label="Direct link to DKG의 목표" title="Direct link to DKG의 목표">​</a></h3><ul><li>공개키 <code>P</code>를 모든 참여자가 합의한다.</li><li>대응하는 개인키 <code>x</code>는 어떤 단일 참여자도 알지 못한다.</li><li>각 참여자는 <code>x</code>의 조각 <code>xᵢ</code>만 보유한다.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="sss와의-관계-feldman-vss">SSS와의 관계: Feldman VSS<a href="#sss와의-관계-feldman-vss" class="hash-link" aria-label="Direct link to SSS와의 관계: Feldman VSS" title="Direct link to SSS와의 관계: Feldman VSS">​</a></h3><p>DKG에서 키를 분산하는 방식은 SSS와 밀접한 관련이 있다. 정확히 말하면, <strong>Feldman&#x27;s Verifiable Secret Sharing(VSS)</strong>을 사용하는데, 이는 SSS를 기반으로 <strong>검증 가능성</strong>을 추가한 것이다.</p><p><strong>SSS의 한계</strong>
SSS에서 딜러가 share를 배포할 때, 수신자는 받은 share가 올바른지 검증할 방법이 없다. 악의적인 딜러가 일부 참여자에게 잘못된 share를 줄 수 있고, 이 경우 복원 시 엉뚱한 값이 나온다.</p><p><strong>Feldman VSS의 해결책</strong></p><p>Feldman VSS는 다항식의 계수에 대한 <strong>커밋먼트</strong>를 공개한다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">다항식: f(x) = s + a₁x + a₂x² + ... + aₖ₋₁xᵏ⁻¹</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">커밋먼트: C₀ = s·G, C₁ = a₁·G, C₂ = a₂·G, ..., Cₖ₋₁ = aₖ₋₁·G</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>각 참여자 i는 자신의 share <code>f(i)</code>를 받은 후, 다음을 검증할 수 있다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">f(i)·G = C₀ + i·C₁ + i²·C₂ + ... + iᵏ⁻¹·Cₖ₋₁</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>이 검증이 통과하면 share가 공개된 커밋먼트와 일치하는 올바른 다항식에서 생성되었음을 확신할 수 있다.</p><p><strong>DKG에서의 적용</strong></p><p>DKG는 Feldman VSS를 확장하여 <strong>딜러 없이</strong> 키를 생성한다. 각 참여자가 자신만의 랜덤 다항식을 생성하고, 모든 참여자의 다항식을 합산하여 최종 키를 만든다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">참여자 1: f₁(x) = s₁ + a₁₁x + a₁₂x² + ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">참여자 2: f₂(x) = s₂ + a₂₁x + a₂₂x² + ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">참여자 3: f₃(x) = s₃ + a₃₁x + a₃₂x² + ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">최종 다항식: F(x) = f₁(x) + f₂(x) + f₃(x)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">최종 비밀키: s = s₁ + s₂ + s₃ (아무도 이 값을 직접 알지 못함)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">참여자 i의 share: xᵢ = F(i) = f₁(i) + f₂(i) + f₃(i)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>각 참여자는 다른 참여자로부터 받은 share의 합을 자신의 최종 share로 사용한다. 결과적으로 SSS와 동일한 수학적 구조(라그랑주 보간)를 사용하지만, 전체 비밀을 아는 딜러 없이 분산 방식으로 생성된다.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="keygen-메시지-흐름">Keygen 메시지 흐름<a href="#keygen-메시지-흐름" class="hash-link" aria-label="Direct link to Keygen 메시지 흐름" title="Direct link to Keygen 메시지 흐름">​</a></h3><p>일반적인 DKG Keygen은 다음과 같은 라운드로 구성된다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">라운드 1: Commitment 교환</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  - 각 참여자가 자신의 다항식 계수에 대한 해시 H(F)를 브로드캐스트</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  - 나중에 값을 변경하는 것을 방지</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">라운드 2: Confirmation 교환</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  - 모든 commitment의 해시 H(all)를 브로드캐스트</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  - 모두 같은 값을 받았는지 확인</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">라운드 3: Polynomial + Proof 공유</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  - 다항식 F와 dlog 증명을 공개</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  - 정당성 검증</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">라운드 4: Private Share 교환</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  - 각 참여자에게 f(participant_id)를 암호화하여 전달</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  - 이 값이 개인키 조각 xᵢ가 됨</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="key-refresh와-key-resharing">Key Refresh와 Key Resharing<a href="#key-refresh와-key-resharing" class="hash-link" aria-label="Direct link to Key Refresh와 Key Resharing" title="Direct link to Key Refresh와 Key Resharing">​</a></h3><p>TSS의 장점 중 하나는 공개키(블록체인 주소)를 변경하지 않으면서도 내부 구조를 변경할 수 있다는 점이다.</p><ul><li><strong>Key Refresh</strong>: 동일한 참여자와 임계값을 유지하면서 share를 갱신한다. 이전 share가 유출되었더라도 새 share와 조합할 수 없다.</li><li><strong>Key Resharing</strong>: 참여자 구성이나 임계값을 변경한다. 기존 임계값 이상의 참여자가 협력해야 한다.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="typescript-구현">TypeScript 구현<a href="#typescript-구현" class="hash-link" aria-label="Direct link to TypeScript 구현" title="Direct link to TypeScript 구현">​</a></h2><p>Beaver Triple을 이용한 비밀 곱셈의 개념을 테스트 코드로 확인해보자.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="개요">개요<a href="#개요" class="hash-link" aria-label="Direct link to 개요" title="Direct link to 개요">​</a></h3><ol><li><strong>Additive Secret Sharing</strong>: 비밀값을 여러 참여자에게 분산한다. 모든 share의 합이 원래 비밀이 된다.</li><li><strong>Beaver Triple 생성</strong>: 사전에 <code>(a, b, c)</code> where <code>c = a × b</code>를 생성하고 share로 분산한다.</li><li><strong>비밀 곱셈</strong>: 두 비밀값 <code>x</code>, <code>y</code>의 곱을 각 참여자의 share만으로 계산한다.</li></ol><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>예제 코드</div><div class="admonitionContent_S0QG"><p>전체 테스트 코드는 <a href="https://github.com/chihunmanse/crypto-examples/tree/main/cryptography-examples/05-threshold-signature-scheme" target="_blank" rel="noopener noreferrer">crypto-examples/cryptography-examples/05-threshold-signature-scheme</a>에서 확인할 수 있다.</p></div></div><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">beaver-triple.ts</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">beaver-triple.test.ts</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">// Beaver Triple: Secret Multiplication without Revealing Secrets</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">PRIME</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">BigInt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;170141183460469231731687303715884105727&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// 2^127 - 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// Modular arithmetic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">mod</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">n</span><span class="token operator">:</span><span class="token plain"> bigint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token operator">:</span><span class="token plain"> bigint </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">n </span><span class="token operator">%</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">PRIME</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">PRIME</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">%</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">PRIME</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// Additive secret sharing: split a secret into n shares</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// secret = share_1 + share_2 + ... + share_n (mod PRIME)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">additiveShare</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">secret</span><span class="token operator">:</span><span class="token plain"> bigint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> n</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">number</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token operator">:</span><span class="token plain"> bigint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> shares</span><span class="token operator">:</span><span class="token plain"> bigint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> sum </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">BigInt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> i </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> i </span><span class="token operator">&lt;</span><span class="token plain"> n </span><span class="token operator">-</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> i</span><span class="token operator">++</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> share </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">randomBigInt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token constant" style="color:rgb(189, 147, 249)">PRIME</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    shares</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">push</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">share</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sum </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">mod</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">sum </span><span class="token operator">+</span><span class="token plain"> share</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">// Last share ensures sum equals secret</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  shares</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">push</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token function" style="color:rgb(80, 250, 123)">mod</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">secret </span><span class="token operator">-</span><span class="token plain"> sum</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> shares</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// Reconstruct secret from additive shares</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">reconstructAdditive</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">shares</span><span class="token operator">:</span><span class="token plain"> bigint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token operator">:</span><span class="token plain"> bigint </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> shares</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">reduce</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">sum</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> share</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">mod</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">sum </span><span class="token operator">+</span><span class="token plain"> share</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">BigInt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// Beaver Triple: (a, b, c) where c = a * b</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">interface</span><span class="token plain"> </span><span class="token class-name">BeaverTriple</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  a</span><span class="token operator">:</span><span class="token plain"> bigint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  b</span><span class="token operator">:</span><span class="token plain"> bigint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  c</span><span class="token operator">:</span><span class="token plain"> bigint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// Generate Beaver Triple and distribute shares</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">generateBeaverTriple</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">n</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">number</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  triple</span><span class="token operator">:</span><span class="token plain"> BeaverTriple</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  shares</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> aShares</span><span class="token operator">:</span><span class="token plain"> bigint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> bShares</span><span class="token operator">:</span><span class="token plain"> bigint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> cShares</span><span class="token operator">:</span><span class="token plain"> bigint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> a </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">randomBigInt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token constant" style="color:rgb(189, 147, 249)">PRIME</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> b </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">randomBigInt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token constant" style="color:rgb(189, 147, 249)">PRIME</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> c </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">mod</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">a </span><span class="token operator">*</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    triple</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> c </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    shares</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      aShares</span><span class="token operator">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">additiveShare</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> n</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      bShares</span><span class="token operator">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">additiveShare</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> n</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      cShares</span><span class="token operator">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">additiveShare</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">c</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> n</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// Secret multiplication using Beaver Triple</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// Goal: compute [x * y] without revealing x or y</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">secretMultiplication</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  xShares</span><span class="token operator">:</span><span class="token plain"> bigint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  yShares</span><span class="token operator">:</span><span class="token plain"> bigint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  tripleShares</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> aShares</span><span class="token operator">:</span><span class="token plain"> bigint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> bShares</span><span class="token operator">:</span><span class="token plain"> bigint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> cShares</span><span class="token operator">:</span><span class="token plain"> bigint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> resultShares</span><span class="token operator">:</span><span class="token plain"> bigint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> publicD</span><span class="token operator">:</span><span class="token plain"> bigint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> publicE</span><span class="token operator">:</span><span class="token plain"> bigint </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> n </span><span class="token operator">=</span><span class="token plain"> xShares</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">length</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> aShares</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> bShares</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> cShares </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> tripleShares</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">// Step 1: Compute and broadcast d = x - a, e = y - b</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> dShares </span><span class="token operator">=</span><span class="token plain"> xShares</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">xi</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">mod</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">xi </span><span class="token operator">-</span><span class="token plain"> aShares</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> eShares </span><span class="token operator">=</span><span class="token plain"> yShares</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">yi</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">mod</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">yi </span><span class="token operator">-</span><span class="token plain"> bShares</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> d </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">reconstructAdditive</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">dShares</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> e </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">reconstructAdditive</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">eShares</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">// Step 2: Compute [x * y] = [c] + e*[a] + d*[b] + d*e</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> resultShares </span><span class="token operator">=</span><span class="token plain"> cShares</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ci</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> share </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">mod</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ci </span><span class="token operator">+</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">mod</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">e </span><span class="token operator">*</span><span class="token plain"> aShares</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">mod</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">d </span><span class="token operator">*</span><span class="token plain"> bShares</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">i </span><span class="token operator">===</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> share </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">mod</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">share </span><span class="token operator">+</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">mod</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">d </span><span class="token operator">*</span><span class="token plain"> e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// Only one participant adds d*e</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> share</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> resultShares</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> publicD</span><span class="token operator">:</span><span class="token plain"> d</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> publicE</span><span class="token operator">:</span><span class="token plain"> e </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  additiveShare</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  reconstructAdditive</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  generateBeaverTriple</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  secretMultiplication</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;./beaver-triple&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">runBeaverTripleTests</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;=== Beaver Triple: Secret Multiplication Test ===\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> n </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// 3 participants</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">// Secrets to multiply (simulating private key x and nonce k)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> x </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">BigInt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">123456789</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// &quot;private key&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> y </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">BigInt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">987654321</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// &quot;nonce k&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> expectedProduct </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">mod</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">x </span><span class="token operator">*</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token template-string template-punctuation string" style="color:rgb(255, 121, 198)">`</span><span class="token template-string string" style="color:rgb(255, 121, 198)">Secret x (private key): </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(248, 248, 242)">${</span><span class="token template-string interpolation">x</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token template-string template-punctuation string" style="color:rgb(255, 121, 198)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token template-string template-punctuation string" style="color:rgb(255, 121, 198)">`</span><span class="token template-string string" style="color:rgb(255, 121, 198)">Secret y (nonce k): </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(248, 248, 242)">${</span><span class="token template-string interpolation">y</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token template-string template-punctuation string" style="color:rgb(255, 121, 198)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token template-string template-punctuation string" style="color:rgb(255, 121, 198)">`</span><span class="token template-string string" style="color:rgb(255, 121, 198)">Expected x * y: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(248, 248, 242)">${</span><span class="token template-string interpolation">expectedProduct</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token template-string string" style="color:rgb(255, 121, 198)">\n</span><span class="token template-string template-punctuation string" style="color:rgb(255, 121, 198)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">// Step 1: Split secrets into additive shares</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> xShares </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">additiveShare</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> n</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> yShares </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">additiveShare</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">y</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> n</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">// Step 2: Generate Beaver Triple</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> triple</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> shares</span><span class="token operator">:</span><span class="token plain"> tripleShares </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">generateBeaverTriple</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token template-string template-punctuation string" style="color:rgb(255, 121, 198)">`</span><span class="token template-string string" style="color:rgb(255, 121, 198)">Triple: c = a * b = </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(248, 248, 242)">${</span><span class="token template-string interpolation">triple</span><span class="token template-string interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token template-string interpolation">c</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token template-string template-punctuation string" style="color:rgb(255, 121, 198)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token template-string template-punctuation string" style="color:rgb(255, 121, 198)">`</span><span class="token template-string string" style="color:rgb(255, 121, 198)">Verify: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(248, 248, 242)">${</span><span class="token template-string interpolation">triple</span><span class="token template-string interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token template-string interpolation">c </span><span class="token template-string interpolation operator">===</span><span class="token template-string interpolation"> </span><span class="token template-string interpolation function" style="color:rgb(80, 250, 123)">mod</span><span class="token template-string interpolation punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token template-string interpolation">triple</span><span class="token template-string interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token template-string interpolation">a </span><span class="token template-string interpolation operator">*</span><span class="token template-string interpolation"> triple</span><span class="token template-string interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token template-string interpolation">b</span><span class="token template-string interpolation punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token template-string string" style="color:rgb(255, 121, 198)">\n</span><span class="token template-string template-punctuation string" style="color:rgb(255, 121, 198)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">// Step 3: Secret multiplication using Beaver Triple</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> resultShares</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> publicD</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> publicE </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">secretMultiplication</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    xShares</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    yShares</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    tripleShares</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token template-string template-punctuation string" style="color:rgb(255, 121, 198)">`</span><span class="token template-string string" style="color:rgb(255, 121, 198)">Public d = x - a: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(248, 248, 242)">${</span><span class="token template-string interpolation">publicD</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token template-string template-punctuation string" style="color:rgb(255, 121, 198)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token template-string template-punctuation string" style="color:rgb(255, 121, 198)">`</span><span class="token template-string string" style="color:rgb(255, 121, 198)">Public e = y - b: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(248, 248, 242)">${</span><span class="token template-string interpolation">publicE</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token template-string template-punctuation string" style="color:rgb(255, 121, 198)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;d and e are safe to reveal (a, b are random)\n&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> computedProduct </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">reconstructAdditive</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">resultShares</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token template-string template-punctuation string" style="color:rgb(255, 121, 198)">`</span><span class="token template-string string" style="color:rgb(255, 121, 198)">Computed x * y: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(248, 248, 242)">${</span><span class="token template-string interpolation">computedProduct</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token template-string template-punctuation string" style="color:rgb(255, 121, 198)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token template-string template-punctuation string" style="color:rgb(255, 121, 198)">`</span><span class="token template-string string" style="color:rgb(255, 121, 198)">Expected x * y: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(248, 248, 242)">${</span><span class="token template-string interpolation">expectedProduct</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token template-string template-punctuation string" style="color:rgb(255, 121, 198)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin" style="color:rgb(189, 147, 249)">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token template-string template-punctuation string" style="color:rgb(255, 121, 198)">`</span><span class="token template-string string" style="color:rgb(255, 121, 198)">Success: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(248, 248, 242)">${</span><span class="token template-string interpolation">computedProduct </span><span class="token template-string interpolation operator">===</span><span class="token template-string interpolation"> expectedProduct</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token template-string template-punctuation string" style="color:rgb(255, 121, 198)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><p>위 테스트 코드를 실행하면 다음과 같은 결과를 확인할 수 있다.</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">==</span><span class="token operator">=</span><span class="token plain"> Beaver Triple: Secret Multiplication Test </span><span class="token operator">==</span><span class="token operator">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Secret x </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">private key</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">: </span><span class="token number">123456789</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Secret y </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">nonce k</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">: </span><span class="token number">987654321</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Expected x * y: </span><span class="token number">121932631112635269</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Number of participants: </span><span class="token number">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--- Step </span><span class="token number">1</span><span class="token plain">: Split secrets into additive shares ---</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">x shares </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">sum </span><span class="token operator">=</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Participant </span><span class="token number">1</span><span class="token plain">: </span><span class="token number">158951332274000706256645552694561396184</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Participant </span><span class="token number">2</span><span class="token plain">: </span><span class="token number">21671532207816538632489780162699830399</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Participant </span><span class="token number">3</span><span class="token plain">: </span><span class="token number">159659502439121218574239274574630441660</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Reconstructed x: </span><span class="token number">123456789</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--- Step </span><span class="token number">2</span><span class="token plain">: Generate Beaver Triple </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">a, b, c</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> where c </span><span class="token operator">=</span><span class="token plain"> a*b ---</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Triple: </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">a</span><span class="token operator">=</span><span class="token number">116616167988215653003297630462272816546</span><span class="token plain">, </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">b</span><span class="token operator">=</span><span class="token number">70085026575726519533589340871607742737</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">c </span><span class="token operator">=</span><span class="token plain"> a * b </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">133462244398343055172723199779951026134</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Verify c </span><span class="token operator">==</span><span class="token plain"> a*b: </span><span class="token boolean">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--- Step </span><span class="token number">3</span><span class="token plain">: Secret multiplication using Beaver Triple ---</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Public d </span><span class="token operator">=</span><span class="token plain"> x - a: </span><span class="token number">53525015472253578728389673253734745970</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Public e </span><span class="token operator">=</span><span class="token plain"> y - b: </span><span class="token number">100056156884742712198097962845264017311</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Note: d and e are safe to reveal because a and b are random.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Knowing d </span><span class="token operator">=</span><span class="token plain"> x - a doesn&#x27;t reveal x without knowing a.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Result shares </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">x * y</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Participant </span><span class="token number">1</span><span class="token plain">: </span><span class="token number">53238482308233891691171247053917083607</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Participant </span><span class="token number">2</span><span class="token plain">: </span><span class="token number">57099928044243123229254703639414263009</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Participant </span><span class="token number">3</span><span class="token plain">: </span><span class="token number">59802773107992216811383285653665394380</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Reconstructed x * y: </span><span class="token number">121932631112635269</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Expected x * y: </span><span class="token number">121932631112635269</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Success: </span><span class="token boolean">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--- Key Insight ---</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Throughout this process:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  - No participant learned the full value of x or y</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  - Only d </span><span class="token operator">=</span><span class="token plain"> x - a and e </span><span class="token operator">=</span><span class="token plain"> y - b were revealed publicly</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  - Since a and b are random, d and e reveal nothing about x and y</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  - Yet we computed shares of x * y correctly</span><span class="token operator">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">This is how Threshold ECDSA computes k * x without exposing either value.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="실행-결과-분석">실행 결과 분석<a href="#실행-결과-분석" class="hash-link" aria-label="Direct link to 실행 결과 분석" title="Direct link to 실행 결과 분석">​</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="step-1-additive-secret-sharing">Step 1: Additive Secret Sharing<a href="#step-1-additive-secret-sharing" class="hash-link" aria-label="Direct link to Step 1: Additive Secret Sharing" title="Direct link to Step 1: Additive Secret Sharing">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">x shares (sum = x):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Participant 1: 158951332274000706256645552694561396184</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Participant 2: 21671532207816538632489780162699830399</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Participant 3: 159659502439121218574239274574630441660</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Reconstructed x: 123456789</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>비밀값 <code>x = 123456789</code>를 3개의 share로 분할했다. 각 share는 128비트 크기의 큰 수이다. 개별 share만 보면 원래 비밀에 대한 정보를 전혀 얻을 수 없다. 세 share를 모두 더하면(mod PRIME) 정확히 <code>123456789</code>가 복원된다.</p><p>이 예제에서는 Additive Sharing을 사용했지만, 실제 TSS에서는 (t, n) threshold 구조를 위해 Shamir shares를 사용한다. 서명 시점에 참여하는 t명이 각자의 share에 라그랑주 계수를 곱하면 Additive 구조로 변환되어 동일한 연산이 적용된다.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="step-2-beaver-triple-생성">Step 2: Beaver Triple 생성<a href="#step-2-beaver-triple-생성" class="hash-link" aria-label="Direct link to Step 2: Beaver Triple 생성" title="Direct link to Step 2: Beaver Triple 생성">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Triple: a=116616167988215653003297630462272816546, b=70085026575726519533589340871607742737</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">c = a * b = 133462244398343055172723199779951026134</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Verify c == a*b: true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>랜덤한 <code>a</code>와 <code>b</code>를 생성하고, 그 곱 <code>c = a × b</code>를 미리 계산해둔다. 이 Triple은 <strong>비밀 곱셈에 사용될 &quot;일회용 마스크&quot;</strong>라고 생각하면 된다. 실제 TSS에서는 OT Extension을 통해 <code>a</code>, <code>b</code>, <code>c</code> 각각을 share 형태로 생성하여 어떤 참여자도 전체 Triple을 알지 못하게 한다.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="step-3-비밀-곱셈">Step 3: 비밀 곱셈<a href="#step-3-비밀-곱셈" class="hash-link" aria-label="Direct link to Step 3: 비밀 곱셈" title="Direct link to Step 3: 비밀 곱셈">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Public d = x - a: 53525015472253578728389673253734745970</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Public e = y - b: 100056156884742712198097962845264017311</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>각 참여자가 <code>dᵢ = xᵢ - aᵢ</code>와 <code>eᵢ = yᵢ - bᵢ</code>를 계산하여 브로드캐스트한다. 모든 참여자가 이를 합산하면 <code>d = x - a</code>와 <code>e = y - b</code>를 얻는다.</p><p><strong>왜 d와 e를 공개해도 안전한가?</strong></p><p><code>a</code>와 <code>b</code>는 완전히 랜덤한 값이다. <code>d = x - a</code>를 알아도 <code>a</code>를 모르면 <code>x</code>를 알 수 없다. 이는 <strong>One-Time Pad</strong>와 동일한 원리이다. 랜덤 마스크로 원본을 숨기면, 마스크를 모르는 한 원본을 복구할 수 없다.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Result shares [x * y]:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Participant 1: 53238482308233891691171247053917083607</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Participant 2: 57099928044243123229254703639414263009</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Participant 3: 59802773107992216811383285653665394380</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Reconstructed x * y: 121932631112635269</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Expected x * y: 121932631112635269</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Success: true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>각 참여자는 공식 <code>[x × y] = [c] + e×[a] + d×[b] + d×e</code>를 사용하여 결과의 share를 계산한다. <code>d</code>, <code>e</code>는 공개값이고, <code>[a]</code>, <code>[b]</code>, <code>[c]</code>는 각자의 share이다. 참여자 0만 <code>d×e</code> 항을 추가하여 중복 계산을 방지한다.</p><p>세 결과 share를 합산하면 <code>121932631112635269</code>가 나오고, 이는 <code>123456789 × 987654321</code>의 정확한 값이다.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="정리">정리<a href="#정리" class="hash-link" aria-label="Direct link to 정리" title="Direct link to 정리">​</a></h2><p>Threshold Signature Scheme은 비밀 분산 서명을 통해 단일 실패 지점을 제거하는 암호학적 기법이다.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="핵심-요약">핵심 요약<a href="#핵심-요약" class="hash-link" aria-label="Direct link to 핵심 요약" title="Direct link to 핵심 요약">​</a></h3><ul><li><strong>SSS vs TSS</strong>: SSS는 보관의 문제를, TSS는 사용(서명)의 문제까지 해결한다. TSS에서는 개인키가 생성부터 서명까지 어느 시점에도 한 곳에 존재하지 않는다.</li><li><strong>(t, n) Threshold 구조</strong>: n명 중 t명 이상이 협력하면 서명이 가능하다. 라그랑주 보간을 통해 개인키를 복원하지 않고 부분 서명을 합성한다.</li><li><strong>DKG (Distributed Key Generation)</strong>: 신뢰할 수 있는 딜러 없이 분산 방식으로 키를 생성한다. Feldman VSS를 통해 각 참여자가 받은 share의 정당성을 검증할 수 있다.</li><li><strong>Key Refresh/Resharing</strong>: 공개키(블록체인 주소)를 변경하지 않고 share를 갱신하거나 참여자 구성을 변경할 수 있다.</li><li><strong>ECDSA의 어려움</strong>: 서명 공식의 <code>k × x</code> 곱셈이 비선형이라 Paillier 동형암호, MtA, Beaver Triple, OT 등 복잡한 기법이 필요하다.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="sss-vs-tss-vs-multi-sig">SSS vs TSS vs Multi-sig<a href="#sss-vs-tss-vs-multi-sig" class="hash-link" aria-label="Direct link to SSS vs TSS vs Multi-sig" title="Direct link to SSS vs TSS vs Multi-sig">​</a></h3><table><thead><tr><th>특성</th><th>SSS</th><th>TSS</th><th>Multi-sig</th></tr></thead><tbody><tr><td>서명 시 키 재조합</td><td>필요</td><td>불필요</td><td>해당 없음</td></tr><tr><td>단일 실패 지점</td><td>있음</td><td>없음</td><td>없음</td></tr><tr><td>온체인 비용</td><td>표준</td><td>표준</td><td>높음</td></tr><tr><td>체인 호환성</td><td>모든 체인</td><td>모든 체인</td><td>제한적</td></tr><tr><td>프라이버시</td><td>높음</td><td>높음</td><td>낮음</td></tr><tr><td>구현 복잡도</td><td>낮음</td><td>높음</td><td>중간</td></tr></tbody></table><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="참고-자료">참고 자료<a href="#참고-자료" class="hash-link" aria-label="Direct link to 참고 자료" title="Direct link to 참고 자료">​</a></h3><ul><li><a href="https://github.com/cronokirby/cait-sith" target="_blank" rel="noopener noreferrer">Cait-Sith GitHub</a></li><li><a href="https://cronokirby.com/Notes/index.html" target="_blank" rel="noopener noreferrer">Cait-Sith Security Notes</a></li><li><a href="https://eprint.iacr.org/2020/540.pdf" target="_blank" rel="noopener noreferrer">GG20 Paper - One Round Threshold ECDSA</a></li><li><a href="https://datatracker.ietf.org/doc/rfc9591/" target="_blank" rel="noopener noreferrer">RFC 9591 - FROST Protocol</a></li><li><a href="https://eprint.iacr.org/2023/765.pdf" target="_blank" rel="noopener noreferrer">DKLS23 Paper - Threshold ECDSA in Three Rounds</a></li><li><a href="https://blog.web3auth.io/shamirs-secret-sharing-sss-vs-threshold-signature-scheme-tss-explained/" target="_blank" rel="noopener noreferrer">Web3Auth - SSS vs TSS Explained</a></li><li><a href="https://verichains.io/tsshock/" target="_blank" rel="noopener noreferrer">Verichains - TSSHOCK</a></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/cryptography">Cryptography</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/blockchain">Blockchain</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blockchain/cryptography/shamir-secret-sharing"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Shamir&#x27;s Secret Sharing (SSS)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blockchain/how-ethereum-works"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">How Ethereum Works</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#sss의-한계" class="table-of-contents__link toc-highlight">SSS의 한계</a><ul><li><a href="#생성과-복원-시점의-취약성" class="table-of-contents__link toc-highlight">생성과 복원 시점의 취약성</a></li><li><a href="#sss-vs-tss" class="table-of-contents__link toc-highlight">SSS vs TSS</a></li><li><a href="#t-n-threshold-구조" class="table-of-contents__link toc-highlight">(t, n) Threshold 구조</a></li></ul></li><li><a href="#왜-threshold-ecdsa가-어려운가" class="table-of-contents__link toc-highlight">왜 Threshold ECDSA가 어려운가?</a><ul><li><a href="#ecdsa-서명-공식의-구조" class="table-of-contents__link toc-highlight">ECDSA 서명 공식의 구조</a></li><li><a href="#핵심-문제-k--x-곱셈" class="table-of-contents__link toc-highlight">핵심 문제: k × x 곱셈</a></li><li><a href="#schnorr-서명과의-비교" class="table-of-contents__link toc-highlight">Schnorr 서명과의 비교</a></li></ul></li><li><a href="#주요-threshold-signature-프로토콜" class="table-of-contents__link toc-highlight">주요 Threshold Signature 프로토콜</a><ul><li><a href="#gg18gg20-gennaro-goldfeder" class="table-of-contents__link toc-highlight">GG18/GG20 (Gennaro-Goldfeder)</a></li><li><a href="#cggmp21" class="table-of-contents__link toc-highlight">CGGMP21</a></li><li><a href="#frost" class="table-of-contents__link toc-highlight">FROST</a></li><li><a href="#dkls23" class="table-of-contents__link toc-highlight">DKLS23</a></li><li><a href="#프로토콜-비교" class="table-of-contents__link toc-highlight">프로토콜 비교</a></li></ul></li><li><a href="#cait-sith-프로토콜" class="table-of-contents__link toc-highlight">Cait-Sith 프로토콜</a><ul><li><a href="#beaver-triple-비밀-곱셈의-핵심" class="table-of-contents__link toc-highlight">Beaver Triple: 비밀 곱셈의 핵심</a></li><li><a href="#설계-철학" class="table-of-contents__link toc-highlight">설계 철학</a></li><li><a href="#4단계-흐름" class="table-of-contents__link toc-highlight">4단계 흐름</a></li><li><a href="#각-단계-상세" class="table-of-contents__link toc-highlight">각 단계 상세</a></li><li><a href="#주의사항" class="table-of-contents__link toc-highlight">주의사항</a></li></ul></li><li><a href="#distributed-key-generation-dkg" class="table-of-contents__link toc-highlight">Distributed Key Generation (DKG)</a><ul><li><a href="#dkg의-목표" class="table-of-contents__link toc-highlight">DKG의 목표</a></li><li><a href="#sss와의-관계-feldman-vss" class="table-of-contents__link toc-highlight">SSS와의 관계: Feldman VSS</a></li><li><a href="#keygen-메시지-흐름" class="table-of-contents__link toc-highlight">Keygen 메시지 흐름</a></li><li><a href="#key-refresh와-key-resharing" class="table-of-contents__link toc-highlight">Key Refresh와 Key Resharing</a></li></ul></li><li><a href="#typescript-구현" class="table-of-contents__link toc-highlight">TypeScript 구현</a><ul><li><a href="#개요" class="table-of-contents__link toc-highlight">개요</a></li><li><a href="#실행-결과-분석" class="table-of-contents__link toc-highlight">실행 결과 분석</a></li></ul></li><li><a href="#정리" class="table-of-contents__link toc-highlight">정리</a><ul><li><a href="#핵심-요약" class="table-of-contents__link toc-highlight">핵심 요약</a></li><li><a href="#sss-vs-tss-vs-multi-sig" class="table-of-contents__link toc-highlight">SSS vs TSS vs Multi-sig</a></li><li><a href="#참고-자료" class="table-of-contents__link toc-highlight">참고 자료</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.54cb9dbe.js"></script>
<script src="/assets/js/main.3f3a3de7.js"></script>
</body>
</html>